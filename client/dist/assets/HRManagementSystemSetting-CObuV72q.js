import{_ as Xl,j as F,r as E,y as ge,u as Tt,k as Rt,m as De,e as R,n as T,o as y,w as u,b as i,d as r,v as k,g as D,c as _,q as G,F as S,t as L,h as Ot,E as N,B as pl,C as Nt}from"./index-BtRsP1Ch.js";import{a as re,b as zt}from"./api-BbRE8XJ9.js";const Pt={class:"employee-management"},Bt={class:"page-header"},Mt={class:"header-stats"},jt={class:"stat-item"},xt={class:"stat-number"},Ft={class:"stat-item"},$t={class:"stat-number"},Yt={class:"content-header"},qt={class:"content-actions"},Kt={class:"table-container"},Gt={class:"employee-info"},Xt={class:"employee-details"},Ht={class:"employee-name"},Wt={class:"employee-id"},Jt={class:"department-info"},Qt={key:1,class:"no-data"},Zt={class:"contact-info"},er={key:0,class:"contact-item"},lr={key:1,class:"contact-item"},ar={key:2,class:"no-data"},tr={class:"action-buttons"},rr={class:"tab-content"},or={class:"form-section"},nr={class:"form-group"},sr={class:"form-group"},ir={class:"role-option"},ur={class:"role-name"},dr={class:"role-desc"},cr={class:"option-wrapper"},mr={class:"option-title"},pr={class:"tab-content"},fr={class:"form-section"},vr={class:"form-group"},gr={class:"option-wrapper"},yr={class:"option-title"},br={class:"option-desc"},hr={class:"option-wrapper"},_r={class:"option-title"},Vr={class:"option-desc"},wr={class:"tab-content"},Ar={class:"form-section"},Sr={class:"form-group"},Lr={class:"form-row"},kr={class:"form-row"},Dr={class:"form-row"},Er={class:"form-row"},Ir={class:"form-row"},Ur={class:"form-group"},Cr={class:"form-row"},Tr={class:"form-row"},Rr={class:"tab-content"},Or={class:"form-section"},Nr={class:"form-group"},zr={class:"form-row"},Pr={class:"form-row"},Br={class:"form-group"},Mr={class:"form-row"},jr={class:"form-row"},xr={class:"form-group"},Fr={class:"form-row"},$r={class:"form-row"},Yr={class:"form-row"},qr={class:"form-row"},Kr={class:"form-row"},Gr={class:"tab-content"},Xr={class:"form-section"},Hr={class:"form-group"},Wr={class:"form-row"},Jr={class:"form-row"},Qr={class:"form-group"},Zr={class:"form-row"},eo={class:"form-row"},lo={class:"form-row"},ao={class:"form-group"},to={class:"form-row"},ro={class:"form-row"},oo={class:"form-group"},no={class:"emergency-contact"},so={class:"form-row"},io={class:"form-row"},uo={class:"emergency-contact"},co={class:"form-row"},mo={class:"form-row"},po={class:"form-group"},fo={class:"experience-list"},vo={class:"experience-header"},go={class:"experience-title"},yo={class:"form-row"},bo={class:"form-row"},ho={class:"form-group"},_o={class:"experience-list"},Vo={class:"experience-header"},wo={class:"experience-title"},Ao={class:"form-row"},So={class:"form-row"},Lo={class:"form-row"},ko={class:"form-group"},Do={class:"experience-list"},Eo={class:"experience-header"},Io={class:"experience-title"},Uo={class:"form-row"},Co={class:"form-row"},To={class:"form-row"},Ro={class:"tab-content"},Oo={class:"form-section"},No={class:"form-group"},zo={class:"form-row"},Po={class:"form-group"},Bo={class:"account-section"},Mo={class:"form-row"},jo={class:"account-section"},xo={class:"form-row"},Fo={class:"dialog-footer"},$o={class:"bulk-import-header"},Yo={class:"template-link"},qo={class:"bulk-import-upload"},Ko={class:"bulk-import-form"},Go={class:"bulk-import-section-title"},Xo={class:"bulk-import-header-code"},Ho={key:1,class:"bulk-import-optional-text"},Wo={key:0,class:"bulk-import-result"},Jo={class:"error-list"},Qo={key:1,class:"bulk-import-preview"},Zo={key:0},en={class:"reference-mapping-title"},ln={class:"reference-mapping-info"},an={class:"reference-mapping-value"},tn={class:"reference-mapping-rows"},rn={key:1,class:"reference-mapping-empty"},on="employee-import-template.csv",nn={__name:"EmployeeManagement",setup(Hl){var ql,Kl;async function Ee(){if(typeof window<"u"&&window&&window.XLSX&&window.XLSX.utils)return window.XLSX;try{const l=await Nt(()=>import("./xlsx-DkH2s96g.js"),[]),e=l&&(l.default||l.XLSX)?l.default||l.XLSX:l;if(e&&e.utils&&e.read)return e}catch{}if(typeof window<"u"&&typeof document<"u"&&(await new Promise((l,e)=>{const a=document.querySelector("script[data-xlsx-cdn]");if(a){a.addEventListener("load",()=>l(null),{once:!0}),a.addEventListener("error",()=>e(new Error("XLSX_CDN_FAIL")),{once:!0});return}const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js",o.async=!0,o.defer=!0,o.setAttribute("data-xlsx-cdn","1"),o.onload=()=>l(null),o.onerror=()=>e(new Error("XLSX_CDN_FAIL")),document.head.appendChild(o)}),window.XLSX&&window.XLSX.utils&&window.XLSX.read))return window.XLSX;throw new Error("XLSX_MODULE_INVALID_OR_NOT_FOUND")}function Q(l=""){return l.replace(/^\uFEFF/,"")}function ue(l){try{let e=new TextDecoder("utf-8",{fatal:!1}).decode(l);if(e.length>=2&&e.charCodeAt(0)===65279&&(e=Q(e)),(e.slice(0,64).match(/\x00/g)||[]).length/Math.max(1,Math.min(64,e.length))>.2)throw new Error("maybe-utf16le");return Q(e)}catch{try{return Q(new TextDecoder("utf-16le",{fatal:!1}).decode(l))}catch{let e="";const a=new Uint8Array(l);for(let o=0;o<a.length;o++)e+=String.fromCharCode(a[o]);return Q(e)}}}function Pe(l){const e=l.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(f=>f.length>0);if(!e.length)return[];const a=e[0],o=(a.match(/\t/g)||[]).length,d=(a.match(/,/g)||[]).length;return(o>d?"	":null)?e.map(f=>f.split("	")):[]}function Be(l){const a=(typeof(l==null?void 0:l.name)=="string"?l.name:"").match(/\.([^.]+)$/i);return a?a[1].toLowerCase():""}async function Wl(l){return l.arrayBuffer?await l.arrayBuffer():await new Promise((e,a)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=a,o.readAsArrayBuffer(l)})}function Jl(l){if(l==null||l==="")return"";const e=String(l).trim().replace(/\./g,"-").replace(/\//g,"-"),a=e.match(/^(\d{4})[-](\d{1,2})[-](\d{1,2})$/);if(!a)return e;const o=a[1],d=String(a[2]).padStart(2,"0"),m=String(a[3]).padStart(2,"0");return`${o}-${d}-${m}`}function Ql(l){if(l==null||l==="")return"";const e=String(l).trim().toLowerCase();return["true","yes","y","1"].includes(e)?"TRUE":["false","no","n","0"].includes(e)?"FALSE":String(l)}function Zl(l){return l==null||l===""?[]:String(l).split(",").map(e=>e.trim()).filter(Boolean)}function fl(l,e){if(!e)return[];const a=l.utils.sheet_to_json(e,{header:1,defval:""});if(!Array.isArray(a)||a.length===0)return[];const o=(a[0]||[]).map(f=>Q(String(f??"").trim())),d=a.slice(2),m=[];for(const f of d){if(!Array.isArray(f)||f.every(c=>String(c??"").trim()===""))continue;const s={};for(let c=0;c<o.length;c++){const b=o[c]||`col_${c}`;s[b]=f[c]??""}m.push(s)}return m}function vl(l=""){return Q(String(l)).trim().toLowerCase()}function Me(l=[]){const e=new Map(l.map(a=>[vl(a),a]));oe.forEach(a=>{const o=a.header||a.key,d=e.get(vl(o));d&&(C.columnMappings[a.key]=d)})}async function gl(l){var m,f;const e=await Ee(),a=await Wl(l);try{const p=e.read(a,{type:"array",codepage:65001}),s=(m=p.SheetNames)==null?void 0:m[0],c=s?p.Sheets[s]:null,b=fl(e,c);if(b.length)return Me(Object.keys(b[0])),b}catch{}const o=ue(a),d=Pe(o);if(d.length){const p=(d[0]||[]).map(v=>Q(String(v??"").trim())),b=(d[1]||[]).some(v=>/必填|\(|\)|已婚|未婚|離婚|喪偶|TRUE|FALSE/.test(String(v||"")))?d.slice(2):d.slice(1);Me(p);const g=b.map(v=>{const V={};for(let I=0;I<p.length;I++)V[p[I]||`col_${I}`]=v[I]??"";return V}).filter(v=>Object.values(v).some(V=>String(V??"").trim()!==""));if(g.length)return g}try{const p=e.read(o,{type:"string"}),s=(f=p.SheetNames)==null?void 0:f[0],c=s?p.Sheets[s]:null,b=fl(e,c);if(b.length)return Me(Object.keys(b[0])),b}catch{}return[]}const yl=F(()=>(W.value||[]).map(l=>({type:l,values:Array.isArray(x[l])?x[l]:[],options:Array.isArray(ee[l])?ee[l]:[]}))),ea=F(()=>yl.value.some(l=>l.values.length>0));function bl(l,e){const a={};for(const o of oe){const d=o.key,m=(e==null?void 0:e[d])||o.header,f=l[m];switch(d){case"birthday":case"hireDate":case"appointDate":case"resignDate":case"dismissDate":case"reAppointDate":case"reDismissDate":a[d]=Jl(f);break;case"isPartTime":case"isClocking":a[d]=Ql(f);break;case"languages":case"identityCategory":case"salaryItems":a[d]=Zl(f);break;case"laborPensionSelf":case"employeeAdvance":case"probationDays":case"dischargeYear":a[d]=f===""||f==null?"":String(f).replace(/[^\d.-]/g,"");break;default:a[d]=f??"";break}}return a}function la(l,{rowOffset:e=0}={}){const a=[],o=oe.filter(d=>d.required).map(d=>d.key);return l.forEach((d,m)=>{const f=o.filter(p=>d[p]==null||String(d[p]).trim()==="");if(f.length){const p=f.map(c=>{const b=oe.find(g=>g.key===c);return(b==null?void 0:b.label)||(b==null?void 0:b.description)||(b==null?void 0:b.header)||c}).join("、"),s=m+1+e;a.push(`第 ${s} 列缺少必填欄位：${p}`)}}),a}function aa(l){return l.map(e=>({employeeNo:e.employeeNo||e.employeeId||"",name:e.name||"",department:e.department||"",role:e.employmentStatus||e.status||"",email:e.email||""}))}async function ta(l){try{const e=Be(l);if(!["xlsx","xls","csv"].includes(e))return N.warning("請上傳 .xlsx/.xls/.csv 檔案"),{ok:!1};const a=await gl(l);if(!a.length)return N.warning("檔案內容為空，或格式不符（請使用範本）"),{ok:!1};const o=a.map(f=>bl(f,C.columnMappings)),d=la(o,{rowOffset:2}),m=aa(o);return ne.value=m,Y.value=d,{ok:!0}}catch(e){return console.error("解析匯入檔失敗：",e),N.error("解析匯入檔失敗，請確認檔案是否符合範本格式"),{ok:!1,error:e}}}async function ra(l){if(!((l==null?void 0:l.raw)||l))return;const a=X.value,o=de.value.map(m=>({...m}));if(!!a&&a!==l.raw&&wl.value)try{await pl.confirm("重新選擇檔案將清除目前的預覽資料與參照對應設定，是否繼續？","確認更換匯入檔案",{type:"warning",confirmButtonText:"重新選擇",cancelButtonText:"保留現況"})}catch{de.value=o;return}nl({resetMappings:!1,resetResolvedReferences:!0,referenceKeys:H}),X.value=l.raw,de.value=[l],await ta(l.raw)}function oa(){nl({resetMappings:!1,resetResolvedReferences:!0,referenceKeys:H})}const na=Tt();function z(l){if(l==null)return"";if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return String(l);if(typeof l=="object"){const e=l.code??l.value??l.name??l.label??(typeof l.toString=="function"?l.toString():"");return typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):""}return""}function $(l=[]){return(Array.isArray(l)?l:[l]).map(a=>{if(a==null)return null;if(typeof a=="object"&&!Array.isArray(a)){const d=a.name??a.label??a.value??a.code??(typeof a.toString=="function"?a.toString():"");let m=a.code??a.value??"";if(!m&&d&&(m=d),!d&&!m)return null;const f=typeof m=="string"?m:String(m);return{label:d||f,value:f}}const o=String(a).trim();return o?{label:o,value:o}:null}).filter(Boolean)}function je(l=[]){return(Array.isArray(l)?l:[]).map(e=>({...e}))}function sa(l,e=[]){if(!Array.isArray(l))return je(e);const a=$(l);return a.length?a:je(e)}function Z(l){return(Array.isArray(l)?l:l==null||l===""?[]:[l]).map(a=>z(a)).filter(a=>a!=="")}function ia(l,e){const a=z(e);if(!a)return"";const d=(Array.isArray(l==null?void 0:l.value)?l.value:Array.isArray(l)?l:[]).find(m=>m.value===a||m.label===a);return(d==null?void 0:d.label)??a}const Ie=[{label:"管理員",value:"admin"},{label:"主管",value:"supervisor"},{label:"員工",value:"employee"}],oe=Object.freeze([{key:"employeeNo",header:"employeeId",label:"員工編號",description:"員工編號",required:!0,category:"基本資料"},{key:"name",header:"name",label:"姓名",description:"姓名",required:!0,category:"基本資料"},{key:"gender",header:"gender",label:"性別",description:"性別 (M=男, F=女, O=其他)",category:"基本資料"},{key:"idNumber",header:"idNumber",label:"身分證號",description:"身分證號",category:"基本資料"},{key:"birthday",header:"birthDate",label:"生日",description:"生日 (yyyy-mm-dd)",category:"基本資料"},{key:"birthplace",header:"birthPlace",label:"出生地",description:"出生地",category:"基本資料"},{key:"bloodType",header:"bloodType",label:"血型",description:"血型 (A/B/O/AB/HR)",category:"基本資料"},{key:"languages",header:"languages",label:"語言",description:"語言 (多個以逗號分隔)",category:"個人特質"},{key:"disabilityLevel",header:"disabilityLevel",label:"失能等級",description:"失能等級",category:"個人特質"},{key:"identityCategory",header:"identityCategory",label:"身分類別",description:"身分類別 (多個以逗號分隔)",category:"個人特質"},{key:"maritalStatus",header:"maritalStatus",label:"婚姻狀況",description:"婚姻狀況 (已婚/未婚/離婚/喪偶)",category:"家庭狀況"},{key:"dependents",header:"dependents",label:"扶養人數",description:"扶養人數",category:"家庭狀況"},{key:"email",header:"email",label:"電子郵件",description:"電子郵件 (必填唯一)",required:!0,category:"聯絡資訊"},{key:"phone",header:"mobile",label:"手機號碼",description:"手機號碼",category:"聯絡資訊"},{key:"landline",header:"landline",label:"市話",description:"市話",category:"聯絡資訊"},{key:"householdAddress",header:"householdAddress",label:"戶籍地址",description:"戶籍地址",category:"聯絡資訊"},{key:"contactAddress",header:"contactAddress",label:"聯絡地址",description:"聯絡地址",category:"聯絡資訊"},{key:"lineId",header:"lineId",label:"Line 帳號",description:"Line 帳號",category:"聯絡資訊"},{key:"organization",header:"organization",label:"所屬機構",description:"所屬機構",category:"組織與職務"},{key:"department",header:"department",label:"部門 ID",description:"部門 ID",category:"組織與職務"},{key:"subDepartment",header:"subDepartment",label:"子部門 ID",description:"子部門 ID",category:"組織與職務"},{key:"supervisor",header:"supervisor",label:"主管員工 ID",description:"主管員工 ID",category:"組織與職務"},{key:"title",header:"title",label:"職稱",description:"職稱",category:"組織與職務"},{key:"practiceTitle",header:"practiceTitle",label:"執業職稱",description:"執業職稱",category:"組織與職務"},{key:"employmentStatus",header:"status",label:"人員狀態",description:"人員狀態 (正職員工/試用期/離職/留職停薪)",category:"雇用設定"},{key:"probationDays",header:"probationDays",label:"試用期天數",description:"試用期天數",category:"雇用設定"},{key:"isPartTime",header:"partTime",label:"是否兼職",description:"是否兼職 (TRUE/FALSE)",category:"雇用設定"},{key:"isClocking",header:"needClockIn",label:"是否需打卡",description:"是否需打卡 (TRUE/FALSE)",category:"雇用設定"},{key:"educationLevel",header:"education_level",label:"學歷程度",description:"學歷程度",category:"學歷資訊"},{key:"schoolName",header:"education_school",label:"畢業學校",description:"畢業學校",category:"學歷資訊"},{key:"major",header:"education_major",label:"主修科目",description:"主修科目",category:"學歷資訊"},{key:"graduationStatus",header:"education_status",label:"學歷狀態",description:"學歷狀態 (畢業/肄業)",category:"學歷資訊"},{key:"graduationYear",header:"education_graduationYear",label:"畢業年份",description:"畢業年份",category:"學歷資訊"},{key:"serviceType",header:"militaryService_type",label:"役別類型",description:"役別類型 (志願役/義務役)",category:"兵役資訊"},{key:"militaryBranch",header:"militaryService_branch",label:"軍種",description:"軍種",category:"兵役資訊"},{key:"militaryRank",header:"militaryService_rank",label:"軍階",description:"軍階",category:"兵役資訊"},{key:"dischargeYear",header:"militaryService_dischargeYear",label:"退伍年份",description:"退伍年份",category:"兵役資訊"},{key:"emergency1.name",header:"emergency1_name",label:"緊急聯絡人1 姓名",description:"緊急聯絡人1 姓名",category:"緊急聯絡人"},{key:"emergency1.relation",header:"emergency1_relation",label:"緊急聯絡人1 關係",description:"緊急聯絡人1 關係",category:"緊急聯絡人"},{key:"emergency1.phone1",header:"emergency1_phone1",label:"緊急聯絡人1 電話1",description:"緊急聯絡人1 電話1",category:"緊急聯絡人"},{key:"emergency1.phone2",header:"emergency1_phone2",label:"緊急聯絡人1 電話2",description:"緊急聯絡人1 電話2",category:"緊急聯絡人"},{key:"emergency2.name",header:"emergency2_name",label:"緊急聯絡人2 姓名",description:"緊急聯絡人2 姓名",category:"緊急聯絡人"},{key:"emergency2.relation",header:"emergency2_relation",label:"緊急聯絡人2 關係",description:"緊急聯絡人2 關係",category:"緊急聯絡人"},{key:"emergency2.phone1",header:"emergency2_phone1",label:"緊急聯絡人2 電話1",description:"緊急聯絡人2 電話1",category:"緊急聯絡人"},{key:"emergency2.phone2",header:"emergency2_phone2",label:"緊急聯絡人2 電話2",description:"緊急聯絡人2 電話2",category:"緊急聯絡人"},{key:"hireDate",header:"hireDate",label:"到職日期",description:"到職日期 (yyyy-mm-dd)",category:"任職期間"},{key:"appointDate",header:"startDate",label:"起聘日期",description:"起聘日期 (yyyy-mm-dd)",category:"任職期間"},{key:"resignDate",header:"resignationDate",label:"離職日期",description:"離職日期 (yyyy-mm-dd)",category:"任職期間"},{key:"dismissDate",header:"dismissalDate",label:"解聘日期",description:"解聘日期 (yyyy-mm-dd)",category:"任職期間"},{key:"reAppointDate",header:"rehireStartDate",label:"再任起聘",description:"再任起聘 (yyyy-mm-dd)",category:"任職期間"},{key:"reDismissDate",header:"rehireEndDate",label:"再任解聘",description:"再任解聘 (yyyy-mm-dd)",category:"任職期間"},{key:"employmentNote",header:"appointment_remark",label:"任職備註",description:"任職備註",category:"任職期間"},{key:"salaryType",header:"salaryType",label:"薪資類型",description:"薪資類型 (月薪/日薪/時薪)",category:"薪資與帳戶"},{key:"salaryAmount",header:"salaryAmount",label:"薪資金額",description:"薪資金額",category:"薪資與帳戶"},{key:"laborPensionSelf",header:"laborPensionSelf",label:"自提勞退 (%)",description:"自提勞退 (%)",category:"薪資與帳戶"},{key:"employeeAdvance",header:"employeeAdvance",label:"員工墊付金額",description:"員工墊付金額",category:"薪資與帳戶"},{key:"salaryAccountA.bank",header:"salaryAccountA_bank",label:"薪資帳戶A 銀行代號",description:"薪資帳戶A 銀行代號",category:"薪資與帳戶"},{key:"salaryAccountA.acct",header:"salaryAccountA_acct",label:"薪資帳戶A 帳號",description:"薪資帳戶A 帳號",category:"薪資與帳戶"},{key:"salaryAccountB.bank",header:"salaryAccountB_bank",label:"薪資帳戶B 銀行代號",description:"薪資帳戶B 銀行代號",category:"薪資與帳戶"},{key:"salaryAccountB.acct",header:"salaryAccountB_acct",label:"薪資帳戶B 帳號",description:"薪資帳戶B 帳號",category:"薪資與帳戶"},{key:"salaryItems",header:"salaryItems",label:"其他薪資項目",description:"其他薪資項目 (多個逗號分隔)",category:"薪資與帳戶"}]);function ua(l={}){const e=l.description||l.label||l.header||l.key||"";if(!l.required)return typeof e=="string"?e:String(e);const a=typeof e=="string"?e:String(e);return a.includes("必填")?a:`${a} (必填)`}const da=oe.filter(l=>l.required).map(l=>l.key),ye=Object.freeze(oe.reduce((l,e)=>(l[e.key]=e.header,l),{})),ca=Object.freeze([{employeeId:"EMP-0001",name:"王曉明",gender:"M",birthDate:"1990-03-12",email:"import.hr001@example.com",mobile:"0912000001",organization:"總公司",department:"HR001",title:"人資專員",status:"正職員工",hireDate:"2020-07-01",partTime:"FALSE",needClockIn:"TRUE",lineId:"hr-king",languages:"中文,英文"},{employeeId:"EMP-0002",name:"林語彤",gender:"F",birthDate:"1994-08-25",email:"import.hr002@example.com",mobile:"0912000002",organization:"台北院區",department:"NUR101",title:"資深護理師",status:"試用期",hireDate:"2024-02-15",partTime:"FALSE",needClockIn:"TRUE",lineId:"nurse-ruby",languages:"中文,台語"},{employeeId:"EMP-0003",name:"陳建宇",gender:"M",birthDate:"1988-11-05",email:"import.hr003@example.com",mobile:"0912000003",organization:"總公司",department:"IT001",title:"系統工程師",status:"正職員工",hireDate:"2019-11-20",partTime:"FALSE",needClockIn:"FALSE",lineId:"it-jack",languages:"中文,英文"},{employeeId:"EMP-0004",name:"吳雅珊",gender:"F",birthDate:"1992-01-18",email:"import.hr004@example.com",mobile:"0912000004",organization:"總公司",department:"FIN201",title:"會計專員",status:"留職停薪",hireDate:"2018-04-09",partTime:"TRUE",needClockIn:"FALSE",lineId:"fin-olivia",languages:"中文,英文"},{employeeId:"EMP-0005",name:"張志強",gender:"M",birthDate:"1985-06-30",email:"import.hr005@example.com",mobile:"0912000005",organization:"新北院區",department:"OPS301",title:"營運主管",status:"離職",hireDate:"2016-01-03",resignationDate:"2023-12-31",partTime:"FALSE",needClockIn:"TRUE",lineId:"ops-alex",languages:"中文,英文"}]),Ue=F(()=>oe.map(l=>({...l,displayDescription:ua(l)}))),hl=[{level:"L1",description:"一般使用者 / 基層專員"},{level:"L2",description:"資深專員 / 小組長"},{level:"L3",description:"部門主管 / 課長"},{level:"L4",description:"處室主管 / 協理"},{level:"L5",description:"高階決策者 / 最高主管"}],Ce=E([]),xe=E([]),Fe=E([]),$e=E([]),Ye=E([]),qe=E([]),Ke=E([]),Ge=E([]),_l=E([]),be=E([]),Xe=((ql=Ie.find(l=>l.value==="employee"))==null?void 0:ql.value)??((Kl=Ie[0])==null?void 0:Kl.value)??"",he=E(!1),_e=E(null),Ve=E(!1),X=E(null),de=E([]),ne=E([]),Y=E([]),C=ge({columnMappings:{...ye},options:{defaultRole:Xe,resetPassword:"",sendWelcomeEmail:!1}}),H=Object.freeze(["organization","department","subDepartment"]),Vl=Object.freeze({organization:"機構",department:"部門",subDepartment:"子部門"}),ma=Object.freeze({organization:["organization","org","organizations"],department:["department","dept","departments"],subDepartment:["subDepartment","subdept","sub_department","subDepartments"]}),pa=Object.freeze(Object.entries(ma).reduce((l,[e,a])=>((Array.isArray(a)?a:[]).concat(e).forEach(d=>{typeof d=="string"&&d.trim()&&(l[d.trim().toLowerCase()]=e)}),l),{})),K=E(!1),we=E(""),W=E([...H]),x=ge({}),ee=ge({}),q=ge({}),B=ge({}),M=ge({}),ce=E(!1),wl=F(()=>{const l=!!X.value,e=(de.value||[]).length>0,a=(ne.value||[]).length>0,o=(Y.value||[]).length>0,d=K.value,m=!!we.value,f=W.value.some(v=>(x[v]||[]).length>0),p=Object.values(B).some(v=>Object.keys(v||{}).length>0)||Object.values(M).some(v=>Array.isArray(v)&&v.length>0),s=Object.keys(ye),c=new Set([...s,...Object.keys(C.columnMappings)]),b=Array.from(c).some(v=>{const V=C.columnMappings[v]??"",I=ye[v]??"";return V!==I}),g=C.options.defaultRole!==Xe||!!C.options.resetPassword||!!C.options.sendWelcomeEmail;return l||e||a||o||d||m||f||p||b||g});He(H,{resetPending:!0,resetOptions:!0,resetSelections:!0,resetResolved:!0});function Ae(l){Array.isArray(x[l])||(x[l]=[]),Array.isArray(ee[l])||(ee[l]=[]),(!q[l]||typeof q[l]!="object")&&(q[l]={}),(!B[l]||typeof B[l]!="object")&&(B[l]={}),Array.isArray(M[l])||(M[l]=[])}function He(l=[],{resetPending:e=!1,resetOptions:a=!1,resetSelections:o=!1,resetResolved:d=!1}={}){const m=new Set([...H,...Array.isArray(l)?l:[]]);W.value=Array.from(m),[x,ee,q].forEach(s=>{Object.keys(s).forEach(c=>{m.has(c)||delete s[c]})}),[B,M].forEach(s=>{Object.keys(s).forEach(c=>{m.has(c)||delete s[c]})}),W.value.forEach(s=>{Ae(s),e&&(x[s]=[]),a&&(ee[s]=[]),o&&(q[s]={}),d&&(B[s]={},M[s]=[])})}function fa(l){if(l&&Vl[l])return Vl[l];const e=typeof l=="string"?l:"";if(!e.trim())return"其他參照";const a=e.replace(/[_-]+/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").trim();return a.charAt(0).toUpperCase()+a.slice(1)}const va=F(()=>{const l=new Map;return Ue.value.forEach(e=>{const a=e.category||"其他欄位";l.has(a)||l.set(a,[]),l.get(a).push(e)}),Array.from(l.entries()).map(([e,a])=>({title:e,fields:a}))}),ga=F(()=>Ue.value.filter(l=>l.required).map(l=>l.label||l.description||l.header)),ya=F(()=>da.filter(l=>{const e=C.columnMappings[l];return typeof e!="string"||!e.trim()}));function ba(l){return l==null?'""':`"${String(l).replace(/"/g,'""')}"`}function ha(){const l=Ue.value.map(m=>m.header||m.key),e=Ue.value.map(m=>m.displayDescription||m.description||m.label||m.header||m.key),a=ca.map(m=>l.map(f=>m[f]??""));return`\uFEFF${[l,e,...a].map(m=>m.map(ba).join(",")).join(`
`)}`}function _a(){if(typeof window>"u"||typeof document>"u")return;const l=ha(),e=new Blob([l],{type:"text/csv;charset=utf-8;"}),a=window.URL&&typeof window.URL.createObjectURL=="function"&&window.URL||(typeof URL<"u"&&typeof URL.createObjectURL=="function"?URL:null);if(!a){N.warning("無法產生範本下載，請改用手動建立檔案");return}const o=a.createObjectURL(e),d=document.createElement("a");d.href=o,d.setAttribute("download",on),document.body.appendChild(d);try{d.click()}finally{document.body.removeChild(d),typeof a.revokeObjectURL=="function"&&a.revokeObjectURL(o)}}const Al=F(()=>!!X.value&&ya.value.length===0),Va=$(["護理師","照顧服務員","社工師","物理治療師","職能治療師","行政人員"]),wa=$(["護理師","社工師","物理治療師","職能治療師","醫師"]),Aa=$(["中文","台語","客語","英語","馬來語"]),Sa=$(["極重度","重度身心障礙","中度身心障礙","輕度身心障礙"]),La=$(["原住民","新住民","榮民"]),ka=$(["博士","碩士","大學","專科","高中職","國中以下"]),Da=$(["畢業","肄業"]),Ea=$(["父","母","配偶","子","女","兄","姊","弟","妹","其他"]),Ia=$(["院內","院外","線上","研討會","自學"]),Ua=$(["本薪","全勤","加班費","交通津貼","伙食津貼","績效獎金"]),Sl=[{key:"C03",ref:Ce,fallback:Va,label:"職稱"},{key:"C04",ref:xe,fallback:wa,label:"執業職稱"},{key:"C05",ref:Fe,fallback:Aa,label:"語言能力"},{key:"C06",ref:$e,fallback:Sa,label:"身心障礙等級"},{key:"C07",ref:Ye,fallback:La,label:"身分類別"},{key:"C08",ref:qe,fallback:ka,label:"教育程度"},{key:"C08-1",ref:Ke,fallback:Da,label:"畢業狀態"},{key:"C09",ref:Ge,fallback:Ea,label:"緊急聯絡人稱謂"},{key:"C10",ref:_l,fallback:Ia,label:"教育訓練積分類別"},{key:"C14",ref:be,fallback:Ua,label:"津貼項目"}],Ca=new Set(["C08-1"]);function We({notify:l=!0}={}){const e=[];return Sl.forEach(({ref:a,fallback:o,label:d})=>{(!Array.isArray(a.value)||a.value.length===0)&&(a.value=je(o),e.push(d))}),l&&e.length&&N.warning(`字典 ${e.join("、")} 尚未設定，已套用預設選項`),e}const Ta=["月薪","日薪","時薪"],Te=[{id:"R001",label:"填報",description:"提出申請與初始資料填寫"},{id:"R002",label:"覆核",description:"確認申請內容與佐證完整性"},{id:"R003",label:"審核",description:"評估申請是否符合政策與規範"},{id:"R004",label:"核定",description:"做出最終核准或駁回決策"},{id:"R005",label:"知會",description:"接收流程進度並保留紀錄"},{id:"R006",label:"財務覆核",description:"檢視成本預算與財務影響"},{id:"R007",label:"人資覆核",description:"確保人事政策與法規符合"}],Je=[{id:"U001",label:"L1",description:"單位承辦或第一層主管"},{id:"U002",label:"L2",description:"部門主管或組長"},{id:"U003",label:"L3",description:"處室主管或經理"},{id:"U004",label:"L4",description:"高階主管或副執行長"},{id:"U005",label:"L5",description:"執行長 / 院長 / 董事會"}],Ra=["資深","新人","外聘","志工"],Oa=["義務役","志願役","替代役","免役","尚未服役"],Ll=["A","B","O","AB","HR"],Na=new Date().getFullYear(),za=new Set(Te.map(l=>l.id)),kl=new Map(Te.map(l=>[l.label,l.id]));["填報人員","覆核人員","審核人員","核定人員","知會人員","財務覆核人員","人資覆核人員"].forEach((l,e)=>{const a=Te[e];a&&kl.set(l,a.id)});const Pa=new Set(Je.map(l=>l.id)),Ba=new Map(Je.map(l=>[l.label,l.id])),Ma=new Set(hl.map(l=>l.level)),ja=new Map([["一級","L1"],["二級","L2"],["三級","L3"],["四級","L4"],["五級","L5"],["一般職等","L1"],["資深職等","L2"],["主管職等","L3"]]);function Dl(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?za.has(e)?e:kl.get(e)??e:""}return l}function El(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?Pa.has(e)?e:Ba.get(e)??e:""}return l}function Il(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?Ma.has(e)?e:ja.get(e)??e:""}return l}function xa(l){return l?`${l.level}｜${l.description}`:""}function Fa(l){return l?`${l.id}｜${l.label}`:""}const Qe=E("account"),le=E([]),ae=E([]),se=E([]),me=E([]),Se=E(!1),Ze=E(!1);let Re=null,el="";function $a(l){const e=ae.value.find(a=>a._id===l);return e?`${e.name}(${e.code})`:l}function Ya(l={}){return(l==null?void 0:l._id)??(l==null?void 0:l.id)??(l==null?void 0:l.value)??(l==null?void 0:l.code)??(typeof l=="string"?l:"")}function Le(l){return l.status===401?(N.error("登入逾時，請重新登入"),na.push("/manager/login"),!0):!1}function Ul(l){return new Promise((e,a)=>{const o=new FileReader;o.onload=()=>e(typeof o.result=="string"?o.result:""),o.onerror=()=>a(new Error("READ_ERROR")),o.readAsDataURL(l)})}function Cl(l=[]){const e=l.slice(-1).map(a=>{var m;const o=a.response,d=typeof o=="object"&&o!==null&&"url"in o&&o.url||typeof o=="object"&&o!==null&&"data"in o&&((m=o.data)==null?void 0:m.url)||(typeof o=="string"?o:"");return{...a,url:a.url||d||"",status:"success",percentage:a.percentage??100}});n.value.photoList=e,n.value.photo=e.length&&e[0].url||""}async function qa({file:l,onSuccess:e,onError:a}){Ze.value=!0;try{const o=await Ul(l);e==null||e({url:o})}catch(o){a==null||a(o),N.error("照片載入失敗，請重新選擇檔案")}finally{Ze.value=!1}}function Ka(l,e,a){var o;e.url||(typeof l=="string"?e.url=l:l&&typeof l=="object"&&(e.url=l.url||((o=l==null?void 0:l.data)==null?void 0:o.url)||e.url||"")),Cl(a)}function Ga(l,e){Cl(e)}function Xa(){N.warning("僅能上傳一張照片")}function Ha(l,e=""){return l?{name:e?`${e} 照片`:"員工照片",url:l,status:"success",percentage:100}:null}function ll(l=[]){return(Array.isArray(l)?l:[l]).map(e=>{var o;if(!e)return"";if(typeof e=="string")return e;if(e.url)return e.url;const a=e.response;if(typeof a=="string")return a;if(typeof a=="object"&&a!==null){if("url"in a&&a.url)return a.url;if("data"in a&&((o=a.data)!=null&&o.url))return a.data.url}return""}).filter(e=>typeof e=="string"&&e)}function Wa(l=[]){return ll(l)}function Tl(l=[],e="附件"){return(Array.isArray(l)?l:[l]).map((a,o)=>{var d;if(!a)return null;if(typeof a=="string")return{name:`${e}${o+1}`,url:a,status:"success",percentage:100,uid:`${e}-${o}`};if(typeof a=="object"){let m=a.url;if(!m){const p=a.response;typeof p=="string"?m=p:p&&typeof p=="object"&&(m=p.url||((d=p==null?void 0:p.data)==null?void 0:d.url)||"")}if(!m)return null;const f={...a,name:a.name||`${e}${o+1}`,url:m,status:"success",percentage:a.percentage??100};return f.uid||(f.uid=`${e}-${o}`),f}return null}).filter(a=>a&&typeof a.url=="string"&&a.url)}function Rl(l,e="附件"){if(!l)return[];const a=Array.isArray(l)?l:[l];return Tl(a,e)}function Oe(l){return Array.isArray(l)?l.filter(e=>e!==""&&e!==null&&e!==void 0):l===""||l===null||l===void 0?[]:[l]}function pe(l){return l===""||l===null||l===void 0?"":typeof l=="string"?l:String(l)}function Ol(){const l=Array.isArray(be.value)?be.value:[];return new Set(l.map(e=>{if(e&&typeof e=="object"){const a=e.value??e.code??e.name??e.label??(typeof e.toString=="function"?e.toString():"");return pe(a)}return pe(e)}).filter(Boolean))}function ke(l){const e=Ol();return Oe(l).map(pe).filter(a=>e.has(a))}function Ne(l=[],e=[]){return l.length!==e.length?!1:l.every((a,o)=>a===e[o])}function Ja(l,e){return l==="licenses"?`證照${e+1}-附件`:`教育訓練${e+1}-附件`}function Nl(l,e,a){const o=l==="licenses"?n.value.licenses:n.value.trainings;if(!Array.isArray(o)||!o[e])return;const d=Ja(l,e);o[e].fileList=Tl(a,d)}async function zl({file:l,onSuccess:e,onError:a}){try{const o=await Ul(l);e==null||e({url:o})}catch(o){a==null||a(o),N.error("檔案載入失敗，請重新選擇")}}function Pl(l,e,a,o,d){var m;o.url||(typeof a=="string"?o.url=a:a&&typeof a=="object"&&(o.url=a.url||((m=a==null?void 0:a.data)==null?void 0:m.url)||o.url||"")),Nl(l,e,d)}function Bl(l,e,a,o){Nl(l,e,o)}function P(l){if(l===""||l===null||l===void 0)return null;const e=Number(l);return Number.isFinite(e)?e:null}function al(l){return l==null?"":String(l)}function fe(l){return l==null||l===""?"":l}function Qa(l=[]){return Array.isArray(l)?l.map((e={},a)=>({name:(e==null?void 0:e.name)??"",number:(e==null?void 0:e.number)??"",startDate:(e==null?void 0:e.startDate)??(e==null?void 0:e.issueDate)??"",endDate:(e==null?void 0:e.endDate)??(e==null?void 0:e.expiryDate)??"",fileList:Rl((e==null?void 0:e.fileList)??(e==null?void 0:e.files)??(e!=null&&e.file?[e.file]:[]),`證照${a+1}-附件`)})):[]}function Za(l=[]){return Array.isArray(l)?l.map((e={},a)=>({course:(e==null?void 0:e.course)??(e==null?void 0:e.name)??"",courseNo:(e==null?void 0:e.courseNo)??(e==null?void 0:e.code)??"",date:(e==null?void 0:e.date)??"",category:Z((e==null?void 0:e.category)??(e==null?void 0:e.categories)),score:P(e==null?void 0:e.score),fileList:Rl((e==null?void 0:e.fileList)??(e==null?void 0:e.files)??(e!=null&&e.file?[e.file]:[]),`教育訓練${a+1}-附件`)})):[]}async function et(){try{const l=await re("/api/other-control-settings/item-settings");if(Le(l))return;if(!l.ok)throw new Error(`ITEM_SETTINGS_FETCH_FAILED_${l.status}`);const e=await l.json(),a=e!=null&&e.itemSettings&&typeof e.itemSettings=="object"?e.itemSettings:e&&typeof e=="object"&&!Array.isArray(e)?e:{},o=[];Sl.forEach(({key:m,ref:f,fallback:p,label:s})=>{const c=a==null?void 0:a[m];(!Array.isArray(c)||!c.length)&&!Ca.has(m)&&o.push(s),f.value=sa(c,p)});const d=[...new Set(o)].filter(Boolean);d.length&&N.warning(`字典 ${d.join("、")} 尚未設定，已套用預設選項`)}catch(l){console.warn("載入字典項目失敗：",l),We()}}async function Ml(){const l=await re("/api/departments");Le(l)||l.ok&&(ae.value=await l.json())}async function tl(l=""){const e=l?`/api/sub-departments?department=${l}`:"/api/sub-departments",a=await re(e);Le(a)||a.ok&&(se.value=await a.json())}async function lt(){const l=await re("/api/organizations");Le(l)||l.ok&&(me.value=await l.json())}async function rl(){const l=await re("/api/employees");if(!Le(l)&&l.ok){const e=await l.json();le.value=e.map(a=>{var d,m,f,p,s,c,b,g,v,V,I,w,U,O,j;const o=(a==null?void 0:a.appointment)??{};return{...a,title:z(a==null?void 0:a.title),practiceTitle:z(a==null?void 0:a.practiceTitle),languages:Z(a==null?void 0:a.languages),disabilityLevel:z(a==null?void 0:a.disabilityLevel),identityCategory:Z(a==null?void 0:a.identityCategory),permissionGrade:Il(a==null?void 0:a.permissionGrade),signRole:Dl(a==null?void 0:a.signRole),signLevel:El(a==null?void 0:a.signLevel),organization:((d=a.organization)==null?void 0:d._id)||a.organization||"",department:((m=a.department)==null?void 0:m._id)||a.department||"",subDepartment:((f=a.subDepartment)==null?void 0:f._id)||a.subDepartment||"",laborPensionSelf:P(a==null?void 0:a.laborPensionSelf)??0,employeeAdvance:P(a==null?void 0:a.employeeAdvance)??0,salaryItems:ke(a==null?void 0:a.salaryItems),height:P(((p=a==null?void 0:a.medicalCheck)==null?void 0:p.height)??(a==null?void 0:a.height)),weight:P(((s=a==null?void 0:a.medicalCheck)==null?void 0:s.weight)??(a==null?void 0:a.weight)),medicalBloodType:((c=a==null?void 0:a.medicalCheck)==null?void 0:c.bloodType)??(a==null?void 0:a.medicalBloodType)??"",educationLevel:z(((b=a==null?void 0:a.education)==null?void 0:b.level)??(a==null?void 0:a.educationLevel)),schoolName:((g=a==null?void 0:a.education)==null?void 0:g.school)??(a==null?void 0:a.schoolName)??"",major:((v=a==null?void 0:a.education)==null?void 0:v.major)??(a==null?void 0:a.major)??"",graduationStatus:z(((V=a==null?void 0:a.education)==null?void 0:V.status)??(a==null?void 0:a.graduationStatus)),graduationYear:al(((I=a==null?void 0:a.education)==null?void 0:I.graduationYear)??(a==null?void 0:a.graduationYear)??""),serviceType:((w=a==null?void 0:a.militaryService)==null?void 0:w.serviceType)??(a==null?void 0:a.serviceType)??"",militaryBranch:((U=a==null?void 0:a.militaryService)==null?void 0:U.branch)??(a==null?void 0:a.militaryBranch)??"",militaryRank:((O=a==null?void 0:a.militaryService)==null?void 0:O.rank)??(a==null?void 0:a.militaryRank)??"",dischargeYear:P(((j=a==null?void 0:a.militaryService)==null?void 0:j.dischargeYear)??(a==null?void 0:a.dischargeYear)),hireDate:fe((o==null?void 0:o.hireDate)??(a==null?void 0:a.hireDate)),appointDate:fe((o==null?void 0:o.appointDate)??(o==null?void 0:o.startDate)??(a==null?void 0:a.appointDate)),resignDate:fe((o==null?void 0:o.resignationDate)??(a==null?void 0:a.resignDate)),dismissDate:fe((o==null?void 0:o.dismissalDate)??(a==null?void 0:a.dismissDate)),reAppointDate:fe((o==null?void 0:o.reAppointDate)??(o==null?void 0:o.rehireStartDate)??(a==null?void 0:a.reAppointDate)),reDismissDate:fe((o==null?void 0:o.reDismissDate)??(o==null?void 0:o.rehireEndDate)??(a==null?void 0:a.reDismissDate)),employmentNote:al((o==null?void 0:o.remark)??(a==null?void 0:a.employmentNote)??"")}})}}Rt(()=>{We({notify:!1}),et(),Ml(),rl(),lt(),tl()});const ol={username:"",password:"",role:"employee",permissionGrade:"",signRole:"",signTags:[],signLevel:"",employeeNo:"",name:"",gender:"",birthday:"",idNumber:"",birthplace:"",bloodType:"",languages:[],disabilityLevel:"",identityCategory:[],maritalStatus:"",dependents:0,email:"",phone:"",landline:"",householdAddress:"",contactAddress:"",lineId:"",photo:"",photoList:[],organization:"",department:"",supervisor:null,subDepartment:"",title:"",practiceTitle:"",isPartTime:!1,isClocking:!1,employmentStatus:"",probationDays:"",height:null,weight:null,medicalBloodType:"",educationLevel:"",schoolName:"",major:"",graduationStatus:"",graduationYear:"",serviceType:"",militaryBranch:"",militaryRank:"",dischargeYear:null,emergency1:{name:"",relation:"",phone1:"",phone2:""},emergency2:{name:"",relation:"",phone1:"",phone2:""},keywords:"",experiences:[],licenses:[],trainings:[],hireDate:"",appointDate:"",resignDate:"",dismissDate:"",reAppointDate:"",reDismissDate:"",employmentNote:"",salaryType:"",salaryAmount:0,laborPensionSelf:0,employeeAdvance:0,salaryAccountA:{bank:"",acct:""},salaryAccountB:{bank:"",acct:""},salaryItems:[]},n=E({...ol}),jl=E(),xl=l=>({validator:(e,a)=>a===""||a===null||a===void 0?Promise.resolve():typeof a!="number"||!Number.isFinite(a)||a<0?Promise.reject(new Error(`請輸入正確的${l}`)):Promise.resolve(),trigger:["blur","change"]}),at={username:[{required:!0,message:"請輸入登入帳號",trigger:"blur"}],password:[{required:!0,message:"請輸入登入密碼",trigger:"blur"}],role:[{required:!0,message:"請選擇系統權限",trigger:"change"}],organization:[{required:!0,message:"請選擇所屬機構",trigger:"change"}],department:[{required:!0,message:"請選擇所屬部門",trigger:"change"}],gender:[{required:!0,message:"請選擇性別",trigger:"change"}],name:[{required:!0,message:"請輸入員工姓名",trigger:"blur"}],email:[{required:!0,message:"請輸入有效 Email",type:"email",trigger:["blur","change"]}],laborPensionSelf:[xl("勞退自提")],employeeAdvance:[xl("員工預支")],salaryItems:[{validator:(l,e)=>{if(e===""||e===null||e===void 0)return Promise.resolve();if(!Array.isArray(e))return Promise.reject(new Error("請選擇有效的薪資項目"));const a=Ol();return Oe(e).map(pe).some(m=>!a.has(m))?Promise.reject(new Error("請選擇有效的薪資項目")):Promise.resolve()},trigger:"change"}]},tt=F(()=>n.value.organization?ae.value.filter(l=>l.organization===n.value.organization):[]),rt=F(()=>n.value.department?se.value.filter(l=>l.department===n.value.department):[]),ot=F(()=>n.value.organization&&n.value.department?le.value.filter(l=>l.role==="supervisor"&&l.organization===n.value.organization&&l.department===n.value.department):[]);De(he,l=>{l?_e.value=null:_e.value&&(nl(_e.value),_e.value=null)}),De(()=>n.value.department,async(l,e)=>{const a=n.value.subDepartment;if(!l){se.value=[],n.value.subDepartment&&(n.value.subDepartment="");return}if(await tl(l),n.value.department!==l)return;const o=n.value.subDepartment===a;!(!!a&&se.value.some(f=>Ya(f)===a))&&l!==e&&o&&(n.value.subDepartment="")}),De(()=>n.value.salaryItems,l=>{const e=Oe(l),a=e.map(pe),o=ke(a);Ne(o,a)?Ne(a,e)||(n.value.salaryItems=a):n.value.salaryItems=o},{deep:!0}),De(()=>be.value,()=>{const l=Oe(n.value.salaryItems),e=l.map(pe),a=ke(e);Ne(a,e)?Ne(e,l)||(n.value.salaryItems=e):n.value.salaryItems=a},{deep:!0});function nt(){n.value.graduationStatus=""}function st(){he.value=!0}async function Fl({resetMappings:l=!0,done:e}={}){if(wl.value)try{await pl.confirm("關閉後將清除目前的匯入檔案、預覽與對應設定，確定要離開？","確認關閉匯入",{type:"warning",confirmButtonText:"確認關閉",cancelButtonText:"繼續編輯"})}catch{return!1}return _e.value={resetMappings:l,resetReferenceData:!0,resetResolvedReferences:!0},typeof e=="function"?e():he.value=!1,!0}async function it(){await Fl()}async function ut(l){await Fl({done:l})}function nl({resetMappings:l=!0,resetFile:e=!0,resetPreview:a=!0,resetErrors:o=!0,resetUploadList:d=!0,resetReferenceDialogs:m=!0,resetReferenceData:f=!0,resetResolvedReferences:p=l,resetOptions:s=l,referenceKeys:c}={}){if(Ve.value=!1,e&&(X.value=null),d&&(de.value=[]),a&&(ne.value=[]),o&&(Y.value=[]),m&&(K.value=!1,we.value="",ce.value=!1),f){const b=Array.isArray(c)?c:l?H:W.value;He(b,{resetPending:!0,resetOptions:!0,resetSelections:!0,resetResolved:p})}l&&(Object.keys(C.columnMappings).forEach(b=>{b in ye||delete C.columnMappings[b]}),Object.entries(ye).forEach(([b,g])=>{C.columnMappings[b]=g})),s&&(C.options.defaultRole=Xe,C.options.resetPassword="",C.options.sendWelcomeEmail=!1)}function te(l){return l==null?"":typeof l=="string"?l.trim().toLowerCase():String(l).trim().toLowerCase()}function $l(l=[]){const e=new Set,a=[];return l.forEach(o=>{const d=te(o);!d||e.has(d)||(e.add(d),a.push(d))}),a}function dt(){const l={},e={};return new Set([...W.value,...Object.keys(B),...Object.keys(M)]).forEach(o=>{Ae(o),l[o]={},Object.entries(B[o]||{}).forEach(([d,m])=>{typeof m=="string"&&m.trim()&&(l[o][d]=m)}),e[o]=$l(M[o])}),{valueMappingsPayload:l,ignorePayload:e}}function J(l){return l?l.normalizedValue?l.normalizedValue:te(l.value):""}function sl(l=""){const e=String(l).trim();return/^[a-fA-F0-9]{24}$/.test(e)||/^object_[a-fA-F0-9]{24}$/.test(e)}function ct(l,e){if(!e||typeof e!="object")return"";if(l==="organization"){const d=[e.name,e.unitName,e.orgCode,e.systemCode].filter(Boolean);if(d.length)return d.join(" / ")}if(l==="department"){const d=[e.organizationName,e.organizationCode,e.organizationUnitName].map(p=>p==null?"":String(p).trim()).filter(Boolean),m=[e.name,e.code].filter(Boolean),f=[];if(d.length&&f.push(d.join("｜")),m.length&&f.push(m.join("｜")),!f.length&&e.organization&&f.push(String(e.organization)),f.length)return f.join(" / ")}if(l==="subDepartment"){const d=[e.organizationName,e.organizationCode,e.organizationUnitName].map(s=>s==null?"":String(s).trim()).filter(Boolean),m=[e.departmentName,e.departmentCode].map(s=>s==null?"":String(s).trim()).filter(Boolean),f=[e.name,e.code].filter(Boolean),p=[];if(d.length&&p.push(d.join("｜")),m.length&&p.push(m.join("｜")),f.length&&p.push(f.join("｜")),!p.length&&e.department&&p.push(String(e.department)),p.length)return p.join(" / ")}const o=[e.label,e.name,e.title,e.code,e.value,e.id].map(d=>d==null?"":String(d).trim()).filter(Boolean).find(d=>d)||"";return o?sl(o)&&![e.label,e.name,e.title,e.code,e.value].map(m=>m==null?"":String(m).trim()).some(m=>m&&!sl(m))?"（缺少可辨識的標籤）":o:""}function il(l=""){return String(l).normalize("NFKC").replace(/^\uFEFF/,"").trim().toLowerCase()}function mt(l,e){const a=new Set;return e.forEach(o=>{const d=l==null?void 0:l[o];d!=null&&String(d).trim()!==""&&a.add(il(d))}),a}function pt(l=[],e=["name","code","id","orgCode","unitName","systemCode"]){const a=new Map;return(l||[]).forEach(o=>{mt(o,e).forEach(d=>{d&&!a.has(d)&&a.set(d,o)})}),a}function ze(l){const e=new Map((me.value||[]).map(o=>{const d=(o==null?void 0:o._id)??(o==null?void 0:o.id);return[d==null?"":String(d),o]})),a=new Map((ae.value||[]).map(o=>{const d=(o==null?void 0:o._id)??(o==null?void 0:o.id);return[d==null?"":String(d),{...o,organization:(o==null?void 0:o.organization)??""}]}));return l==="organization"?(me.value||[]).map(o=>({id:o._id??o.id??"",name:o.name??"",orgCode:o.orgCode??o.code??"",unitName:o.unitName??""})):l==="department"?(ae.value||[]).map(o=>{var d,m,f;return{id:o._id??o.id??"",name:o.name??"",code:o.code??"",organization:o.organization??"",organizationName:((d=e.get(String(o.organization??"")))==null?void 0:d.name)??"",organizationUnitName:((m=e.get(String(o.organization??"")))==null?void 0:m.unitName)??"",organizationCode:((f=e.get(String(o.organization??"")))==null?void 0:f.orgCode)??""}}):l==="subDepartment"?(se.value||[]).map(o=>{var d,m,f;return{id:o._id??o.id??"",name:o.name??"",code:o.code??"",department:o.department??"",departmentName:((d=a.get(String(o.department??"")))==null?void 0:d.name)??"",departmentCode:((m=a.get(String(o.department??"")))==null?void 0:m.code)??"",organization:((f=a.get(String(o.department??"")))==null?void 0:f.organization)??o.organization??"",organizationName:(()=>{var c;const p=a.get(String(o.department??"")),s=(p==null?void 0:p.organization)??o.organization??"";return((c=e.get(String(s)))==null?void 0:c.name)??""})(),organizationUnitName:(()=>{var c;const p=a.get(String(o.department??"")),s=(p==null?void 0:p.organization)??o.organization??"";return((c=e.get(String(s)))==null?void 0:c.unitName)??""})(),organizationCode:(()=>{var c;const p=a.get(String(o.department??"")),s=(p==null?void 0:p.organization)??o.organization??"";return((c=e.get(String(s)))==null?void 0:c.orgCode)??""})()}}):[]}function ft(l={}){const e=Object.keys(l||{}),a={};return e.forEach(o=>{const d=l[o]||{},m=Array.isArray(d.values)?d.values:[],f=Array.isArray(d.options)&&d.options.length?d.options:ze(o);let p=["id","code","name"];o==="organization"&&(p=["id","orgCode","name","unitName","systemCode"]);const s=pt(f,p);m.forEach(c=>{const b=(c==null?void 0:c.value)??"",g=(c==null?void 0:c.normalizedValue)||il(b);if(!g)return;const v=s.get(g)||s.get(il(String(b)));v!=null&&v.id?(Ae(o),B[o]||(B[o]={}),B[o][g]=String(v.id),M[o]=(M[o]||[]).filter(V=>V!==g)):(a[o]||(a[o]={values:[],options:f}),a[o].values.push(c))}),a[o]&&a[o].values.length===0&&delete a[o]}),{unresolved:a,keysUsed:e}}function vt(l={}){const e={},a=new Set(H);function o(d={}){const f=(Array.isArray(d==null?void 0:d.values)?d.values:Array.isArray(d)?d:[]).map(c=>{if(c&&typeof c=="object"){const g=c.value??c.name??c.label??c.code??c.id??c,v=Array.isArray(c.rows)?c.rows:[],V=te(g);return{...c,value:g,rows:v,normalizedValue:V}}const b=c??"";return{value:b,rows:[],normalizedValue:te(b)}}).filter(c=>c.value!=null&&String(c.value).trim()!==""),s=(Array.isArray(d==null?void 0:d.options)?d.options:[]).map((c,b)=>{if(c&&typeof c=="object"){const V=c._id??c.id??c.value??c.code??c.key??c.name??c.label??"",I=String(V||`option-${b}`),w=["label","name","title","code"].map(j=>(c==null?void 0:c[j])==null?"":String(c==null?void 0:c[j]).trim()).some(j=>j),U=I.trim(),O=w?c.label??c.name??c.title??c.code??"":sl(U)?"（缺少可辨識的標籤）":c.label??"";return{...c,id:I,label:O||U||`option-${b}`,name:c.name??O??U??`option-${b}`}}const g=c==null?"":String(c),v=g.trim()?g:`option-${b}`;return{id:v,label:g.trim()||v,name:g.trim()||v}}).filter(c=>["label","name","title","code"].map(v=>(c==null?void 0:c[v])==null?"":String(c==null?void 0:c[v]).trim()).some(v=>v)?!0:!!((c==null?void 0:c.id)==null?"":String(c.id).trim()));return{values:f,options:s}}return Object.entries(l||{}).forEach(([d,m])=>{if(d==null)return;const f=String(d).trim();if(!f)return;const p=pa[f.toLowerCase()]||f;a.add(p),e[p]=o(m)}),a.forEach(d=>{e[d]||(e[d]={values:[],options:[]})}),{normalized:e,keys:Array.from(a)}}function gt(l=[]){const e=new Set((me.value||[]).map(c=>(c._id??c.id??c.name??c).toString().trim().toLowerCase())),a=new Set((ae.value||[]).map(c=>(c.code??c._id??c.id??c.name??c).toString().trim().toLowerCase())),o=new Set((se.value||[]).map(c=>(c.code??c._id??c.id??c.name??c).toString().trim().toLowerCase())),d={organization:new Map,department:new Map,subDepartment:new Map};l.forEach((c,b)=>{const g=b+3,v=c.organization??"",V=c.department??"",I=c.subDepartment??"";if(v){const w=te(v);w&&!e.has(w)&&(d.organization.has(w)||d.organization.set(w,{value:v,rows:new Set}),d.organization.get(w).rows.add(g))}if(V){const w=te(V);w&&!a.has(w)&&(d.department.has(w)||d.department.set(w,{value:V,rows:new Set}),d.department.get(w).rows.add(g))}if(I){const w=te(I);w&&!o.has(w)&&(d.subDepartment.has(w)||d.subDepartment.set(w,{value:I,rows:new Set}),d.subDepartment.get(w).rows.add(g))}});const m=c=>Array.from(c.values()).map(b=>({value:b.value,rows:Array.from(b.rows),normalizedValue:te(b.value)})),f=(me.value||[]).map(c=>({id:c._id??c.id??"",name:c.name??"",orgCode:c.orgCode??c.code??"",unitName:c.unitName??""})),p=(ae.value||[]).map(c=>({id:c._id??c.id??"",name:c.name??"",code:c.code??"",organization:c.organization??""})),s=(se.value||[]).map(c=>({id:c._id??c.id??"",name:c.name??"",code:c.code??"",department:c.department??""}));return{organization:{values:m(d.organization),options:f},department:{values:m(d.department),options:p},subDepartment:{values:m(d.subDepartment),options:s}}}function ve(l,e){return Ae(l),q[l][e]||(q[l][e]={mode:"map",targetId:""}),q[l][e]}function yt(l={},e="",a=[]){we.value=e||"部分欄位需要對應既有的組織/部門資料",ce.value=!1;const o=(Array.isArray(a)&&a.length?a:Object.keys(l||{})).filter(f=>typeof f=="string"&&f.trim()!==""),d=o.length?o:[...H];He(d,{resetPending:!0,resetOptions:!0,resetSelections:!0});const m={organization:ze("organization"),department:ze("department"),subDepartment:ze("subDepartment")};W.value.forEach(f=>{const p=l&&typeof l=="object"?l[f]:void 0,s=Array.isArray(p==null?void 0:p.values)?p.values:[],c=Array.isArray(p==null?void 0:p.options)?p.options:[],b=c.length?c:m[f]||[];Ae(f),x[f]=s.map(g=>({...g})),ee[f]=b.map(g=>({...g})),q[f]={},s.forEach(g=>{var U,O;const v=J(g),V=ve(f,v),I=((U=B[f])==null?void 0:U[v])||"";((O=M[f])==null?void 0:O.includes(v))?(V.mode="ignore",V.targetId=""):I?(V.mode="map",V.targetId=I):(V.mode="map",V.targetId="")})}),K.value=!0}De(K,l=>{l&&console.log("[ref-mapping] dialog opened; sections snapshot =",(W.value||[]).map(e=>{var a,o;return{k:e,values:((a=x[e])==null?void 0:a.length)||0,options:((o=ee[e])==null?void 0:o.length)||0}}))});async function ul({triggeredByMapping:l=!1}={}){if(!X.value){const e=l?"原始檔案已重置，請重新選擇匯入檔案後再試":"請先選擇要匯入的檔案";N.warning(e);return}if(!Al.value){N.warning("請確認必要欄位對應是否完整");return}Ve.value=!0;try{const e=new FormData;e.append("file",X.value),e.append("mappings",JSON.stringify(C.columnMappings)),e.append("options",JSON.stringify(C.options));const{valueMappingsPayload:a,ignorePayload:o}=dt();e.append("valueMappings",JSON.stringify(a)),e.append("ignore",JSON.stringify(o));const d=await zt(e);let m={};try{m=await d.json()}catch{m={}}if(d.status===409){const{normalized:p,keys:s}=vt((m==null?void 0:m.missingReferences)||{});let c=p,b=s.length?s:[...H];if(b.every(U=>{var O,j;return!((j=(O=c[U])==null?void 0:O.values)!=null&&j.length)}))try{const O=(await gl(X.value)).map(j=>bl(j,C.columnMappings));c=gt(O),b=Array.from(new Set([...b,...Object.keys(c||{})]))}catch(U){console.warn("client-side missing refs build failed:",U)}const{unresolved:v,keysUsed:V}=ft(c),I=V&&V.length?V:b,w=Object.values(v).some(U=>{var O;return(((O=U==null?void 0:U.values)==null?void 0:O.length)||0)>0});Y.value=Array.isArray(m==null?void 0:m.errors)?m.errors:[],w?(yt(v,m==null?void 0:m.message,I),N.warning((m==null?void 0:m.message)||"匯入資料存在未對應的組織或部門資訊，請完成對應後重新提交")):await ul({triggeredByMapping:!0});return}if(!d.ok){Y.value=Array.isArray(m==null?void 0:m.errors)?m.errors:[];const p=typeof(m==null?void 0:m.rowNumber)=="number"?`（停在第 ${m.rowNumber} 列）`:"",s=(m==null?void 0:m.message)||(m==null?void 0:m.error)||"批量匯入失敗，請稍後再試",c=p&&!s.includes(p)?`${s}${p}`:s;throw new Error(c)}const f=Array.isArray(m==null?void 0:m.preview)?m.preview:null;Array.isArray(f)&&f.length&&(ne.value=f),Y.value=Array.isArray(m==null?void 0:m.errors)?m.errors:[],Y.value.length?N.warning("匯入完成，但有部分資料需要檢查"):N.success("匯入成功"),await rl(),Y.value.length||(K.value=!1,we.value="")}catch(e){const a=(e==null?void 0:e.message)||"批量匯入失敗，請稍後再試";N.error(a)}finally{Ve.value=!1}}async function bt(){if(!X.value){N.warning("原始檔案已重置，請重新選擇匯入檔案後再試"),K.value=!1;return}const l=Array.from(new Set([...W.value,...Object.keys(x)])),e=[];if(l.forEach(a=>{x[a].forEach(o=>{const d=J(o),m=q[a][d];(!m||m.mode==="map"&&!m.targetId)&&e.push(o.value||d)})}),e.length){N.warning("請為所有未對應的項目選擇既有資料或設定忽略");return}l.forEach(a=>{x[a].forEach(o=>{const d=J(o),m=q[a][d];m&&(m.mode==="ignore"?(delete B[a][d],M[a]=$l([...M[a],d])):m.mode==="map"&&m.targetId&&(B[a][d]=m.targetId,M[a]=M[a].filter(f=>f!==d)))})}),ce.value=!0;try{await ul({triggeredByMapping:!0})}finally{ce.value=!1}}async function Yl(l=null){var e,a,o,d,m;if(We(),l!==null){Re=l;const f=le.value[l];el=f._id||"",n.value={...structuredClone(ol),...f,password:"",photoList:[]},n.value.title=z(n.value.title),n.value.practiceTitle=z(n.value.practiceTitle),n.value.languages=Z(n.value.languages),n.value.disabilityLevel=z(n.value.disabilityLevel),n.value.permissionGrade=Il(n.value.permissionGrade),n.value.signRole=Dl(n.value.signRole),n.value.signLevel=El(n.value.signLevel),n.value.photo=n.value.photo||"";const p=Ha(n.value.photo,n.value.name);n.value.photoList=p?[p]:[],n.value.licenses=Qa(f.licenses??[]),n.value.trainings=Za(f.trainings??[]),n.value.laborPensionSelf=P(n.value.laborPensionSelf)??0,n.value.employeeAdvance=P(n.value.employeeAdvance)??0,n.value.salaryItems=ke(n.value.salaryItems);const s=f.education??{};!n.value.educationLevel&&s.level&&(n.value.educationLevel=s.level),!n.value.schoolName&&s.school&&(n.value.schoolName=s.school),!n.value.major&&s.major&&(n.value.major=s.major),!n.value.graduationStatus&&s.status&&(n.value.graduationStatus=s.status),n.value.graduationYear=al(n.value.graduationYear||s.graduationYear||""),n.value.identityCategory=Z(n.value.identityCategory),n.value.height=P(f.height??((e=f.medicalCheck)==null?void 0:e.height)),n.value.weight=P(f.weight??((a=f.medicalCheck)==null?void 0:a.weight)),n.value.medicalBloodType=f.medicalBloodType??((o=f.medicalCheck)==null?void 0:o.bloodType)??"";const c=f.militaryService??{};n.value.serviceType=n.value.serviceType||c.serviceType||"",n.value.militaryBranch=n.value.militaryBranch||c.branch||"",n.value.militaryRank=n.value.militaryRank||c.rank||"";const b=n.value.dischargeYear===""||n.value.dischargeYear===null||n.value.dischargeYear===void 0?c.dischargeYear:n.value.dischargeYear;n.value.dischargeYear=P(b),n.value.department=((d=f.department)==null?void 0:d._id)||f.department||"",n.value.subDepartment=((m=f.subDepartment)==null?void 0:m._id)||f.subDepartment||"",n.value.educationLevel=z(n.value.educationLevel),n.value.graduationStatus=z(n.value.graduationStatus)}else Re=null,el="",Qe.value="account",n.value={...structuredClone(ol)},n.value.licenses=[],n.value.trainings=[];if(await Ml(),n.value.department&&!/^[0-9a-fA-F]{24}$/.test(n.value.department)){const f=ae.value.find(p=>p.name===n.value.department);f&&(n.value.department=f._id)}await tl(n.value.department),Se.value=!0}async function ht(){var p;let l;try{await((p=jl.value)==null?void 0:p.validate())}catch(s){l=s}if(l){const s=Object.values(l).flat().map(c=>c.message.replace(/^請(?:輸入|選擇)(?:有效)?\s*/,""));pl.alert(`請補齊：${s.join("、")}`);return}const e=n.value,a={...e};a.title=z(e.title),a.practiceTitle=z(e.practiceTitle);const o=Wa(e.photoList);o.length?(a.photoList=o,a.photo=o[0]):Re!==null?(a.photoList=[],a.photo=""):(delete a.photoList,e.photo||delete a.photo),a.languages=Z(e.languages),a.identityCategory=Z(e.identityCategory),a.disabilityLevel=z(e.disabilityLevel),a.educationLevel=z(e.educationLevel),a.graduationStatus=z(e.graduationStatus),a.laborPensionSelf=P(e.laborPensionSelf)??0,a.employeeAdvance=P(e.employeeAdvance)??0,a.salaryItems=ke(e.salaryItems),a.dischargeYear=P(e.dischargeYear),(a.supervisor===""||a.supervisor===null)&&delete a.supervisor;const d=(Array.isArray(e.licenses)?e.licenses:[]).map(s=>{const c=ll((s==null?void 0:s.fileList)??[]),b=typeof(s==null?void 0:s.name)=="string"?s.name.trim():(s==null?void 0:s.name)??"",g=typeof(s==null?void 0:s.number)=="string"?s.number.trim():(s==null?void 0:s.number)??"",v=(s==null?void 0:s.startDate)||"",V=(s==null?void 0:s.endDate)||"";return{name:b,number:g,startDate:v,endDate:V,fileList:c}}).filter(s=>s.name||s.number||s.startDate||s.endDate||Array.isArray(s.fileList)&&s.fileList.length);a.licenses=d;const m=(Array.isArray(e.trainings)?e.trainings:[]).map(s=>{const c=ll((s==null?void 0:s.fileList)??[]),b=Z((s==null?void 0:s.category)??(s==null?void 0:s.categories)),g=typeof(s==null?void 0:s.course)=="string"?s.course.trim():(s==null?void 0:s.course)??"",v=typeof(s==null?void 0:s.courseNo)=="string"?s.courseNo.trim():(s==null?void 0:s.courseNo)??"",V=(s==null?void 0:s.date)||"",I=P(s==null?void 0:s.score),w={course:g,courseNo:v,date:V,category:b,fileList:c};return I!==null&&(w.score=I),w}).filter(s=>s.course||s.courseNo||s.date||Array.isArray(s.category)&&s.category.length||Array.isArray(s.fileList)&&s.fileList.length||s.score!==void 0);a.trainings=m;let f;Re===null?f=await re("/api/employees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}):f=await re(`/api/employees/${el}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),f&&f.ok?(await rl(),Se.value=!1,N.success("儲存成功")):N.error("儲存失敗")}async function _t(l){const e=le.value[l];(await re(`/api/employees/${e._id}`,{method:"DELETE"})).ok&&le.value.splice(l,1)}function Vt(){n.value.experiences.push({unit:"",title:"",start:"",end:""})}function wt(l){n.value.experiences.splice(l,1)}function At(){n.value.licenses.push({name:"",number:"",startDate:"",endDate:"",fileList:[]})}function St(l){n.value.licenses.splice(l,1)}function Lt(){n.value.trainings.push({course:"",courseNo:"",date:"",fileList:[],category:[],score:null})}function kt(l){n.value.trainings.splice(l,1)}const Dt=F(()=>le.value.filter(l=>l.employmentStatus==="正職員工"||l.employmentStatus==="試用期員工").length);function Et(l){return{admin:"danger",supervisor:"warning",employee:"success"}[l]||"info"}function It(l){return{admin:"管理員",supervisor:"主管",employee:"員工"}[l]||l}function Ut(l){return{admin:"",supervisor:"",employee:""}[l]||""}function Ct(l){return{正職員工:"success",試用期員工:"warning",離職員工:"danger",留職停薪:"info"}[l]||"default"}return(l,e)=>{const a=R("el-button"),o=R("el-avatar"),d=R("el-table-column"),m=R("el-tag"),f=R("el-table"),p=R("el-input"),s=R("el-form-item"),c=R("el-radio"),b=R("el-radio-group"),g=R("el-option"),v=R("el-select"),V=R("el-tab-pane"),I=R("el-upload"),w=R("el-date-picker"),U=R("el-input-number"),O=R("el-switch"),j=R("el-tabs"),Gl=R("el-form"),dl=R("el-dialog"),cl=R("el-alert");return y(),T(V,{label:"員工管理",name:"employeeMgmt"},{default:u(()=>[i("div",Pt,[i("div",Bt,[e[84]||(e[84]=i("div",{class:"header-content"},[i("h1",{class:"page-title"},"員工管理系統"),i("p",{class:"page-description"},"管理員工資料、權限設定、部門分配和薪資配置")],-1)),i("div",Mt,[i("div",jt,[i("div",xt,k(le.value.length),1),e[82]||(e[82]=i("div",{class:"stat-label"},"總員工數",-1))]),i("div",Ft,[i("div",$t,k(Dt.value),1),e[83]||(e[83]=i("div",{class:"stat-label"},"在職員工",-1))])])]),i("div",Yt,[e[87]||(e[87]=i("h2",{class:"section-title"},"員工列表",-1)),i("div",qt,[r(a,{type:"primary",onClick:e[0]||(e[0]=t=>Yl()),class:"add-btn"},{default:u(()=>e[85]||(e[85]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增員工 ")])),_:1}),r(a,{type:"success",plain:"",class:"import-btn","data-test":"bulk-import-button",onClick:st},{default:u(()=>e[86]||(e[86]=[i("i",{class:"el-icon-upload2"},null,-1),D(" 批量匯入 ")])),_:1})])]),i("div",Kt,[r(f,{data:le.value,class:"employee-table","header-cell-style":{background:"#f8fafc",color:"#475569",fontWeight:"600"},"row-style":{height:"64px"}},{default:u(()=>[r(d,{prop:"name",label:"員工資訊","min-width":"200"},{default:u(({row:t})=>[i("div",Gt,[r(o,{size:40,class:"employee-avatar"},{default:u(()=>[D(k(t.name?t.name.charAt(0):"N"),1)]),_:2},1024),i("div",Xt,[i("div",Ht,k(t.name||"未設定"),1),i("div",Wt,k(t.employeeNo||"無編號"),1)])])]),_:1}),r(d,{label:"部門",width:"180"},{default:u(({row:t})=>[i("div",Jt,[e[88]||(e[88]=i("i",{class:"el-icon-s-grid dept-icon"},null,-1)),i("span",null,k($a(t.department)),1)])]),_:1}),r(d,{prop:"title",label:"職稱",width:"150"},{default:u(({row:t})=>[t.title?(y(),T(m,{key:0,type:"info",class:"title-tag"},{default:u(()=>[D(k(ia(Ce.value,t.title)),1)]),_:2},1024)):(y(),_("span",Qt,"未設定"))]),_:1}),r(d,{prop:"role",label:"系統權限",width:"120"},{default:u(({row:t})=>[r(m,{type:Et(t.role),class:"role-tag"},{default:u(()=>[D(k(It(t.role)),1)]),_:2},1032,["type"])]),_:1}),r(d,{prop:"employmentStatus",label:"在職狀態",width:"130"},{default:u(({row:t})=>[r(m,{type:Ct(t.employmentStatus),class:"status-tag"},{default:u(()=>[D(k(t.employmentStatus||"未設定"),1)]),_:2},1032,["type"])]),_:1}),r(d,{label:"聯絡方式",width:"200"},{default:u(({row:t})=>[i("div",Zt,[t.email?(y(),_("div",er,[e[89]||(e[89]=i("i",{class:"el-icon-message"},null,-1)),i("span",null,k(t.email),1)])):G("",!0),t.phone?(y(),_("div",lr,[e[90]||(e[90]=i("i",{class:"el-icon-phone"},null,-1)),i("span",null,k(t.phone),1)])):G("",!0),!t.email&&!t.phone?(y(),_("div",ar," 無聯絡資訊 ")):G("",!0)])]),_:1}),r(d,{label:"操作",width:"200",fixed:"right"},{default:u(({row:t,$index:A})=>[i("div",tr,[r(a,{type:"primary",size:"small",onClick:h=>Yl(A),class:"edit-btn"},{default:u(()=>e[91]||(e[91]=[i("i",{class:"el-icon-edit"},null,-1),D(" 編輯 ")])),_:2},1032,["onClick"]),r(a,{type:"danger",size:"small",onClick:h=>_t(A),class:"delete-btn"},{default:u(()=>e[92]||(e[92]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),r(dl,{modelValue:Se.value,"onUpdate:modelValue":e[75]||(e[75]=t=>Se.value=t),title:"員工資料管理",width:"1200px",class:"employee-dialog","close-on-click-modal":!1},{footer:u(()=>[i("div",Fo,[r(a,{onClick:e[74]||(e[74]=t=>Se.value=!1),class:"cancel-btn"},{default:u(()=>e[131]||(e[131]=[D("取消")])),_:1}),r(a,{type:"primary",onClick:ht,class:"save-btn"},{default:u(()=>e[132]||(e[132]=[i("i",{class:"el-icon-check"},null,-1),D(" 儲存員工資料 ")])),_:1})])]),default:u(()=>[r(Gl,{ref_key:"formRef",ref:jl,model:n.value,rules:at,"label-width":"140px",class:"employee-form"},{default:u(()=>[r(j,{modelValue:Qe.value,"onUpdate:modelValue":e[73]||(e[73]=t=>Qe.value=t),type:"border-card",class:"employee-tabs"},{default:u(()=>[r(V,{name:"account"},{label:u(()=>e[93]||(e[93]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-user"}),i("span",null,"帳號權限")],-1)])),default:u(()=>[i("div",rr,[i("div",or,[i("div",nr,[e[94]||(e[94]=i("h3",{class:"form-group-title"},"登入資訊",-1)),r(s,{label:"登入帳號",required:"",prop:"username"},{default:u(()=>[r(p,{modelValue:n.value.username,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.username=t),placeholder:"請輸入登入帳號"},null,8,["modelValue"])]),_:1}),r(s,{label:"登入密碼",required:"",prop:"password"},{default:u(()=>[r(p,{modelValue:n.value.password,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.password=t),type:"password",placeholder:"請輸入密碼","show-password":""},null,8,["modelValue"])]),_:1})]),i("div",sr,[e[95]||(e[95]=i("h3",{class:"form-group-title"},"權限設定",-1)),r(s,{label:"系統權限",required:"",prop:"role"},{default:u(()=>[r(b,{modelValue:n.value.role,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.role=t),class:"role-radio-group"},{default:u(()=>[(y(),_(S,null,L(Ie,t=>r(c,{key:t.value,label:t.value,class:"role-radio"},{default:u(()=>[i("div",ir,[i("div",ur,k(t.label),1),i("div",dr,k(Ut(t.value)),1)])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"權限職等"},{default:u(()=>[r(v,{modelValue:n.value.permissionGrade,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.permissionGrade=t),placeholder:"選擇職等",class:"code-select"},{default:u(()=>[(y(),_(S,null,L(hl,t=>r(g,{key:t.level,label:xa(t),value:t.level},{default:u(()=>[i("div",cr,[i("div",mr,k(t.level)+"｜"+k(t.description),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}),r(V,{name:"approval"},{label:u(()=>e[96]||(e[96]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-document-checked"}),i("span",null,"簽核設定")],-1)])),default:u(()=>[i("div",pr,[i("div",fr,[i("div",vr,[e[97]||(e[97]=i("h3",{class:"form-group-title"},"簽核權限",-1)),r(s,{label:"簽核角色"},{default:u(()=>[r(b,{modelValue:n.value.signRole,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.signRole=t),class:"sign-role-group"},{default:u(()=>[(y(),_(S,null,L(Te,t=>r(c,{key:t.id,label:t.id,class:"sign-role-radio"},{default:u(()=>[i("div",gr,[i("div",yr,k(t.id)+"｜"+k(t.label),1),i("div",br,k(t.description),1)])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"簽核層級"},{default:u(()=>[r(v,{modelValue:n.value.signLevel,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.signLevel=t),placeholder:"選擇層級",class:"code-select"},{default:u(()=>[(y(),_(S,null,L(Je,t=>r(g,{key:t.id,label:Fa(t),value:t.id},{default:u(()=>[i("div",hr,[i("div",_r,k(t.id)+"｜"+k(t.label),1),i("div",Vr,k(t.description),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"員工標籤"},{default:u(()=>[r(v,{modelValue:n.value.signTags,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.signTags=t),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"選擇或新增標籤",class:"tag-select"},{default:u(()=>[(y(),_(S,null,L(Ra,t=>r(g,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}),r(V,{name:"personal"},{label:u(()=>e[98]||(e[98]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-user-solid"}),i("span",null,"個人資訊")],-1)])),default:u(()=>[i("div",wr,[i("div",Ar,[i("div",Sr,[e[100]||(e[100]=i("h3",{class:"form-group-title"},"基本資料",-1)),r(s,{label:"個人照片",class:"photo-upload-item"},{default:u(()=>[r(I,{class:"employee-photo-upload","file-list":n.value.photoList,"onUpdate:fileList":e[8]||(e[8]=t=>n.value.photoList=t),"http-request":qa,"on-success":Ka,"on-remove":Ga,"on-exceed":Xa,"list-type":"picture-card",limit:1,accept:"image/*",disabled:Ze.value},{default:u(()=>e[99]||(e[99]=[i("div",{class:"upload-placeholder"},[i("i",{class:"el-icon-plus"}),i("span",null,"上傳照片")],-1)])),_:1},8,["file-list","disabled"])]),_:1}),i("div",Lr,[r(s,{label:"員工編號"},{default:u(()=>[r(p,{modelValue:n.value.employeeNo,"onUpdate:modelValue":e[9]||(e[9]=t=>n.value.employeeNo=t),placeholder:"請輸入員工編號"},null,8,["modelValue"])]),_:1}),r(s,{label:"員工姓名",required:"",prop:"name"},{default:u(()=>[r(p,{modelValue:n.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>n.value.name=t),placeholder:"請輸入員工姓名"},null,8,["modelValue"])]),_:1})]),i("div",kr,[r(s,{label:"性別",required:"",prop:"gender"},{default:u(()=>[r(v,{modelValue:n.value.gender,"onUpdate:modelValue":e[11]||(e[11]=t=>n.value.gender=t),placeholder:"選擇性別"},{default:u(()=>[r(g,{label:"男",value:"M"}),r(g,{label:"女",value:"F"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"生日"},{default:u(()=>[r(w,{modelValue:n.value.birthday,"onUpdate:modelValue":e[12]||(e[12]=t=>n.value.birthday=t),type:"date",placeholder:"選擇生日"},null,8,["modelValue"])]),_:1})]),i("div",Dr,[r(s,{label:"身分證號"},{default:u(()=>[r(p,{modelValue:n.value.idNumber,"onUpdate:modelValue":e[13]||(e[13]=t=>n.value.idNumber=t),placeholder:"請輸入身分證號"},null,8,["modelValue"])]),_:1}),r(s,{label:"出生地"},{default:u(()=>[r(p,{modelValue:n.value.birthplace,"onUpdate:modelValue":e[14]||(e[14]=t=>n.value.birthplace=t),placeholder:"請輸入出生地"},null,8,["modelValue"])]),_:1})]),i("div",Er,[r(s,{label:"血型"},{default:u(()=>[r(v,{modelValue:n.value.bloodType,"onUpdate:modelValue":e[15]||(e[15]=t=>n.value.bloodType=t),placeholder:"選擇血型"},{default:u(()=>[(y(),_(S,null,L(Ll,t=>r(g,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"婚姻狀態"},{default:u(()=>[r(v,{modelValue:n.value.maritalStatus,"onUpdate:modelValue":e[16]||(e[16]=t=>n.value.maritalStatus=t),placeholder:"選擇婚姻狀態"},{default:u(()=>[r(g,{label:"未婚",value:"未婚"}),r(g,{label:"已婚",value:"已婚"}),r(g,{label:"離婚",value:"離婚"}),r(g,{label:"喪偶",value:"喪偶"})]),_:1},8,["modelValue"])]),_:1})]),r(s,{label:"語言能力"},{default:u(()=>[r(v,{modelValue:n.value.languages,"onUpdate:modelValue":e[17]||(e[17]=t=>n.value.languages=t),multiple:"",filterable:"",placeholder:"選擇語言",disabled:!Fe.value.length},{default:u(()=>[(y(!0),_(S,null,L(Fe.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),i("div",Ir,[r(s,{label:"身心障礙等級"},{default:u(()=>[r(v,{modelValue:n.value.disabilityLevel,"onUpdate:modelValue":e[18]||(e[18]=t=>n.value.disabilityLevel=t),placeholder:"選擇等級",clearable:"",disabled:!$e.value.length},{default:u(()=>[(y(!0),_(S,null,L($e.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),r(s,{label:"身分註記"},{default:u(()=>[r(v,{modelValue:n.value.identityCategory,"onUpdate:modelValue":e[19]||(e[19]=t=>n.value.identityCategory=t),multiple:"",filterable:"","collapse-tags":"",placeholder:"選擇身份別",disabled:!Ye.value.length},{default:u(()=>[(y(!0),_(S,null,L(Ye.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),r(s,{label:"扶養人數"},{default:u(()=>[r(U,{modelValue:n.value.dependents,"onUpdate:modelValue":e[20]||(e[20]=t=>n.value.dependents=t),min:0},null,8,["modelValue"])]),_:1})]),i("div",Ur,[e[101]||(e[101]=i("h3",{class:"form-group-title"},"聯絡資訊",-1)),i("div",Cr,[r(s,{label:"Email",required:"",prop:"email"},{default:u(()=>[r(p,{modelValue:n.value.email,"onUpdate:modelValue":e[21]||(e[21]=t=>n.value.email=t),placeholder:"請輸入Email"},null,8,["modelValue"])]),_:1}),r(s,{label:"行動電話"},{default:u(()=>[r(p,{modelValue:n.value.phone,"onUpdate:modelValue":e[22]||(e[22]=t=>n.value.phone=t),placeholder:"請輸入行動電話"},null,8,["modelValue"])]),_:1})]),i("div",Tr,[r(s,{label:"市內電話"},{default:u(()=>[r(p,{modelValue:n.value.landline,"onUpdate:modelValue":e[23]||(e[23]=t=>n.value.landline=t),placeholder:"請輸入市內電話"},null,8,["modelValue"])]),_:1}),r(s,{label:"LINE ID"},{default:u(()=>[r(p,{modelValue:n.value.lineId,"onUpdate:modelValue":e[24]||(e[24]=t=>n.value.lineId=t),placeholder:"請輸入LINE ID"},null,8,["modelValue"])]),_:1})]),r(s,{label:"戶籍地址"},{default:u(()=>[r(p,{modelValue:n.value.householdAddress,"onUpdate:modelValue":e[25]||(e[25]=t=>n.value.householdAddress=t),placeholder:"請輸入戶籍地址"},null,8,["modelValue"])]),_:1}),r(s,{label:"聯絡地址"},{default:u(()=>[r(p,{modelValue:n.value.contactAddress,"onUpdate:modelValue":e[26]||(e[26]=t=>n.value.contactAddress=t),placeholder:"請輸入聯絡地址"},null,8,["modelValue"])]),_:1})])])])]),_:1}),r(V,{name:"employment"},{label:u(()=>e[102]||(e[102]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-office-building"}),i("span",null,"任職資訊")],-1)])),default:u(()=>[i("div",Rr,[i("div",Or,[i("div",Nr,[e[103]||(e[103]=i("h3",{class:"form-group-title"},"組織架構",-1)),i("div",zr,[r(s,{label:"所屬機構",required:"",prop:"organization"},{default:u(()=>[r(v,{modelValue:n.value.organization,"onUpdate:modelValue":e[27]||(e[27]=t=>n.value.organization=t),placeholder:"選擇機構"},{default:u(()=>[(y(!0),_(S,null,L(me.value,t=>(y(),T(g,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"所屬部門",required:"",prop:"department"},{default:u(()=>[r(v,{modelValue:n.value.department,"onUpdate:modelValue":e[28]||(e[28]=t=>n.value.department=t),placeholder:"選擇部門"},{default:u(()=>[(y(!0),_(S,null,L(tt.value,t=>(y(),T(g,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",Pr,[r(s,{label:"小單位"},{default:u(()=>[r(v,{modelValue:n.value.subDepartment,"onUpdate:modelValue":e[29]||(e[29]=t=>n.value.subDepartment=t),placeholder:"選擇小單位"},{default:u(()=>[(y(!0),_(S,null,L(rt.value,t=>(y(),T(g,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"直屬主管"},{default:u(()=>[r(v,{modelValue:n.value.supervisor,"onUpdate:modelValue":e[30]||(e[30]=t=>n.value.supervisor=t),placeholder:"選擇主管"},{default:u(()=>[(y(!0),_(S,null,L(ot.value,t=>(y(),T(g,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),i("div",Br,[e[104]||(e[104]=i("h3",{class:"form-group-title"},"職務資訊",-1)),i("div",Mr,[r(s,{label:"職稱"},{default:u(()=>[r(v,{modelValue:n.value.title,"onUpdate:modelValue":e[31]||(e[31]=t=>n.value.title=t),placeholder:"選擇職稱",disabled:!Ce.value.length},{default:u(()=>[(y(!0),_(S,null,L(Ce.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),r(s,{label:"執業職稱"},{default:u(()=>[r(v,{modelValue:n.value.practiceTitle,"onUpdate:modelValue":e[32]||(e[32]=t=>n.value.practiceTitle=t),placeholder:"選擇執業職稱",disabled:!xe.value.length},{default:u(()=>[(y(!0),_(S,null,L(xe.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",jr,[r(s,{label:"兼職人員"},{default:u(()=>[r(O,{modelValue:n.value.isPartTime,"onUpdate:modelValue":e[33]||(e[33]=t=>n.value.isPartTime=t),"active-text":"是","inactive-text":"否","active-color":"#10b981"},null,8,["modelValue"])]),_:1}),r(s,{label:"需要打卡"},{default:u(()=>[r(O,{modelValue:n.value.isClocking,"onUpdate:modelValue":e[34]||(e[34]=t=>n.value.isClocking=t),"active-text":"是","inactive-text":"否","active-color":"#10b981"},null,8,["modelValue"])]),_:1})])]),i("div",xr,[e[105]||(e[105]=i("h3",{class:"form-group-title"},"聘用狀態",-1)),i("div",Fr,[r(s,{label:"在職狀態"},{default:u(()=>[r(v,{modelValue:n.value.employmentStatus,"onUpdate:modelValue":e[35]||(e[35]=t=>n.value.employmentStatus=t),placeholder:"選擇狀態"},{default:u(()=>[r(g,{label:"正職員工",value:"正職員工"}),r(g,{label:"試用期員工",value:"試用期員工"}),r(g,{label:"離職員工",value:"離職員工"}),r(g,{label:"留職停薪",value:"留職停薪"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"試用期"},{default:u(()=>[r(v,{modelValue:n.value.probationDays,"onUpdate:modelValue":e[36]||(e[36]=t=>n.value.probationDays=t),placeholder:"選擇天數"},{default:u(()=>[r(g,{label:"無",value:""}),r(g,{label:"30天",value:"30"}),r(g,{label:"60天",value:"60"}),r(g,{label:"90天",value:"90"})]),_:1},8,["modelValue"])]),_:1})]),i("div",$r,[r(s,{label:"到職日期"},{default:u(()=>[r(w,{modelValue:n.value.hireDate,"onUpdate:modelValue":e[37]||(e[37]=t=>n.value.hireDate=t),type:"date",placeholder:"選擇到職日期"},null,8,["modelValue"])]),_:1}),r(s,{label:"起聘日期"},{default:u(()=>[r(w,{modelValue:n.value.appointDate,"onUpdate:modelValue":e[38]||(e[38]=t=>n.value.appointDate=t),type:"date",placeholder:"選擇起聘日期"},null,8,["modelValue"])]),_:1})]),i("div",Yr,[r(s,{label:"離職日期"},{default:u(()=>[r(w,{modelValue:n.value.resignDate,"onUpdate:modelValue":e[39]||(e[39]=t=>n.value.resignDate=t),type:"date",placeholder:"選擇離職日期"},null,8,["modelValue"])]),_:1}),r(s,{label:"解聘日期"},{default:u(()=>[r(w,{modelValue:n.value.dismissDate,"onUpdate:modelValue":e[40]||(e[40]=t=>n.value.dismissDate=t),type:"date",placeholder:"選擇解聘日期"},null,8,["modelValue"])]),_:1})]),i("div",qr,[r(s,{label:"再任起聘"},{default:u(()=>[r(w,{modelValue:n.value.reAppointDate,"onUpdate:modelValue":e[41]||(e[41]=t=>n.value.reAppointDate=t),type:"date",placeholder:"選擇再任起聘日期"},null,8,["modelValue"])]),_:1}),r(s,{label:"再任解聘"},{default:u(()=>[r(w,{modelValue:n.value.reDismissDate,"onUpdate:modelValue":e[42]||(e[42]=t=>n.value.reDismissDate=t),type:"date",placeholder:"選擇再任解聘日期"},null,8,["modelValue"])]),_:1})]),i("div",Kr,[r(s,{label:"聘任備註",class:"full-width-item"},{default:u(()=>[r(p,{modelValue:n.value.employmentNote,"onUpdate:modelValue":e[43]||(e[43]=t=>n.value.employmentNote=t),type:"textarea",rows:2,placeholder:"請輸入聘任備註"},null,8,["modelValue"])]),_:1})])])])])]),_:1}),r(V,{name:"more"},{label:u(()=>e[106]||(e[106]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-more"}),i("span",null,"更多資訊")],-1)])),default:u(()=>[i("div",Gr,[i("div",Xr,[i("div",Hr,[e[107]||(e[107]=i("h3",{class:"form-group-title"},"身體檢查",-1)),i("div",Wr,[r(s,{label:"身高 (cm)"},{default:u(()=>[r(U,{modelValue:n.value.height,"onUpdate:modelValue":e[44]||(e[44]=t=>n.value.height=t),min:0,max:250,step:.1,precision:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入身高"},null,8,["modelValue"])]),_:1}),r(s,{label:"體重 (kg)"},{default:u(()=>[r(U,{modelValue:n.value.weight,"onUpdate:modelValue":e[45]||(e[45]=t=>n.value.weight=t),min:0,max:300,step:.1,precision:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入體重"},null,8,["modelValue"])]),_:1})]),i("div",Jr,[r(s,{label:"體檢血型"},{default:u(()=>[r(v,{modelValue:n.value.medicalBloodType,"onUpdate:modelValue":e[46]||(e[46]=t=>n.value.medicalBloodType=t),placeholder:"選擇血型",clearable:""},{default:u(()=>[(y(),_(S,null,L(Ll,t=>r(g,{key:`medical-${t}`,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])]),i("div",Qr,[e[108]||(e[108]=i("h3",{class:"form-group-title"},"學歷資訊",-1)),i("div",Zr,[r(s,{label:"教育程度"},{default:u(()=>[r(v,{modelValue:n.value.educationLevel,"onUpdate:modelValue":e[47]||(e[47]=t=>n.value.educationLevel=t),placeholder:"選擇教育程度",disabled:!qe.value.length},{default:u(()=>[(y(!0),_(S,null,L(qe.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),r(s,{label:"學校名稱"},{default:u(()=>[r(p,{modelValue:n.value.schoolName,"onUpdate:modelValue":e[48]||(e[48]=t=>n.value.schoolName=t),placeholder:"請輸入學校名稱"},null,8,["modelValue"])]),_:1})]),i("div",eo,[r(s,{label:"主修科系"},{default:u(()=>[r(p,{modelValue:n.value.major,"onUpdate:modelValue":e[49]||(e[49]=t=>n.value.major=t),placeholder:"請輸入主修科系"},null,8,["modelValue"])]),_:1}),r(s,{label:"畢業狀態"},{default:u(()=>[r(v,{modelValue:n.value.graduationStatus,"onUpdate:modelValue":e[50]||(e[50]=t=>n.value.graduationStatus=t),placeholder:"選擇畢業狀態",clearable:"",onClear:nt,disabled:!Ke.value.length},{default:u(()=>[(y(!0),_(S,null,L(Ke.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",lo,[r(s,{label:"畢業年度",class:"full-width-item"},{default:u(()=>[r(p,{modelValue:n.value.graduationYear,"onUpdate:modelValue":e[51]||(e[51]=t=>n.value.graduationYear=t),placeholder:"請輸入畢業年度"},null,8,["modelValue"])]),_:1})])]),i("div",ao,[e[109]||(e[109]=i("h3",{class:"form-group-title"},"役別資訊",-1)),i("div",to,[r(s,{label:"役別類型"},{default:u(()=>[r(v,{modelValue:n.value.serviceType,"onUpdate:modelValue":e[52]||(e[52]=t=>n.value.serviceType=t),placeholder:"選擇或輸入役別類型",filterable:"","allow-create":"","default-first-option":"",clearable:""},{default:u(()=>[(y(),_(S,null,L(Oa,t=>r(g,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"軍種"},{default:u(()=>[r(p,{modelValue:n.value.militaryBranch,"onUpdate:modelValue":e[53]||(e[53]=t=>n.value.militaryBranch=t),placeholder:"請輸入軍種"},null,8,["modelValue"])]),_:1})]),i("div",ro,[r(s,{label:"軍階"},{default:u(()=>[r(p,{modelValue:n.value.militaryRank,"onUpdate:modelValue":e[54]||(e[54]=t=>n.value.militaryRank=t),placeholder:"請輸入軍階"},null,8,["modelValue"])]),_:1}),r(s,{label:"退伍年"},{default:u(()=>[r(U,{modelValue:n.value.dischargeYear,"onUpdate:modelValue":e[55]||(e[55]=t=>n.value.dischargeYear=t),min:1900,max:Ot(Na)+10,step:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入退伍年"},null,8,["modelValue","max"])]),_:1})])]),i("div",oo,[e[112]||(e[112]=i("h3",{class:"form-group-title"},"緊急聯絡人",-1)),i("div",no,[e[110]||(e[110]=i("h4",{class:"contact-subtitle"},"聯絡人一",-1)),i("div",so,[r(s,{label:"姓名"},{default:u(()=>[r(p,{modelValue:n.value.emergency1.name,"onUpdate:modelValue":e[56]||(e[56]=t=>n.value.emergency1.name=t),placeholder:"請輸入姓名"},null,8,["modelValue"])]),_:1}),r(s,{label:"關係"},{default:u(()=>[r(v,{modelValue:n.value.emergency1.relation,"onUpdate:modelValue":e[57]||(e[57]=t=>n.value.emergency1.relation=t),placeholder:"選擇關係"},{default:u(()=>[(y(!0),_(S,null,L(Ge.value,t=>(y(),T(g,{key:`r1-${t.value}`,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",io,[r(s,{label:"電話一"},{default:u(()=>[r(p,{modelValue:n.value.emergency1.phone1,"onUpdate:modelValue":e[58]||(e[58]=t=>n.value.emergency1.phone1=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1}),r(s,{label:"電話二"},{default:u(()=>[r(p,{modelValue:n.value.emergency1.phone2,"onUpdate:modelValue":e[59]||(e[59]=t=>n.value.emergency1.phone2=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1})])]),i("div",uo,[e[111]||(e[111]=i("h4",{class:"contact-subtitle"},"聯絡人二",-1)),i("div",co,[r(s,{label:"姓名"},{default:u(()=>[r(p,{modelValue:n.value.emergency2.name,"onUpdate:modelValue":e[60]||(e[60]=t=>n.value.emergency2.name=t),placeholder:"請輸入姓名"},null,8,["modelValue"])]),_:1}),r(s,{label:"關係"},{default:u(()=>[r(v,{modelValue:n.value.emergency2.relation,"onUpdate:modelValue":e[61]||(e[61]=t=>n.value.emergency2.relation=t),placeholder:"選擇關係"},{default:u(()=>[(y(!0),_(S,null,L(Ge.value,t=>(y(),T(g,{key:`r2-${t.value}`,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",mo,[r(s,{label:"電話一"},{default:u(()=>[r(p,{modelValue:n.value.emergency2.phone1,"onUpdate:modelValue":e[62]||(e[62]=t=>n.value.emergency2.phone1=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1}),r(s,{label:"電話二"},{default:u(()=>[r(p,{modelValue:n.value.emergency2.phone2,"onUpdate:modelValue":e[63]||(e[63]=t=>n.value.emergency2.phone2=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1})])])]),i("div",po,[e[115]||(e[115]=i("h3",{class:"form-group-title"},"工作經歷",-1)),i("div",fo,[(y(!0),_(S,null,L(n.value.experiences,(t,A)=>(y(),_("div",{key:A,class:"experience-item"},[i("div",vo,[i("h4",go,"經歷 "+k(A+1),1),r(a,{type:"danger",size:"small",onClick:h=>wt(A),class:"remove-btn"},{default:u(()=>e[113]||(e[113]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",yo,[r(s,{label:"單位名稱"},{default:u(()=>[r(p,{modelValue:t.unit,"onUpdate:modelValue":h=>t.unit=h,placeholder:"請輸入單位名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"職稱"},{default:u(()=>[r(p,{modelValue:t.title,"onUpdate:modelValue":h=>t.title=h,placeholder:"請輸入職稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",bo,[r(s,{label:"到職年月"},{default:u(()=>[r(w,{modelValue:t.start,"onUpdate:modelValue":h=>t.start=h,type:"month",placeholder:"選擇到職年月"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"離職年月"},{default:u(()=>[r(w,{modelValue:t.end,"onUpdate:modelValue":h=>t.end=h,type:"month",placeholder:"選擇離職年月"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128))]),r(a,{type:"primary",onClick:Vt,class:"add-item-btn"},{default:u(()=>e[114]||(e[114]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增經歷 ")])),_:1})]),i("div",ho,[e[120]||(e[120]=i("h3",{class:"form-group-title"},"證照",-1)),i("div",_o,[(y(!0),_(S,null,L(n.value.licenses,(t,A)=>(y(),_("div",{key:`license-${A}`,class:"experience-item"},[i("div",Vo,[i("h4",wo,"證照 "+k(A+1),1),r(a,{type:"danger",size:"small",onClick:h=>St(A),class:"remove-btn"},{default:u(()=>e[116]||(e[116]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",Ao,[r(s,{label:"證照名稱"},{default:u(()=>[r(p,{modelValue:t.name,"onUpdate:modelValue":h=>t.name=h,placeholder:"請輸入證照名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"證照字號"},{default:u(()=>[r(p,{modelValue:t.number,"onUpdate:modelValue":h=>t.number=h,placeholder:"請輸入證照字號"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",So,[r(s,{label:"核發日期"},{default:u(()=>[r(w,{modelValue:t.startDate,"onUpdate:modelValue":h=>t.startDate=h,type:"date",placeholder:"選擇核發日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"有效期限"},{default:u(()=>[r(w,{modelValue:t.endDate,"onUpdate:modelValue":h=>t.endDate=h,type:"date",placeholder:"選擇有效期限"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Lo,[r(s,{label:"證照檔案",class:"full-width-item"},{default:u(()=>[r(I,{"file-list":t.fileList,"onUpdate:fileList":h=>t.fileList=h,action:"#",multiple:"","list-type":"text","http-request":zl,"on-success":(h,ie,ml)=>Pl("licenses",A,h,ie,ml),"on-remove":(h,ie)=>Bl("licenses",A,h,ie)},{tip:u(()=>e[118]||(e[118]=[i("div",{class:"upload-tip"},"可上傳多個檔案，將以連結形式儲存",-1)])),default:u(()=>[r(a,{type:"primary",plain:""},{default:u(()=>e[117]||(e[117]=[i("i",{class:"el-icon-upload2"},null,-1),D(" 上傳檔案 ")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","on-success","on-remove"])]),_:2},1024)])]))),128))]),r(a,{type:"primary",onClick:At,class:"add-item-btn"},{default:u(()=>e[119]||(e[119]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增證照 ")])),_:1})]),i("div",ko,[e[125]||(e[125]=i("h3",{class:"form-group-title"},"教育訓練",-1)),i("div",Do,[(y(!0),_(S,null,L(n.value.trainings,(t,A)=>(y(),_("div",{key:`training-${A}`,class:"experience-item"},[i("div",Eo,[i("h4",Io,"教育訓練 "+k(A+1),1),r(a,{type:"danger",size:"small",onClick:h=>kt(A),class:"remove-btn"},{default:u(()=>e[121]||(e[121]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",Uo,[r(s,{label:"課程名稱"},{default:u(()=>[r(p,{modelValue:t.course,"onUpdate:modelValue":h=>t.course=h,placeholder:"請輸入課程名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"課程代碼"},{default:u(()=>[r(p,{modelValue:t.courseNo,"onUpdate:modelValue":h=>t.courseNo=h,placeholder:"請輸入課程代碼"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Co,[r(s,{label:"上課日期"},{default:u(()=>[r(w,{modelValue:t.date,"onUpdate:modelValue":h=>t.date=h,type:"date",placeholder:"選擇日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"積分類別",class:"full-width-item"},{default:u(()=>[r(v,{modelValue:t.category,"onUpdate:modelValue":h=>t.category=h,multiple:"","collapse-tags":"",placeholder:"選擇積分類別"},{default:u(()=>[(y(!0),_(S,null,L(_l.value,h=>(y(),T(g,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",To,[r(s,{label:"積分"},{default:u(()=>[r(U,{modelValue:t.score,"onUpdate:modelValue":h=>t.score=h,min:0,step:.5,"value-on-clear":null},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(s,{label:"訓練檔案",class:"full-width-item"},{default:u(()=>[r(I,{"file-list":t.fileList,"onUpdate:fileList":h=>t.fileList=h,action:"#",multiple:"","list-type":"text","http-request":zl,"on-success":(h,ie,ml)=>Pl("trainings",A,h,ie,ml),"on-remove":(h,ie)=>Bl("trainings",A,h,ie)},{tip:u(()=>e[123]||(e[123]=[i("div",{class:"upload-tip"},"支援多檔上傳，將以連結形式儲存",-1)])),default:u(()=>[r(a,{type:"primary",plain:""},{default:u(()=>e[122]||(e[122]=[i("i",{class:"el-icon-upload2"},null,-1),D(" 上傳檔案 ")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","on-success","on-remove"])]),_:2},1024)])]))),128))]),r(a,{type:"primary",onClick:Lt,class:"add-item-btn"},{default:u(()=>e[124]||(e[124]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增教育訓練 ")])),_:1})])])])]),_:1}),r(V,{name:"salary"},{label:u(()=>e[126]||(e[126]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-money"}),i("span",null,"薪資設定")],-1)])),default:u(()=>[i("div",Ro,[i("div",Oo,[i("div",No,[e[127]||(e[127]=i("h3",{class:"form-group-title"},"薪資資訊",-1)),i("div",zo,[r(s,{label:"薪資類別"},{default:u(()=>[r(v,{modelValue:n.value.salaryType,"onUpdate:modelValue":e[64]||(e[64]=t=>n.value.salaryType=t),placeholder:"選擇類別"},{default:u(()=>[(y(),_(S,null,L(Ta,t=>r(g,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"薪資金額"},{default:u(()=>[r(U,{modelValue:n.value.salaryAmount,"onUpdate:modelValue":e[65]||(e[65]=t=>n.value.salaryAmount=t),min:0,step:1e3,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),r(s,{label:"勞退自提",prop:"laborPensionSelf"},{default:u(()=>[r(U,{modelValue:n.value.laborPensionSelf,"onUpdate:modelValue":e[66]||(e[66]=t=>n.value.laborPensionSelf=t),min:0,step:100,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),r(s,{label:"員工預支",prop:"employeeAdvance"},{default:u(()=>[r(U,{modelValue:n.value.employeeAdvance,"onUpdate:modelValue":e[67]||(e[67]=t=>n.value.employeeAdvance=t),min:0,step:100,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),r(s,{class:"full-width-item",label:"薪資項目",prop:"salaryItems"},{default:u(()=>[r(v,{modelValue:n.value.salaryItems,"onUpdate:modelValue":e[68]||(e[68]=t=>n.value.salaryItems=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"選擇薪資項目"},{default:u(()=>[(y(!0),_(S,null,L(be.value,t=>(y(),T(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),i("div",Po,[e[130]||(e[130]=i("h3",{class:"form-group-title"},"銀行帳戶",-1)),i("div",Bo,[e[128]||(e[128]=i("h4",{class:"account-subtitle"},"薪資帳戶 A",-1)),i("div",Mo,[r(s,{label:"銀行代碼/名稱"},{default:u(()=>[r(p,{modelValue:n.value.salaryAccountA.bank,"onUpdate:modelValue":e[69]||(e[69]=t=>n.value.salaryAccountA.bank=t),placeholder:"請輸入銀行資訊"},null,8,["modelValue"])]),_:1}),r(s,{label:"帳號"},{default:u(()=>[r(p,{modelValue:n.value.salaryAccountA.acct,"onUpdate:modelValue":e[70]||(e[70]=t=>n.value.salaryAccountA.acct=t),placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1})])]),i("div",jo,[e[129]||(e[129]=i("h4",{class:"account-subtitle"},"薪資帳戶 B",-1)),i("div",xo,[r(s,{label:"銀行代碼/名稱"},{default:u(()=>[r(p,{modelValue:n.value.salaryAccountB.bank,"onUpdate:modelValue":e[71]||(e[71]=t=>n.value.salaryAccountB.bank=t),placeholder:"請輸入銀行資訊"},null,8,["modelValue"])]),_:1}),r(s,{label:"帳號"},{default:u(()=>[r(p,{modelValue:n.value.salaryAccountB.acct,"onUpdate:modelValue":e[72]||(e[72]=t=>n.value.salaryAccountB.acct=t),placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1})])])])])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(dl,{modelValue:he.value,"onUpdate:modelValue":e[79]||(e[79]=t=>he.value=t),title:"批量匯入員工",width:"720px",class:"bulk-import-dialog","close-on-click-modal":!1,"before-close":ut},{footer:u(()=>[r(a,{onClick:it},{default:u(()=>e[144]||(e[144]=[D("取消")])),_:1}),r(a,{type:"primary",loading:Ve.value,disabled:!Al.value||Ve.value,onClick:ul},{default:u(()=>e[145]||(e[145]=[D(" 開始匯入 ")])),_:1},8,["loading","disabled"])]),default:u(()=>[i("div",$o,[r(cl,{type:"info","show-icon":"",closable:!1},{title:u(()=>e[133]||(e[133]=[D(" 下載範本後依欄位填寫資料，或直接使用範本內建的 5 筆示範資料測試匯入流程。 ")])),default:u(()=>[i("div",Yo,[e[135]||(e[135]=i("i",{class:"el-icon-document"},null,-1)),r(a,{type:"primary",link:"","data-test":"bulk-import-template-download",onClick:_a},{default:u(()=>e[134]||(e[134]=[D(" 下載匯入範本 ")])),_:1})])]),_:1})]),i("div",qo,[r(I,{drag:"",action:"","auto-upload":!1,accept:".xlsx,.xls,.csv","file-list":de.value,limit:1,"on-change":ra,"on-remove":oa},{default:u(()=>e[136]||(e[136]=[i("i",{class:"el-icon-upload"},null,-1),i("div",{class:"el-upload__text"},[D(" 將檔案拖曳至此或 "),i("em",null,"點此選擇")],-1),i("div",{class:"el-upload__tip"},"支援 .xlsx、.xls、.csv 檔案格式，檔案大小請勿超過 5MB",-1)])),_:1},8,["file-list"])]),i("div",Ko,[e[139]||(e[139]=i("h3",{class:"bulk-import-subtitle"},"欄位格式與必填說明",-1)),e[140]||(e[140]=i("p",{class:"bulk-import-description"}," 系統已預先套用官方批量匯入 Excel 模板，請依下列欄位填寫資料後再上傳檔案。 ",-1)),r(cl,{type:"warning","show-icon":"",class:"bulk-import-required-alert",closable:!1},{title:u(()=>[D("必填欄位："+k(ga.value.join("、")),1)]),default:u(()=>[e[137]||(e[137]=i("div",null,"若未提供必填欄位資料，匯入時將提示錯誤並中止處理。",-1))]),_:1}),(y(!0),_(S,null,L(va.value,t=>(y(),_("section",{key:t.title,class:"bulk-import-section"},[i("h4",Go,k(t.title),1),r(f,{data:t.fields,border:"",size:"small",class:"bulk-import-table"},{default:u(()=>[r(d,{prop:"header",label:"Excel 欄位 (英文)",width:"220"},{default:u(({row:A})=>[i("code",Xo,k(A.header),1)]),_:1}),r(d,{prop:"displayDescription",label:"欄位說明","min-width":"300"},{default:u(({row:A})=>[D(k(A.displayDescription||A.description||A.label||A.header),1)]),_:1}),r(d,{label:"是否必填",width:"120",align:"center"},{default:u(({row:A})=>[A.required?(y(),T(m,{key:0,type:"danger",size:"small"},{default:u(()=>e[138]||(e[138]=[D("必填")])),_:1})):(y(),_("span",Ho,"選填"))]),_:1})]),_:2},1032,["data"])]))),128)),e[141]||(e[141]=i("h3",{class:"bulk-import-subtitle bulk-import-options-title"},"匯入參數設定",-1)),r(Gl,{model:C,"label-width":"150px"},{default:u(()=>[r(s,{label:"匯入預設權限",required:""},{default:u(()=>[r(v,{modelValue:C.options.defaultRole,"onUpdate:modelValue":e[76]||(e[76]=t=>C.options.defaultRole=t),placeholder:"請選擇預設權限"},{default:u(()=>[(y(),_(S,null,L(Ie,t=>r(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"預設登入密碼"},{default:u(()=>[r(p,{modelValue:C.options.resetPassword,"onUpdate:modelValue":e[77]||(e[77]=t=>C.options.resetPassword=t),type:"password","show-password":"",placeholder:"未設定則由後端自動產生"},null,8,["modelValue"])]),_:1}),r(s,{label:"寄發通知信"},{default:u(()=>[r(O,{modelValue:C.options.sendWelcomeEmail,"onUpdate:modelValue":e[78]||(e[78]=t=>C.options.sendWelcomeEmail=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),ne.value.length||Y.value.length?(y(),_("div",Wo,[Y.value.length?(y(),T(cl,{key:0,type:"warning",closable:!1,"show-icon":"",class:"bulk-import-error"},{title:u(()=>e[142]||(e[142]=[D("匯入時發現以下問題，請確認後重新處理：")])),default:u(()=>[i("ul",Jo,[(y(!0),_(S,null,L(Y.value,(t,A)=>(y(),_("li",{key:A},k(t),1))),128))])]),_:1})):G("",!0),ne.value.length?(y(),_("div",Qo,[e[143]||(e[143]=i("h4",null,"匯入預覽",-1)),r(f,{data:ne.value,size:"small",height:"240"},{default:u(()=>[r(d,{prop:"employeeNo",label:"員工編號",width:"140"}),r(d,{prop:"name",label:"姓名",width:"140"}),r(d,{prop:"department",label:"部門","min-width":"120"}),r(d,{prop:"role",label:"權限",width:"120"}),r(d,{prop:"email",label:"Email","min-width":"160"})]),_:1},8,["data"])])):G("",!0)])):G("",!0)]),_:1},8,["modelValue"]),r(dl,{modelValue:K.value,"onUpdate:modelValue":e[81]||(e[81]=t=>K.value=t),title:we.value||"補齊參照對應",width:"640px",class:"reference-mapping-dialog","close-on-click-modal":!1},{footer:u(()=>[r(a,{onClick:e[80]||(e[80]=t=>K.value=!1),disabled:ce.value},{default:u(()=>e[148]||(e[148]=[D(" 稍後再處理 ")])),_:1},8,["disabled"]),r(a,{type:"primary",loading:ce.value,onClick:bt},{default:u(()=>e[149]||(e[149]=[D(" 套用設定後重新匯入 ")])),_:1},8,["loading"])]),default:u(()=>[e[150]||(e[150]=i("p",{class:"reference-mapping-tip"}," 請為下列資料選擇對應的既有項目，或設定忽略後重新嘗試匯入。 ",-1)),K.value?(y(),_("div",Zo,[l.section&&Array.isArray(l.section.values)&&l.section.values.length?(y(!0),_(S,{key:0},L(yl.value,t=>(y(),_("div",{key:t.type,class:"reference-mapping-section"},[i("h4",en,k(fa(t.type))+"對應 ",1),(y(!0),_(S,null,L(t.values,A=>(y(),_("div",{key:J(A),class:"reference-mapping-item"},[i("div",ln,[i("span",an,k(A.value||"（空值）"),1),i("span",tn," 出現於第 "+k((A.rows||[]).join("、"))+" 列 ",1)]),r(b,{modelValue:ve(t.type,J(A)).mode,"onUpdate:modelValue":h=>ve(t.type,J(A)).mode=h,class:"reference-mapping-mode"},{default:u(()=>[r(c,{label:"map"},{default:u(()=>e[146]||(e[146]=[D("指定既有資料")])),_:1}),r(c,{label:"ignore"},{default:u(()=>e[147]||(e[147]=[D("忽略此次匯入")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),ve(t.type,J(A)).mode==="map"?(y(),T(v,{key:0,modelValue:ve(t.type,J(A)).targetId,"onUpdate:modelValue":h=>ve(t.type,J(A)).targetId=h,placeholder:"請選擇既有項目",class:"reference-mapping-select",filterable:"",clearable:""},{default:u(()=>[(y(!0),_(S,null,L(t.options,h=>(y(),T(g,{key:h.id,label:ct(t.type,h),value:h.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):G("",!0)]))),128))]))),128)):G("",!0),ea.value?G("",!0):(y(),_("div",rn," 所有參照皆已處理，請重新送出匯入。 "))])):G("",!0)]),_:1},8,["modelValue","title"])])]),_:1})}}},sn=Xl(nn,[["__scopeId","data-v-4698c7f5"]]),un={class:"hr-management-system-setting"},dn={__name:"HRManagementSystemSetting",setup(Hl){const Ee=E("employeeMgmt");return(Q,ue)=>{const Pe=R("el-tabs");return y(),_("div",un,[ue[1]||(ue[1]=i("h2",null,"人事管理與系統設定",-1)),r(Pe,{modelValue:Ee.value,"onUpdate:modelValue":ue[0]||(ue[0]=Be=>Ee.value=Be),type:"card"},{default:u(()=>[r(sn)]),_:1},8,["modelValue"])])}}},pn=Xl(dn,[["__scopeId","data-v-8631704d"]]);export{pn as default};
