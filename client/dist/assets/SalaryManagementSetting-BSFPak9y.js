import{a as L}from"./api-D4yO7thr.js";import{_ as ee,r as m,h as le,c as ae,b as f,d as l,w as a,e as r,o as te,j as d,t as E}from"./index-BOg20HvU.js";const oe={class:"salary-management-setting"},ne={class:"tab-content"},ue={slot:"footer",class:"dialog-footer"},de={class:"tab-content"},se={slot:"footer",class:"dialog-footer"},ie={class:"tab-content"},me={class:"tab-content"},re={slot:"footer",class:"dialog-footer"},pe={class:"tab-content"},fe={__name:"SalaryManagementSetting",setup(ve){const R=m("salaryItem"),N=m(null),g=m([{itemName:"交通津貼",type:"加項",taxable:!0,insuranceAffect:!1,desc:"員工交通補助"},{itemName:"伙食補助",type:"加項",taxable:!1,insuranceAffect:!1,desc:""},{itemName:"罰款",type:"扣項",taxable:!1,insuranceAffect:!1,desc:"遲到/早退罰款"}]),x=m(!1);let j=null;const i=m({itemName:"",type:"加項",taxable:!0,insuranceAffect:!1,desc:""});function O(u=null){u!==null?(j=u,i.value={...g.value[u]}):(j=null,i.value={itemName:"",type:"加項",taxable:!0,insuranceAffect:!1,desc:""}),x.value=!0}function J(){j===null?g.value.push({...i.value}):g.value[j]={...i.value},x.value=!1,k()}function q(u){g.value.splice(u,1),k()}const _=m([{gradeName:"初階A",baseSalary:28e3,description:"新進職等"},{gradeName:"中階B",baseSalary:35e3,description:"需具2年以上經驗"},{gradeName:"高階C",baseSalary:5e4,description:"需具5年以上經驗"}]),c=m(!1);let M=null;const v=m({gradeName:"",baseSalary:0,description:""});function T(u=null){u!==null?(M=u,v.value={..._.value[u]}):(M=null,v.value={gradeName:"",baseSalary:0,description:""}),c.value=!0}function z(){M===null?_.value.push({...v.value}):_.value[M]={...v.value},c.value=!1,k()}function H(u){_.value.splice(u,1),k()}const p=m({historyMonths:24,effectiveRule:"nextMonth1",needMultiApproval:!0,needRetroactive:!0});function K(){console.log("儲存調薪與異動規則:",p.value),k()}const V=m({defaultBank:"004",batchFormat:"formatA"}),I=m(!1),P=m([{employeeName:"王小明",bankCode:"004",accountNumber:"1234567890123"},{employeeName:"李主管",bankCode:"822",accountNumber:"0987654321"}]);function Q(){I.value=!0}function W(u){alert(`編輯帳戶：${P.value[u].employeeName}`)}function X(){console.log("儲存發放設定:",V.value),k()}const y=m({includeDependents:!1,courtGarnishment:!1,diffAdjustmentMonths:3});function Y(){console.log("儲存其他薪資設定:",y.value),k()}async function Z(){const u=await L("/api/salary-settings");if(u.ok){const e=await u.json();if(e.length){const o=e[0];N.value=o._id,g.value=o.salaryItems||[],_.value=o.grades||[],Object.assign(p.value,o.adjust||{}),Object.assign(V.value,o.payment||{}),Object.assign(y.value,o.other||{})}}}async function k(){const u={salaryItems:g.value,grades:_.value,adjust:p.value,payment:V.value,other:y.value},e=N.value?`/api/salary-settings/${N.value}`:"/api/salary-settings",o=N.value?"PUT":"POST",s=await L(e,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(s.ok){const A=await s.json();N.value=A._id}}return le(Z),(u,e)=>{const o=r("el-button"),s=r("el-table-column"),A=r("el-table"),D=r("el-input"),n=r("el-form-item"),b=r("el-option"),$=r("el-select"),C=r("el-switch"),U=r("el-form"),F=r("el-dialog"),S=r("el-tab-pane"),G=r("el-input-number"),h=r("el-tabs");return te(),ae("div",oe,[e[46]||(e[46]=f("h2",null,"薪資管理設定",-1)),l(h,{modelValue:R.value,"onUpdate:modelValue":e[26]||(e[26]=t=>R.value=t),type:"card"},{default:a(()=>[l(S,{label:"薪資項目設定",name:"salaryItem"},{default:a(()=>[f("div",ne,[l(o,{type:"primary",onClick:e[0]||(e[0]=t=>O())},{default:a(()=>e[27]||(e[27]=[d("新增薪資項目")])),_:1}),l(A,{data:g.value,style:{"margin-top":"20px"}},{default:a(()=>[l(s,{prop:"itemName",label:"項目名稱",width:"180"}),l(s,{prop:"type",label:"加項/扣項",width:"120"}),l(s,{prop:"taxable",label:"是否計稅",width:"100"},{default:a(({row:t})=>[d(E(t.taxable?"是":"否"),1)]),_:1}),l(s,{prop:"insuranceAffect",label:"是否影響投保",width:"130"},{default:a(({row:t})=>[d(E(t.insuranceAffect?"是":"否"),1)]),_:1}),l(s,{prop:"desc",label:"說明"}),l(s,{label:"操作",width:"180"},{default:a(({row:t,$index:w})=>[l(o,{type:"primary",onClick:B=>O(w)},{default:a(()=>e[28]||(e[28]=[d("編輯")])),_:2},1032,["onClick"]),l(o,{type:"danger",onClick:B=>q(w)},{default:a(()=>e[29]||(e[29]=[d("刪除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(F,{modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=t=>x.value=t),title:"薪資項目設定",width:"500px"},{default:a(()=>[l(U,{model:i.value,"label-width":"100px"},{default:a(()=>[l(n,{label:"項目名稱"},{default:a(()=>[l(D,{modelValue:i.value.itemName,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value.itemName=t),placeholder:"如：交通津貼、伙食補助、全勤獎金…"},null,8,["modelValue"])]),_:1}),l(n,{label:"類型"},{default:a(()=>[l($,{modelValue:i.value.type,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value.type=t),placeholder:"加項 / 扣項"},{default:a(()=>[l(b,{label:"加項",value:"加項"}),l(b,{label:"扣項",value:"扣項"})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"計稅"},{default:a(()=>[l(C,{modelValue:i.value.taxable,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.taxable=t),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),l(n,{label:"影響投保"},{default:a(()=>[l(C,{modelValue:i.value.insuranceAffect,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.insuranceAffect=t),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),l(n,{label:"說明"},{default:a(()=>[l(D,{modelValue:i.value.desc,"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.desc=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),f("span",ue,[l(o,{onClick:e[6]||(e[6]=t=>x.value=!1)},{default:a(()=>e[30]||(e[30]=[d("取消")])),_:1}),l(o,{type:"primary",onClick:J},{default:a(()=>e[31]||(e[31]=[d("儲存")])),_:1})])]),_:1},8,["modelValue"])])]),_:1}),l(S,{label:"職等與底薪",name:"grade"},{default:a(()=>[f("div",de,[l(o,{type:"primary",onClick:e[8]||(e[8]=t=>T())},{default:a(()=>e[32]||(e[32]=[d("新增職等")])),_:1}),l(A,{data:_.value,style:{"margin-top":"20px"}},{default:a(()=>[l(s,{prop:"gradeName",label:"職等名稱",width:"180"}),l(s,{prop:"baseSalary",label:"基本薪資",width:"120"}),l(s,{prop:"description",label:"說明"}),l(s,{label:"操作",width:"180"},{default:a(({row:t,$index:w})=>[l(o,{type:"primary",onClick:B=>T(w)},{default:a(()=>e[33]||(e[33]=[d("編輯")])),_:2},1032,["onClick"]),l(o,{type:"danger",onClick:B=>H(w)},{default:a(()=>e[34]||(e[34]=[d("刪除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(F,{modelValue:c.value,"onUpdate:modelValue":e[13]||(e[13]=t=>c.value=t),title:"職等設定",width:"400px"},{default:a(()=>[l(U,{model:v.value,"label-width":"100px"},{default:a(()=>[l(n,{label:"名稱"},{default:a(()=>[l(D,{modelValue:v.value.gradeName,"onUpdate:modelValue":e[9]||(e[9]=t=>v.value.gradeName=t),placeholder:"如：職等A / 初階 / 資深…"},null,8,["modelValue"])]),_:1}),l(n,{label:"基本薪資"},{default:a(()=>[l(G,{modelValue:v.value.baseSalary,"onUpdate:modelValue":e[10]||(e[10]=t=>v.value.baseSalary=t),min:0},null,8,["modelValue"])]),_:1}),l(n,{label:"說明"},{default:a(()=>[l(D,{modelValue:v.value.description,"onUpdate:modelValue":e[11]||(e[11]=t=>v.value.description=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),f("span",se,[l(o,{onClick:e[12]||(e[12]=t=>c.value=!1)},{default:a(()=>e[35]||(e[35]=[d("取消")])),_:1}),l(o,{type:"primary",onClick:z},{default:a(()=>e[36]||(e[36]=[d("儲存")])),_:1})])]),_:1},8,["modelValue"])])]),_:1}),l(S,{label:"調薪與異動",name:"adjust"},{default:a(()=>[f("div",ie,[l(U,{model:p.value,"label-width":"180px"},{default:a(()=>[l(n,{label:"歷史薪資保留(個月)"},{default:a(()=>[l(G,{modelValue:p.value.historyMonths,"onUpdate:modelValue":e[14]||(e[14]=t=>p.value.historyMonths=t),min:0},null,8,["modelValue"]),e[37]||(e[37]=f("small",null,"保留多久前的薪資紀錄",-1))]),_:1}),l(n,{label:"調薪生效日規則"},{default:a(()=>[l($,{modelValue:p.value.effectiveRule,"onUpdate:modelValue":e[15]||(e[15]=t=>p.value.effectiveRule=t)},{default:a(()=>[l(b,{label:"次月一號",value:"nextMonth1"}),l(b,{label:"當月同日",value:"sameDay"}),l(b,{label:"依簽核通過日",value:"approvalDate"})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"是否需多層簽核"},{default:a(()=>[l(C,{modelValue:p.value.needMultiApproval,"onUpdate:modelValue":e[16]||(e[16]=t=>p.value.needMultiApproval=t)},null,8,["modelValue"])]),_:1}),l(n,{label:"薪資差異補發 / 補扣"},{default:a(()=>[l(C,{modelValue:p.value.needRetroactive,"onUpdate:modelValue":e[17]||(e[17]=t=>p.value.needRetroactive=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[l(o,{type:"primary",onClick:K},{default:a(()=>e[38]||(e[38]=[d("儲存調薪規則")])),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),l(S,{label:"發放與帳戶",name:"payment"},{default:a(()=>[f("div",me,[l(U,{model:V.value,"label-width":"160px"},{default:a(()=>[l(n,{label:"預設銀行代碼"},{default:a(()=>[l($,{modelValue:V.value.defaultBank,"onUpdate:modelValue":e[18]||(e[18]=t=>V.value.defaultBank=t),placeholder:"選擇銀行"},{default:a(()=>[l(b,{label:"台灣銀行 (004)",value:"004"}),l(b,{label:"台新銀行 (812)",value:"812"}),l(b,{label:"中國信託 (822)",value:"822"}),l(b,{label:"國泰世華 (013)",value:"013"})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"發薪帳戶維護"},{default:a(()=>[l(o,{type:"primary",onClick:e[19]||(e[19]=t=>Q())},{default:a(()=>e[39]||(e[39]=[d("管理帳戶")])),_:1})]),_:1}),l(n,{label:"薪資轉帳批次格式"},{default:a(()=>[l($,{modelValue:V.value.batchFormat,"onUpdate:modelValue":e[20]||(e[20]=t=>V.value.batchFormat=t)},{default:a(()=>[l(b,{label:"自訂格式 A",value:"formatA"}),l(b,{label:"自訂格式 B",value:"formatB"})]),_:1},8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[l(o,{type:"primary",onClick:X},{default:a(()=>e[40]||(e[40]=[d("儲存發放設定")])),_:1})]),_:1})]),_:1},8,["model"])]),l(F,{modelValue:I.value,"onUpdate:modelValue":e[22]||(e[22]=t=>I.value=t),title:"銀行帳戶維護",width:"600px"},{default:a(()=>[l(A,{data:P.value},{default:a(()=>[l(s,{prop:"employeeName",label:"員工姓名",width:"120"}),l(s,{prop:"bankCode",label:"銀行代碼",width:"100"}),l(s,{prop:"accountNumber",label:"帳號"}),l(s,{label:"操作",width:"120"},{default:a(({row:t,$index:w})=>[l(o,{type:"primary",onClick:B=>W(w)},{default:a(()=>e[41]||(e[41]=[d("編輯")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),f("span",re,[l(o,{onClick:e[21]||(e[21]=t=>I.value=!1)},{default:a(()=>e[42]||(e[42]=[d("關閉")])),_:1})])]),_:1},8,["modelValue"])]),_:1}),l(S,{label:"其他設定",name:"others"},{default:a(()=>[f("div",pe,[l(U,{model:y.value,"label-width":"180px"},{default:a(()=>[l(n,{label:"扶養親屬資料 (是否納入撫養額)"},{default:a(()=>[l(C,{modelValue:y.value.includeDependents,"onUpdate:modelValue":e[23]||(e[23]=t=>y.value.includeDependents=t)},null,8,["modelValue"])]),_:1}),l(n,{label:"法院扣押處理"},{default:a(()=>[l(C,{modelValue:y.value.courtGarnishment,"onUpdate:modelValue":e[24]||(e[24]=t=>y.value.courtGarnishment=t)},null,8,["modelValue"]),e[43]||(e[43]=f("small",null,"若啟用，需在員工資料內填寫扣押比例或金額",-1))]),_:1}),l(n,{label:"薪資差異調整 (歷史月份)"},{default:a(()=>[l(G,{modelValue:y.value.diffAdjustmentMonths,"onUpdate:modelValue":e[25]||(e[25]=t=>y.value.diffAdjustmentMonths=t),min:0},null,8,["modelValue"]),e[44]||(e[44]=f("small",null,"允許調整多少個月前的薪資紀錄",-1))]),_:1}),l(n,null,{default:a(()=>[l(o,{type:"primary",onClick:Y},{default:a(()=>e[45]||(e[45]=[d("儲存其他設定")])),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"])])}}},Ve=ee(fe,[["__scopeId","data-v-8f20e5f6"]]);export{Ve as default};
