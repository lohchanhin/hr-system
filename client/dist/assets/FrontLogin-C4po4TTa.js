import{_ as x,r as p,c as m,a as V,b as e,d as r,w as n,e as l,u as j,o as g,f as M,h as B,g as S,s as L,E as w}from"./index-C25OXyZh.js";import{u as F}from"./menu-RZOQIFJS.js";import{a as R}from"./api-C2nzzaKe.js";const I={class:"front-login-container"},N={class:"login-form-container"},H={key:0},T={key:1},z={__name:"FrontLogin",setup(E){const k=j(),f=F(),t=p({role:"employee",username:"",password:""}),u=p(null),a=p(!1),C=[{value:"employee",label:"一般員工",description:"查看排班、打卡考勤",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'}],b={username:[{required:!0,message:"請輸入員工帳號",trigger:"blur"},{min:3,message:"帳號長度至少3個字符",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:6,message:"密碼長度至少6個字符",trigger:"blur"}]};async function v(){if(u.value)try{if(!await u.value.validate())return;a.value=!0;const o=await R("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.value.username,password:t.value.password,role:t.value.role})},{autoRedirect:!1}),s=await o.json();o.ok?(L(s.token),localStorage.setItem("role",s.user.role),localStorage.setItem("employeeId",s.user.employeeId||s.user.id),w.success(`歡迎回來，${C[0].label}！`),await f.fetchMenu(),k.push("/front/attendance")):w.error(s.message||"登入失敗，請檢查帳號密碼")}catch(i){console.error("Login error:",i),w.error(`登入失敗: ${i.message}`)}finally{a.value=!1}}return(i,o)=>{const s=l("el-input"),c=l("el-form-item"),h=l("el-button"),_=l("el-form"),y=l("el-card");return g(),m("div",I,[o[8]||(o[8]=V('<div class="login-background" data-v-6cdb445c><div class="login-brand" data-v-6cdb445c><div class="brand-icon" data-v-6cdb445c><svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6cdb445c><path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6cdb445c></path><circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6cdb445c></circle><path d="M23 21V19C23 18.1645 22.7155 17.3541 22.2094 16.6977C21.7033 16.0414 20.9999 15.5759 20.2 15.3805" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6cdb445c></path><path d="M16 3.13C16.8003 3.32548 17.5037 3.79099 18.0098 4.44738C18.5159 5.10377 18.8002 5.91416 18.8002 6.75C18.8002 7.58584 18.5159 8.39623 18.0098 9.05262C17.5037 9.70901 16.8003 10.1745 16 10.37" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6cdb445c></path></svg></div><h1 class="brand-title" data-v-6cdb445c>員工入口</h1><p class="brand-subtitle" data-v-6cdb445c>Human Resources Portal</p></div></div>',1)),e("div",N,[r(y,{class:"login-card",shadow:"always"},{default:n(()=>[o[6]||(o[6]=e("div",{class:"login-header"},[e("h2",{class:"login-title"},"員工登入"),e("p",{class:"login-description"},"請登入系統")],-1)),r(_,{model:t.value,ref_key:"loginFormRef",ref:u,class:"login-form",rules:b,onSubmit:M(v,["prevent"])},{default:n(()=>[r(c,{prop:"username",class:"form-item"},{default:n(()=>[o[3]||(o[3]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"員工帳號")],-1)),r(s,{modelValue:t.value.username,"onUpdate:modelValue":o[0]||(o[0]=d=>t.value.username=d),placeholder:"請輸入員工帳號",size:"large",class:"custom-input"},null,8,["modelValue"])]),_:1}),r(c,{prop:"password",class:"form-item"},{default:n(()=>[o[4]||(o[4]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"12",cy:"16",r:"1",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"密碼")],-1)),r(s,{modelValue:t.value.password,"onUpdate:modelValue":o[1]||(o[1]=d=>t.value.password=d),type:"password",placeholder:"請輸入密碼",size:"large",class:"custom-input","show-password":""},null,8,["modelValue"])]),_:1}),r(c,{class:"form-item"},{default:n(()=>[r(h,{type:"primary",size:"large",class:"login-button",loading:a.value,onClick:v,"native-type":"submit"},{default:n(()=>[a.value?(g(),m("span",T,"登入中...")):(g(),m("span",H,"登入系統"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),r(h,{type:"text",class:"manager-login-link",onClick:o[2]||(o[2]=d=>B(k).push("/manager/login"))},{default:n(()=>o[5]||(o[5]=[S(" 主管／系統管理員登入 ")])),_:1}),o[7]||(o[7]=e("div",{class:"access-info"},[e("div",{class:"info-item"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 6V12L16 14",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"24小時全天候服務")]),e("div",{class:"info-item"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 22S8 18 8 13V6L12 4L16 6V13C16 18 12 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"安全加密傳輸")])],-1))]),_:1})])])}}},P=x(z,[["__scopeId","data-v-6cdb445c"]]);export{P as default};
