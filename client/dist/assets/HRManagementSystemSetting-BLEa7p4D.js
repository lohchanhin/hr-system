import{_ as Kl,j as q,r as E,y as ye,u as Ut,k as Tt,m as De,e as C,n as R,o as g,w as u,b as i,d as o,v as k,g as D,c as _,q as K,F as S,t as L,h as Rt,E as O,B as ml,C as Ct}from"./index-BrcIUlQl.js";import{a as re,b as Ot}from"./api-Dn_BGH9X.js";const Nt={class:"employee-management"},Pt={class:"page-header"},Bt={class:"header-stats"},zt={class:"stat-item"},jt={class:"stat-number"},Mt={class:"stat-item"},xt={class:"stat-number"},Ft={class:"content-header"},$t={class:"content-actions"},Yt={class:"table-container"},qt={class:"employee-info"},Kt={class:"employee-details"},Gt={class:"employee-name"},Xt={class:"employee-id"},Ht={class:"department-info"},Wt={key:1,class:"no-data"},Jt={class:"contact-info"},Qt={key:0,class:"contact-item"},Zt={key:1,class:"contact-item"},eo={key:2,class:"no-data"},lo={class:"action-buttons"},ao={class:"tab-content"},to={class:"form-section"},oo={class:"form-group"},ro={class:"form-group"},no={class:"role-option"},so={class:"role-name"},io={class:"role-desc"},uo={class:"option-wrapper"},co={class:"option-title"},mo={class:"tab-content"},po={class:"form-section"},fo={class:"form-group"},vo={class:"option-wrapper"},yo={class:"option-title"},go={class:"option-desc"},bo={class:"option-wrapper"},ho={class:"option-title"},_o={class:"option-desc"},Vo={class:"tab-content"},wo={class:"form-section"},Ao={class:"form-group"},So={class:"form-row"},Lo={class:"form-row"},ko={class:"form-row"},Do={class:"form-row"},Eo={class:"form-row"},Io={class:"form-group"},Uo={class:"form-row"},To={class:"form-row"},Ro={class:"tab-content"},Co={class:"form-section"},Oo={class:"form-group"},No={class:"form-row"},Po={class:"form-row"},Bo={class:"form-group"},zo={class:"form-row"},jo={class:"form-row"},Mo={class:"form-group"},xo={class:"form-row"},Fo={class:"form-row"},$o={class:"form-row"},Yo={class:"form-row"},qo={class:"form-row"},Ko={class:"tab-content"},Go={class:"form-section"},Xo={class:"form-group"},Ho={class:"form-row"},Wo={class:"form-row"},Jo={class:"form-group"},Qo={class:"form-row"},Zo={class:"form-row"},er={class:"form-row"},lr={class:"form-group"},ar={class:"form-row"},tr={class:"form-row"},or={class:"form-group"},rr={class:"emergency-contact"},nr={class:"form-row"},sr={class:"form-row"},ir={class:"emergency-contact"},ur={class:"form-row"},dr={class:"form-row"},cr={class:"form-group"},mr={class:"experience-list"},pr={class:"experience-header"},fr={class:"experience-title"},vr={class:"form-row"},yr={class:"form-row"},gr={class:"form-group"},br={class:"experience-list"},hr={class:"experience-header"},_r={class:"experience-title"},Vr={class:"form-row"},wr={class:"form-row"},Ar={class:"form-row"},Sr={class:"form-group"},Lr={class:"experience-list"},kr={class:"experience-header"},Dr={class:"experience-title"},Er={class:"form-row"},Ir={class:"form-row"},Ur={class:"form-row"},Tr={class:"tab-content"},Rr={class:"form-section"},Cr={class:"form-group"},Or={class:"form-row"},Nr={class:"form-group"},Pr={class:"account-section"},Br={class:"form-row"},zr={class:"account-section"},jr={class:"form-row"},Mr={class:"dialog-footer"},xr={class:"bulk-import-header"},Fr={class:"template-link"},$r={class:"bulk-import-upload"},Yr={class:"bulk-import-form"},qr={class:"bulk-import-section-title"},Kr={class:"bulk-import-header-code"},Gr={key:1,class:"bulk-import-optional-text"},Xr={key:0,class:"bulk-import-result"},Hr={class:"error-list"},Wr={key:1,class:"bulk-import-preview"},Jr={class:"reference-mapping-title"},Qr={class:"reference-mapping-info"},Zr={class:"reference-mapping-value"},en={class:"reference-mapping-rows"},ln={key:1,class:"reference-mapping-empty"},an={key:2,class:"reference-mapping-empty"},tn="employee-import-template.csv",on={__name:"EmployeeManagement",setup(Gl){var $l,Yl;async function Ee(){if(typeof window<"u"&&window&&window.XLSX&&window.XLSX.utils)return window.XLSX;try{const l=await Ct(()=>import("./xlsx-DkH2s96g.js"),[]),e=l&&(l.default||l.XLSX)?l.default||l.XLSX:l;if(e&&e.utils&&e.read)return e}catch{}if(typeof window<"u"&&typeof document<"u"&&(await new Promise((l,e)=>{const a=document.querySelector("script[data-xlsx-cdn]");if(a){a.addEventListener("load",()=>l(null),{once:!0}),a.addEventListener("error",()=>e(new Error("XLSX_CDN_FAIL")),{once:!0});return}const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js",s.async=!0,s.defer=!0,s.setAttribute("data-xlsx-cdn","1"),s.onload=()=>l(null),s.onerror=()=>e(new Error("XLSX_CDN_FAIL")),document.head.appendChild(s)}),window.XLSX&&window.XLSX.utils&&window.XLSX.read))return window.XLSX;throw new Error("XLSX_MODULE_INVALID_OR_NOT_FOUND")}function Z(l=""){return l.replace(/^\uFEFF/,"")}function ue(l){try{let e=new TextDecoder("utf-8",{fatal:!1}).decode(l);if(e.length>=2&&e.charCodeAt(0)===65279&&(e=Z(e)),(e.slice(0,64).match(/\x00/g)||[]).length/Math.max(1,Math.min(64,e.length))>.2)throw new Error("maybe-utf16le");return Z(e)}catch{try{return Z(new TextDecoder("utf-16le",{fatal:!1}).decode(l))}catch{let e="";const a=new Uint8Array(l);for(let s=0;s<a.length;s++)e+=String.fromCharCode(a[s]);return Z(e)}}}function Pe(l){const e=l.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(p=>p.length>0);if(!e.length)return[];const a=e[0],s=(a.match(/\t/g)||[]).length,d=(a.match(/,/g)||[]).length;return(s>d?"	":null)?e.map(p=>p.split("	")):[]}function Be(l){const a=(typeof(l==null?void 0:l.name)=="string"?l.name:"").match(/\.([^.]+)$/i);return a?a[1].toLowerCase():""}async function Xl(l){return l.arrayBuffer?await l.arrayBuffer():await new Promise((e,a)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=a,s.readAsArrayBuffer(l)})}function Hl(l){if(l==null||l==="")return"";const e=String(l).trim().replace(/\./g,"-").replace(/\//g,"-"),a=e.match(/^(\d{4})[-](\d{1,2})[-](\d{1,2})$/);if(!a)return e;const s=a[1],d=String(a[2]).padStart(2,"0"),c=String(a[3]).padStart(2,"0");return`${s}-${d}-${c}`}function Wl(l){if(l==null||l==="")return"";const e=String(l).trim().toLowerCase();return["true","yes","y","1"].includes(e)?"TRUE":["false","no","n","0"].includes(e)?"FALSE":String(l)}function Jl(l){return l==null||l===""?[]:String(l).split(",").map(e=>e.trim()).filter(Boolean)}function pl(l,e){if(!e)return[];const a=l.utils.sheet_to_json(e,{header:1,defval:""});if(!Array.isArray(a)||a.length===0)return[];const s=(a[0]||[]).map(p=>Z(String(p??"").trim())),d=a.slice(2),c=[];for(const p of d){if(!Array.isArray(p)||p.every(m=>String(m??"").trim()===""))continue;const n={};for(let m=0;m<s.length;m++){const b=s[m]||`col_${m}`;n[b]=p[m]??""}c.push(n)}return c}function fl(l=""){return Z(String(l)).trim().toLowerCase()}function ze(l=[]){const e=new Map(l.map(a=>[fl(a),a]));ne.forEach(a=>{const s=a.header||a.key,d=e.get(fl(s));d&&(U.columnMappings[a.key]=d)})}async function vl(l){var c,p;const e=await Ee(),a=await Xl(l);try{const f=e.read(a,{type:"array",codepage:65001}),n=(c=f.SheetNames)==null?void 0:c[0],m=n?f.Sheets[n]:null,b=pl(e,m);if(b.length)return ze(Object.keys(b[0])),b}catch{}const s=ue(a),d=Pe(s);if(d.length){const f=(d[0]||[]).map(y=>Z(String(y??"").trim())),b=(d[1]||[]).some(y=>/必填|\(|\)|已婚|未婚|離婚|喪偶|TRUE|FALSE/.test(String(y||"")))?d.slice(2):d.slice(1);ze(f);const v=b.map(y=>{const V={};for(let I=0;I<f.length;I++)V[f[I]||`col_${I}`]=y[I]??"";return V}).filter(y=>Object.values(y).some(V=>String(V??"").trim()!==""));if(v.length)return v}try{const f=e.read(s,{type:"string"}),n=(p=f.SheetNames)==null?void 0:p[0],m=n?f.Sheets[n]:null,b=pl(e,m);if(b.length)return ze(Object.keys(b[0])),b}catch{}return[]}const je=q(()=>(Array.isArray(G.value)?G.value:[]).map(e=>{const a=Array.isArray(z==null?void 0:z[e])?z[e]:[],s=Array.isArray(X==null?void 0:X[e])?X[e]:[];return{type:e,values:a,options:s}}));function yl(l,e){const a={};for(const s of ne){const d=s.key,c=(e==null?void 0:e[d])||s.header,p=l[c];switch(d){case"birthday":case"hireDate":case"appointDate":case"resignDate":case"dismissDate":case"reAppointDate":case"reDismissDate":a[d]=Hl(p);break;case"isPartTime":case"isClocking":a[d]=Wl(p);break;case"languages":case"identityCategory":case"salaryItems":a[d]=Jl(p);break;case"laborPensionSelf":case"employeeAdvance":case"probationDays":case"dischargeYear":a[d]=p===""||p==null?"":String(p).replace(/[^\d.-]/g,"");break;default:a[d]=p??"";break}}return a}function Ql(l){const e=[],a=ne.filter(s=>s.required).map(s=>s.key);return l.forEach((s,d)=>{const c=a.filter(p=>s[p]==null||String(s[p]).trim()==="");if(c.length){const p=c.map(f=>{const n=ne.find(m=>m.key===f);return(n==null?void 0:n.label)||(n==null?void 0:n.description)||(n==null?void 0:n.header)||f}).join("、");e.push(`第 ${d+1} 列缺少必填欄位：${p}`)}}),e}function Zl(l){return l.map(e=>({employeeNo:e.employeeNo||e.employeeId||"",name:e.name||"",department:e.department||"",role:e.employmentStatus||e.status||"",email:e.email||""}))}async function ea(l){try{const e=Be(l);if(!["xlsx","xls","csv"].includes(e))return O.warning("請上傳 .xlsx/.xls/.csv 檔案"),{ok:!1};const a=await vl(l);if(!a.length)return O.warning("檔案內容為空，或格式不符（請使用範本）"),{ok:!1};const s=a.map(p=>yl(p,U.columnMappings)),d=Ql(s),c=Zl(s);return se.value=c,F.value=d,{ok:!0}}catch(e){return console.error("解析匯入檔失敗：",e),O.error("解析匯入檔失敗，請確認檔案是否符合範本格式"),{ok:!1,error:e}}}async function la(l){if(!((l==null?void 0:l.raw)||l))return;const a=H.value,s=de.value.map(c=>({...c}));if(!!a&&a!==l.raw&&_l.value)try{await ml.confirm("重新選擇檔案將清除目前的預覽資料與參照對應設定，是否繼續？","確認更換匯入檔案",{type:"warning",confirmButtonText:"重新選擇",cancelButtonText:"保留現況"})}catch{de.value=s;return}nl({resetMappings:!1,resetResolvedReferences:!0,referenceKeys:W}),H.value=l.raw,de.value=[l],await ea(l.raw)}function aa(){nl({resetMappings:!1,resetResolvedReferences:!0,referenceKeys:W})}const ta=Ut();function N(l){if(l==null)return"";if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return String(l);if(typeof l=="object"){const e=l.code??l.value??l.name??l.label??(typeof l.toString=="function"?l.toString():"");return typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):""}return""}function x(l=[]){return(Array.isArray(l)?l:[l]).map(a=>{if(a==null)return null;if(typeof a=="object"&&!Array.isArray(a)){const d=a.name??a.label??a.value??a.code??(typeof a.toString=="function"?a.toString():"");let c=a.code??a.value??"";if(!c&&d&&(c=d),!d&&!c)return null;const p=typeof c=="string"?c:String(c);return{label:d||p,value:p}}const s=String(a).trim();return s?{label:s,value:s}:null}).filter(Boolean)}function Me(l=[]){return(Array.isArray(l)?l:[]).map(e=>({...e}))}function oa(l,e=[]){if(!Array.isArray(l))return Me(e);const a=x(l);return a.length?a:Me(e)}function ee(l){return(Array.isArray(l)?l:l==null||l===""?[]:[l]).map(a=>N(a)).filter(a=>a!=="")}function ra(l,e){const a=N(e);if(!a)return"";const d=(Array.isArray(l==null?void 0:l.value)?l.value:Array.isArray(l)?l:[]).find(c=>c.value===a||c.label===a);return(d==null?void 0:d.label)??a}const Ie=[{label:"管理員",value:"admin"},{label:"主管",value:"supervisor"},{label:"員工",value:"employee"}],ne=Object.freeze([{key:"employeeNo",header:"employeeId",label:"員工編號",description:"員工編號",required:!0,category:"基本資料"},{key:"name",header:"name",label:"姓名",description:"姓名",required:!0,category:"基本資料"},{key:"gender",header:"gender",label:"性別",description:"性別 (M=男, F=女, O=其他)",category:"基本資料"},{key:"idNumber",header:"idNumber",label:"身分證號",description:"身分證號",category:"基本資料"},{key:"birthday",header:"birthDate",label:"生日",description:"生日 (yyyy-mm-dd)",category:"基本資料"},{key:"birthplace",header:"birthPlace",label:"出生地",description:"出生地",category:"基本資料"},{key:"bloodType",header:"bloodType",label:"血型",description:"血型 (A/B/O/AB/HR)",category:"基本資料"},{key:"languages",header:"languages",label:"語言",description:"語言 (多個以逗號分隔)",category:"個人特質"},{key:"disabilityLevel",header:"disabilityLevel",label:"失能等級",description:"失能等級",category:"個人特質"},{key:"identityCategory",header:"identityCategory",label:"身分類別",description:"身分類別 (多個以逗號分隔)",category:"個人特質"},{key:"maritalStatus",header:"maritalStatus",label:"婚姻狀況",description:"婚姻狀況 (已婚/未婚/離婚/喪偶)",category:"家庭狀況"},{key:"dependents",header:"dependents",label:"扶養人數",description:"扶養人數",category:"家庭狀況"},{key:"email",header:"email",label:"電子郵件",description:"電子郵件 (必填唯一)",required:!0,category:"聯絡資訊"},{key:"phone",header:"mobile",label:"手機號碼",description:"手機號碼",category:"聯絡資訊"},{key:"landline",header:"landline",label:"市話",description:"市話",category:"聯絡資訊"},{key:"householdAddress",header:"householdAddress",label:"戶籍地址",description:"戶籍地址",category:"聯絡資訊"},{key:"contactAddress",header:"contactAddress",label:"聯絡地址",description:"聯絡地址",category:"聯絡資訊"},{key:"lineId",header:"lineId",label:"Line 帳號",description:"Line 帳號",category:"聯絡資訊"},{key:"organization",header:"organization",label:"所屬機構",description:"所屬機構",category:"組織與職務"},{key:"department",header:"department",label:"部門 ID",description:"部門 ID",category:"組織與職務"},{key:"subDepartment",header:"subDepartment",label:"子部門 ID",description:"子部門 ID",category:"組織與職務"},{key:"supervisor",header:"supervisor",label:"主管員工 ID",description:"主管員工 ID",category:"組織與職務"},{key:"title",header:"title",label:"職稱",description:"職稱",category:"組織與職務"},{key:"practiceTitle",header:"practiceTitle",label:"執業職稱",description:"執業職稱",category:"組織與職務"},{key:"employmentStatus",header:"status",label:"人員狀態",description:"人員狀態 (正職員工/試用期/離職/留職停薪)",category:"雇用設定"},{key:"probationDays",header:"probationDays",label:"試用期天數",description:"試用期天數",category:"雇用設定"},{key:"isPartTime",header:"partTime",label:"是否兼職",description:"是否兼職 (TRUE/FALSE)",category:"雇用設定"},{key:"isClocking",header:"needClockIn",label:"是否需打卡",description:"是否需打卡 (TRUE/FALSE)",category:"雇用設定"},{key:"educationLevel",header:"education_level",label:"學歷程度",description:"學歷程度",category:"學歷資訊"},{key:"schoolName",header:"education_school",label:"畢業學校",description:"畢業學校",category:"學歷資訊"},{key:"major",header:"education_major",label:"主修科目",description:"主修科目",category:"學歷資訊"},{key:"graduationStatus",header:"education_status",label:"學歷狀態",description:"學歷狀態 (畢業/肄業)",category:"學歷資訊"},{key:"graduationYear",header:"education_graduationYear",label:"畢業年份",description:"畢業年份",category:"學歷資訊"},{key:"serviceType",header:"militaryService_type",label:"役別類型",description:"役別類型 (志願役/義務役)",category:"兵役資訊"},{key:"militaryBranch",header:"militaryService_branch",label:"軍種",description:"軍種",category:"兵役資訊"},{key:"militaryRank",header:"militaryService_rank",label:"軍階",description:"軍階",category:"兵役資訊"},{key:"dischargeYear",header:"militaryService_dischargeYear",label:"退伍年份",description:"退伍年份",category:"兵役資訊"},{key:"emergency1.name",header:"emergency1_name",label:"緊急聯絡人1 姓名",description:"緊急聯絡人1 姓名",category:"緊急聯絡人"},{key:"emergency1.relation",header:"emergency1_relation",label:"緊急聯絡人1 關係",description:"緊急聯絡人1 關係",category:"緊急聯絡人"},{key:"emergency1.phone1",header:"emergency1_phone1",label:"緊急聯絡人1 電話1",description:"緊急聯絡人1 電話1",category:"緊急聯絡人"},{key:"emergency1.phone2",header:"emergency1_phone2",label:"緊急聯絡人1 電話2",description:"緊急聯絡人1 電話2",category:"緊急聯絡人"},{key:"emergency2.name",header:"emergency2_name",label:"緊急聯絡人2 姓名",description:"緊急聯絡人2 姓名",category:"緊急聯絡人"},{key:"emergency2.relation",header:"emergency2_relation",label:"緊急聯絡人2 關係",description:"緊急聯絡人2 關係",category:"緊急聯絡人"},{key:"emergency2.phone1",header:"emergency2_phone1",label:"緊急聯絡人2 電話1",description:"緊急聯絡人2 電話1",category:"緊急聯絡人"},{key:"emergency2.phone2",header:"emergency2_phone2",label:"緊急聯絡人2 電話2",description:"緊急聯絡人2 電話2",category:"緊急聯絡人"},{key:"hireDate",header:"hireDate",label:"到職日期",description:"到職日期 (yyyy-mm-dd)",category:"任職期間"},{key:"appointDate",header:"startDate",label:"起聘日期",description:"起聘日期 (yyyy-mm-dd)",category:"任職期間"},{key:"resignDate",header:"resignationDate",label:"離職日期",description:"離職日期 (yyyy-mm-dd)",category:"任職期間"},{key:"dismissDate",header:"dismissalDate",label:"解聘日期",description:"解聘日期 (yyyy-mm-dd)",category:"任職期間"},{key:"reAppointDate",header:"rehireStartDate",label:"再任起聘",description:"再任起聘 (yyyy-mm-dd)",category:"任職期間"},{key:"reDismissDate",header:"rehireEndDate",label:"再任解聘",description:"再任解聘 (yyyy-mm-dd)",category:"任職期間"},{key:"employmentNote",header:"appointment_remark",label:"任職備註",description:"任職備註",category:"任職期間"},{key:"salaryType",header:"salaryType",label:"薪資類型",description:"薪資類型 (月薪/日薪/時薪)",category:"薪資與帳戶"},{key:"salaryAmount",header:"salaryAmount",label:"薪資金額",description:"薪資金額",category:"薪資與帳戶"},{key:"laborPensionSelf",header:"laborPensionSelf",label:"自提勞退 (%)",description:"自提勞退 (%)",category:"薪資與帳戶"},{key:"employeeAdvance",header:"employeeAdvance",label:"員工墊付金額",description:"員工墊付金額",category:"薪資與帳戶"},{key:"salaryAccountA.bank",header:"salaryAccountA_bank",label:"薪資帳戶A 銀行代號",description:"薪資帳戶A 銀行代號",category:"薪資與帳戶"},{key:"salaryAccountA.acct",header:"salaryAccountA_acct",label:"薪資帳戶A 帳號",description:"薪資帳戶A 帳號",category:"薪資與帳戶"},{key:"salaryAccountB.bank",header:"salaryAccountB_bank",label:"薪資帳戶B 銀行代號",description:"薪資帳戶B 銀行代號",category:"薪資與帳戶"},{key:"salaryAccountB.acct",header:"salaryAccountB_acct",label:"薪資帳戶B 帳號",description:"薪資帳戶B 帳號",category:"薪資與帳戶"},{key:"salaryItems",header:"salaryItems",label:"其他薪資項目",description:"其他薪資項目 (多個逗號分隔)",category:"薪資與帳戶"}]);function na(l={}){const e=l.description||l.label||l.header||l.key||"";if(!l.required)return typeof e=="string"?e:String(e);const a=typeof e=="string"?e:String(e);return a.includes("必填")?a:`${a} (必填)`}const sa=ne.filter(l=>l.required).map(l=>l.key),ge=Object.freeze(ne.reduce((l,e)=>(l[e.key]=e.header,l),{})),ia=Object.freeze([{employeeId:"EMP-0001",name:"王曉明",gender:"M",birthDate:"1990-03-12",email:"import.hr001@example.com",mobile:"0912000001",organization:"總公司",department:"HR001",title:"人資專員",status:"正職員工",hireDate:"2020-07-01",partTime:"FALSE",needClockIn:"TRUE",lineId:"hr-king",languages:"中文,英文"},{employeeId:"EMP-0002",name:"林語彤",gender:"F",birthDate:"1994-08-25",email:"import.hr002@example.com",mobile:"0912000002",organization:"台北院區",department:"NUR101",title:"資深護理師",status:"試用期",hireDate:"2024-02-15",partTime:"FALSE",needClockIn:"TRUE",lineId:"nurse-ruby",languages:"中文,台語"},{employeeId:"EMP-0003",name:"陳建宇",gender:"M",birthDate:"1988-11-05",email:"import.hr003@example.com",mobile:"0912000003",organization:"總公司",department:"IT001",title:"系統工程師",status:"正職員工",hireDate:"2019-11-20",partTime:"FALSE",needClockIn:"FALSE",lineId:"it-jack",languages:"中文,英文"},{employeeId:"EMP-0004",name:"吳雅珊",gender:"F",birthDate:"1992-01-18",email:"import.hr004@example.com",mobile:"0912000004",organization:"總公司",department:"FIN201",title:"會計專員",status:"留職停薪",hireDate:"2018-04-09",partTime:"TRUE",needClockIn:"FALSE",lineId:"fin-olivia",languages:"中文,英文"},{employeeId:"EMP-0005",name:"張志強",gender:"M",birthDate:"1985-06-30",email:"import.hr005@example.com",mobile:"0912000005",organization:"新北院區",department:"OPS301",title:"營運主管",status:"離職",hireDate:"2016-01-03",resignationDate:"2023-12-31",partTime:"FALSE",needClockIn:"TRUE",lineId:"ops-alex",languages:"中文,英文"}]),Ue=q(()=>ne.map(l=>({...l,displayDescription:na(l)}))),gl=[{level:"L1",description:"一般使用者 / 基層專員"},{level:"L2",description:"資深專員 / 小組長"},{level:"L3",description:"部門主管 / 課長"},{level:"L4",description:"處室主管 / 協理"},{level:"L5",description:"高階決策者 / 最高主管"}],Te=E([]),xe=E([]),Fe=E([]),$e=E([]),Ye=E([]),qe=E([]),Ke=E([]),Ge=E([]),bl=E([]),be=E([]),Xe=(($l=Ie.find(l=>l.value==="employee"))==null?void 0:$l.value)??((Yl=Ie[0])==null?void 0:Yl.value)??"",he=E(!1),_e=E(null),Ve=E(!1),H=E(null),de=E([]),se=E([]),F=E([]),U=ye({columnMappings:{...ge},options:{defaultRole:Xe,resetPassword:"",sendWelcomeEmail:!1}}),W=Object.freeze(["organization","department","subDepartment"]),hl=Object.freeze({organization:"機構",department:"部門",subDepartment:"子部門"}),ua=Object.freeze({organization:["organization","org","organizations"],department:["department","dept","departments"],subDepartment:["subDepartment","subdept","sub_department","subDepartments"]}),da=Object.freeze(Object.entries(ua).reduce((l,[e,a])=>((Array.isArray(a)?a:[]).concat(e).forEach(d=>{typeof d=="string"&&d.trim()&&(l[d.trim().toLowerCase()]=e)}),l),{})),$=E(!1),we=E(""),G=E([...W]),z=ye({}),X=ye({}),Y=ye({}),j=ye({}),M=ye({}),ce=E(!1),_l=q(()=>{const l=!!H.value,e=(de.value||[]).length>0,a=(se.value||[]).length>0,s=(F.value||[]).length>0,d=$.value,c=!!we.value,p=G.value.some(y=>(z[y]||[]).length>0),f=Object.values(j).some(y=>Object.keys(y||{}).length>0)||Object.values(M).some(y=>Array.isArray(y)&&y.length>0),n=Object.keys(ge),m=new Set([...n,...Object.keys(U.columnMappings)]),b=Array.from(m).some(y=>{const V=U.columnMappings[y]??"",I=ge[y]??"";return V!==I}),v=U.options.defaultRole!==Xe||!!U.options.resetPassword||!!U.options.sendWelcomeEmail;return l||e||a||s||d||c||p||f||b||v});He(W,{resetPending:!0,resetOptions:!0,resetSelections:!0,resetResolved:!0});function Ae(l){Array.isArray(z[l])||(z[l]=[]),Array.isArray(X[l])||(X[l]=[]),(!Y[l]||typeof Y[l]!="object")&&(Y[l]={}),(!j[l]||typeof j[l]!="object")&&(j[l]={}),Array.isArray(M[l])||(M[l]=[])}function He(l=[],{resetPending:e=!1,resetOptions:a=!1,resetSelections:s=!1,resetResolved:d=!1}={}){const c=new Set([...W,...Array.isArray(l)?l:[]]);G.value=Array.from(c),[z,X,Y].forEach(n=>{Object.keys(n).forEach(m=>{c.has(m)||delete n[m]})}),[j,M].forEach(n=>{Object.keys(n).forEach(m=>{c.has(m)||delete n[m]})}),G.value.forEach(n=>{Ae(n),e&&(z[n]=[]),a&&(X[n]=[]),s&&(Y[n]={}),d&&(j[n]={},M[n]=[])})}function ca(l){if(l&&hl[l])return hl[l];const e=typeof l=="string"?l:"";if(!e.trim())return"其他參照";const a=e.replace(/[_-]+/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").trim();return a.charAt(0).toUpperCase()+a.slice(1)}const ma=q(()=>{const l=new Map;return Ue.value.forEach(e=>{const a=e.category||"其他欄位";l.has(a)||l.set(a,[]),l.get(a).push(e)}),Array.from(l.entries()).map(([e,a])=>({title:e,fields:a}))}),pa=q(()=>Ue.value.filter(l=>l.required).map(l=>l.label||l.description||l.header)),fa=q(()=>sa.filter(l=>{const e=U.columnMappings[l];return typeof e!="string"||!e.trim()}));function va(l){return l==null?'""':`"${String(l).replace(/"/g,'""')}"`}function ya(){const l=Ue.value.map(c=>c.header||c.key),e=Ue.value.map(c=>c.displayDescription||c.description||c.label||c.header||c.key),a=ia.map(c=>l.map(p=>c[p]??""));return`\uFEFF${[l,e,...a].map(c=>c.map(va).join(",")).join(`
`)}`}function ga(){if(typeof window>"u"||typeof document>"u")return;const l=ya(),e=new Blob([l],{type:"text/csv;charset=utf-8;"}),a=window.URL&&typeof window.URL.createObjectURL=="function"&&window.URL||(typeof URL<"u"&&typeof URL.createObjectURL=="function"?URL:null);if(!a){O.warning("無法產生範本下載，請改用手動建立檔案");return}const s=a.createObjectURL(e),d=document.createElement("a");d.href=s,d.setAttribute("download",tn),document.body.appendChild(d);try{d.click()}finally{document.body.removeChild(d),typeof a.revokeObjectURL=="function"&&a.revokeObjectURL(s)}}const Vl=q(()=>!!H.value&&fa.value.length===0),ba=x(["護理師","照顧服務員","社工師","物理治療師","職能治療師","行政人員"]),ha=x(["護理師","社工師","物理治療師","職能治療師","醫師"]),_a=x(["中文","台語","客語","英語","馬來語"]),Va=x(["極重度","重度身心障礙","中度身心障礙","輕度身心障礙"]),wa=x(["原住民","新住民","榮民"]),Aa=x(["博士","碩士","大學","專科","高中職","國中以下"]),Sa=x(["畢業","肄業"]),La=x(["父","母","配偶","子","女","兄","姊","弟","妹","其他"]),ka=x(["院內","院外","線上","研討會","自學"]),Da=x(["本薪","全勤","加班費","交通津貼","伙食津貼","績效獎金"]),wl=[{key:"C03",ref:Te,fallback:ba,label:"職稱"},{key:"C04",ref:xe,fallback:ha,label:"執業職稱"},{key:"C05",ref:Fe,fallback:_a,label:"語言能力"},{key:"C06",ref:$e,fallback:Va,label:"身心障礙等級"},{key:"C07",ref:Ye,fallback:wa,label:"身分類別"},{key:"C08",ref:qe,fallback:Aa,label:"教育程度"},{key:"C08-1",ref:Ke,fallback:Sa,label:"畢業狀態"},{key:"C09",ref:Ge,fallback:La,label:"緊急聯絡人稱謂"},{key:"C10",ref:bl,fallback:ka,label:"教育訓練積分類別"},{key:"C14",ref:be,fallback:Da,label:"津貼項目"}],Ea=new Set(["C08-1"]);function We({notify:l=!0}={}){const e=[];return wl.forEach(({ref:a,fallback:s,label:d})=>{(!Array.isArray(a.value)||a.value.length===0)&&(a.value=Me(s),e.push(d))}),l&&e.length&&O.warning(`字典 ${e.join("、")} 尚未設定，已套用預設選項`),e}const Ia=["月薪","日薪","時薪"],Re=[{id:"R001",label:"填報",description:"提出申請與初始資料填寫"},{id:"R002",label:"覆核",description:"確認申請內容與佐證完整性"},{id:"R003",label:"審核",description:"評估申請是否符合政策與規範"},{id:"R004",label:"核定",description:"做出最終核准或駁回決策"},{id:"R005",label:"知會",description:"接收流程進度並保留紀錄"},{id:"R006",label:"財務覆核",description:"檢視成本預算與財務影響"},{id:"R007",label:"人資覆核",description:"確保人事政策與法規符合"}],Je=[{id:"U001",label:"L1",description:"單位承辦或第一層主管"},{id:"U002",label:"L2",description:"部門主管或組長"},{id:"U003",label:"L3",description:"處室主管或經理"},{id:"U004",label:"L4",description:"高階主管或副執行長"},{id:"U005",label:"L5",description:"執行長 / 院長 / 董事會"}],Ua=["資深","新人","外聘","志工"],Ta=["義務役","志願役","替代役","免役","尚未服役"],Al=["A","B","O","AB","HR"],Ra=new Date().getFullYear(),Ca=new Set(Re.map(l=>l.id)),Sl=new Map(Re.map(l=>[l.label,l.id]));["填報人員","覆核人員","審核人員","核定人員","知會人員","財務覆核人員","人資覆核人員"].forEach((l,e)=>{const a=Re[e];a&&Sl.set(l,a.id)});const Oa=new Set(Je.map(l=>l.id)),Na=new Map(Je.map(l=>[l.label,l.id])),Pa=new Set(gl.map(l=>l.level)),Ba=new Map([["一級","L1"],["二級","L2"],["三級","L3"],["四級","L4"],["五級","L5"],["一般職等","L1"],["資深職等","L2"],["主管職等","L3"]]);function Ll(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?Ca.has(e)?e:Sl.get(e)??e:""}return l}function kl(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?Oa.has(e)?e:Na.get(e)??e:""}return l}function Dl(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?Pa.has(e)?e:Ba.get(e)??e:""}return l}function za(l){return l?`${l.level}｜${l.description}`:""}function ja(l){return l?`${l.id}｜${l.label}`:""}const Qe=E("account"),le=E([]),ae=E([]),te=E([]),me=E([]),Se=E(!1),Ze=E(!1);let Ce=null,el="";function Ma(l){const e=ae.value.find(a=>a._id===l);return e?`${e.name}(${e.code})`:l}function xa(l={}){return(l==null?void 0:l._id)??(l==null?void 0:l.id)??(l==null?void 0:l.value)??(l==null?void 0:l.code)??(typeof l=="string"?l:"")}function Le(l){return l.status===401?(O.error("登入逾時，請重新登入"),ta.push("/manager/login"),!0):!1}function El(l){return new Promise((e,a)=>{const s=new FileReader;s.onload=()=>e(typeof s.result=="string"?s.result:""),s.onerror=()=>a(new Error("READ_ERROR")),s.readAsDataURL(l)})}function Il(l=[]){const e=l.slice(-1).map(a=>{var c;const s=a.response,d=typeof s=="object"&&s!==null&&"url"in s&&s.url||typeof s=="object"&&s!==null&&"data"in s&&((c=s.data)==null?void 0:c.url)||(typeof s=="string"?s:"");return{...a,url:a.url||d||"",status:"success",percentage:a.percentage??100}});r.value.photoList=e,r.value.photo=e.length&&e[0].url||""}async function Fa({file:l,onSuccess:e,onError:a}){Ze.value=!0;try{const s=await El(l);e==null||e({url:s})}catch(s){a==null||a(s),O.error("照片載入失敗，請重新選擇檔案")}finally{Ze.value=!1}}function $a(l,e,a){var s;e.url||(typeof l=="string"?e.url=l:l&&typeof l=="object"&&(e.url=l.url||((s=l==null?void 0:l.data)==null?void 0:s.url)||e.url||"")),Il(a)}function Ya(l,e){Il(e)}function qa(){O.warning("僅能上傳一張照片")}function Ka(l,e=""){return l?{name:e?`${e} 照片`:"員工照片",url:l,status:"success",percentage:100}:null}function ll(l=[]){return(Array.isArray(l)?l:[l]).map(e=>{var s;if(!e)return"";if(typeof e=="string")return e;if(e.url)return e.url;const a=e.response;if(typeof a=="string")return a;if(typeof a=="object"&&a!==null){if("url"in a&&a.url)return a.url;if("data"in a&&((s=a.data)!=null&&s.url))return a.data.url}return""}).filter(e=>typeof e=="string"&&e)}function Ga(l=[]){return ll(l)}function Ul(l=[],e="附件"){return(Array.isArray(l)?l:[l]).map((a,s)=>{var d;if(!a)return null;if(typeof a=="string")return{name:`${e}${s+1}`,url:a,status:"success",percentage:100,uid:`${e}-${s}`};if(typeof a=="object"){let c=a.url;if(!c){const f=a.response;typeof f=="string"?c=f:f&&typeof f=="object"&&(c=f.url||((d=f==null?void 0:f.data)==null?void 0:d.url)||"")}if(!c)return null;const p={...a,name:a.name||`${e}${s+1}`,url:c,status:"success",percentage:a.percentage??100};return p.uid||(p.uid=`${e}-${s}`),p}return null}).filter(a=>a&&typeof a.url=="string"&&a.url)}function Tl(l,e="附件"){if(!l)return[];const a=Array.isArray(l)?l:[l];return Ul(a,e)}function Oe(l){return Array.isArray(l)?l.filter(e=>e!==""&&e!==null&&e!==void 0):l===""||l===null||l===void 0?[]:[l]}function pe(l){return l===""||l===null||l===void 0?"":typeof l=="string"?l:String(l)}function Rl(){const l=Array.isArray(be.value)?be.value:[];return new Set(l.map(e=>{if(e&&typeof e=="object"){const a=e.value??e.code??e.name??e.label??(typeof e.toString=="function"?e.toString():"");return pe(a)}return pe(e)}).filter(Boolean))}function ke(l){const e=Rl();return Oe(l).map(pe).filter(a=>e.has(a))}function Ne(l=[],e=[]){return l.length!==e.length?!1:l.every((a,s)=>a===e[s])}function Xa(l,e){return l==="licenses"?`證照${e+1}-附件`:`教育訓練${e+1}-附件`}function Cl(l,e,a){const s=l==="licenses"?r.value.licenses:r.value.trainings;if(!Array.isArray(s)||!s[e])return;const d=Xa(l,e);s[e].fileList=Ul(a,d)}async function Ol({file:l,onSuccess:e,onError:a}){try{const s=await El(l);e==null||e({url:s})}catch(s){a==null||a(s),O.error("檔案載入失敗，請重新選擇")}}function Nl(l,e,a,s,d){var c;s.url||(typeof a=="string"?s.url=a:a&&typeof a=="object"&&(s.url=a.url||((c=a==null?void 0:a.data)==null?void 0:c.url)||s.url||"")),Cl(l,e,d)}function Pl(l,e,a,s){Cl(l,e,s)}function B(l){if(l===""||l===null||l===void 0)return null;const e=Number(l);return Number.isFinite(e)?e:null}function al(l){return l==null?"":String(l)}function fe(l){return l==null||l===""?"":l}function Ha(l=[]){return Array.isArray(l)?l.map((e={},a)=>({name:(e==null?void 0:e.name)??"",number:(e==null?void 0:e.number)??"",startDate:(e==null?void 0:e.startDate)??(e==null?void 0:e.issueDate)??"",endDate:(e==null?void 0:e.endDate)??(e==null?void 0:e.expiryDate)??"",fileList:Tl((e==null?void 0:e.fileList)??(e==null?void 0:e.files)??(e!=null&&e.file?[e.file]:[]),`證照${a+1}-附件`)})):[]}function Wa(l=[]){return Array.isArray(l)?l.map((e={},a)=>({course:(e==null?void 0:e.course)??(e==null?void 0:e.name)??"",courseNo:(e==null?void 0:e.courseNo)??(e==null?void 0:e.code)??"",date:(e==null?void 0:e.date)??"",category:ee((e==null?void 0:e.category)??(e==null?void 0:e.categories)),score:B(e==null?void 0:e.score),fileList:Tl((e==null?void 0:e.fileList)??(e==null?void 0:e.files)??(e!=null&&e.file?[e.file]:[]),`教育訓練${a+1}-附件`)})):[]}async function Ja(){try{const l=await re("/api/other-control-settings/item-settings");if(Le(l))return;if(!l.ok)throw new Error(`ITEM_SETTINGS_FETCH_FAILED_${l.status}`);const e=await l.json(),a=e!=null&&e.itemSettings&&typeof e.itemSettings=="object"?e.itemSettings:e&&typeof e=="object"&&!Array.isArray(e)?e:{},s=[];wl.forEach(({key:c,ref:p,fallback:f,label:n})=>{const m=a==null?void 0:a[c];(!Array.isArray(m)||!m.length)&&!Ea.has(c)&&s.push(n),p.value=oa(m,f)});const d=[...new Set(s)].filter(Boolean);d.length&&O.warning(`字典 ${d.join("、")} 尚未設定，已套用預設選項`)}catch(l){console.warn("載入字典項目失敗：",l),We()}}async function Bl(){const l=await re("/api/departments");Le(l)||l.ok&&(ae.value=await l.json())}async function tl(l=""){const e=l?`/api/sub-departments?department=${l}`:"/api/sub-departments",a=await re(e);Le(a)||a.ok&&(te.value=await a.json())}async function Qa(){const l=await re("/api/organizations");Le(l)||l.ok&&(me.value=await l.json())}async function ol(){const l=await re("/api/employees");if(!Le(l)&&l.ok){const e=await l.json();le.value=e.map(a=>{var d,c,p,f,n,m,b,v,y,V,I,w,T,P,Q;const s=(a==null?void 0:a.appointment)??{};return{...a,title:N(a==null?void 0:a.title),practiceTitle:N(a==null?void 0:a.practiceTitle),languages:ee(a==null?void 0:a.languages),disabilityLevel:N(a==null?void 0:a.disabilityLevel),identityCategory:ee(a==null?void 0:a.identityCategory),permissionGrade:Dl(a==null?void 0:a.permissionGrade),signRole:Ll(a==null?void 0:a.signRole),signLevel:kl(a==null?void 0:a.signLevel),organization:((d=a.organization)==null?void 0:d._id)||a.organization||"",department:((c=a.department)==null?void 0:c._id)||a.department||"",subDepartment:((p=a.subDepartment)==null?void 0:p._id)||a.subDepartment||"",laborPensionSelf:B(a==null?void 0:a.laborPensionSelf)??0,employeeAdvance:B(a==null?void 0:a.employeeAdvance)??0,salaryItems:ke(a==null?void 0:a.salaryItems),height:B(((f=a==null?void 0:a.medicalCheck)==null?void 0:f.height)??(a==null?void 0:a.height)),weight:B(((n=a==null?void 0:a.medicalCheck)==null?void 0:n.weight)??(a==null?void 0:a.weight)),medicalBloodType:((m=a==null?void 0:a.medicalCheck)==null?void 0:m.bloodType)??(a==null?void 0:a.medicalBloodType)??"",educationLevel:N(((b=a==null?void 0:a.education)==null?void 0:b.level)??(a==null?void 0:a.educationLevel)),schoolName:((v=a==null?void 0:a.education)==null?void 0:v.school)??(a==null?void 0:a.schoolName)??"",major:((y=a==null?void 0:a.education)==null?void 0:y.major)??(a==null?void 0:a.major)??"",graduationStatus:N(((V=a==null?void 0:a.education)==null?void 0:V.status)??(a==null?void 0:a.graduationStatus)),graduationYear:al(((I=a==null?void 0:a.education)==null?void 0:I.graduationYear)??(a==null?void 0:a.graduationYear)??""),serviceType:((w=a==null?void 0:a.militaryService)==null?void 0:w.serviceType)??(a==null?void 0:a.serviceType)??"",militaryBranch:((T=a==null?void 0:a.militaryService)==null?void 0:T.branch)??(a==null?void 0:a.militaryBranch)??"",militaryRank:((P=a==null?void 0:a.militaryService)==null?void 0:P.rank)??(a==null?void 0:a.militaryRank)??"",dischargeYear:B(((Q=a==null?void 0:a.militaryService)==null?void 0:Q.dischargeYear)??(a==null?void 0:a.dischargeYear)),hireDate:fe((s==null?void 0:s.hireDate)??(a==null?void 0:a.hireDate)),appointDate:fe((s==null?void 0:s.appointDate)??(s==null?void 0:s.startDate)??(a==null?void 0:a.appointDate)),resignDate:fe((s==null?void 0:s.resignationDate)??(a==null?void 0:a.resignDate)),dismissDate:fe((s==null?void 0:s.dismissalDate)??(a==null?void 0:a.dismissDate)),reAppointDate:fe((s==null?void 0:s.reAppointDate)??(s==null?void 0:s.rehireStartDate)??(a==null?void 0:a.reAppointDate)),reDismissDate:fe((s==null?void 0:s.reDismissDate)??(s==null?void 0:s.rehireEndDate)??(a==null?void 0:a.reDismissDate)),employmentNote:al((s==null?void 0:s.remark)??(a==null?void 0:a.employmentNote)??"")}})}}Tt(()=>{We({notify:!1}),Ja(),Bl(),ol(),Qa(),tl()});const rl={username:"",password:"",role:"employee",permissionGrade:"",signRole:"",signTags:[],signLevel:"",employeeNo:"",name:"",gender:"",birthday:"",idNumber:"",birthplace:"",bloodType:"",languages:[],disabilityLevel:"",identityCategory:[],maritalStatus:"",dependents:0,email:"",phone:"",landline:"",householdAddress:"",contactAddress:"",lineId:"",photo:"",photoList:[],organization:"",department:"",supervisor:null,subDepartment:"",title:"",practiceTitle:"",isPartTime:!1,isClocking:!1,employmentStatus:"",probationDays:"",height:null,weight:null,medicalBloodType:"",educationLevel:"",schoolName:"",major:"",graduationStatus:"",graduationYear:"",serviceType:"",militaryBranch:"",militaryRank:"",dischargeYear:null,emergency1:{name:"",relation:"",phone1:"",phone2:""},emergency2:{name:"",relation:"",phone1:"",phone2:""},keywords:"",experiences:[],licenses:[],trainings:[],hireDate:"",appointDate:"",resignDate:"",dismissDate:"",reAppointDate:"",reDismissDate:"",employmentNote:"",salaryType:"",salaryAmount:0,laborPensionSelf:0,employeeAdvance:0,salaryAccountA:{bank:"",acct:""},salaryAccountB:{bank:"",acct:""},salaryItems:[]},r=E({...rl}),zl=E(),jl=l=>({validator:(e,a)=>a===""||a===null||a===void 0?Promise.resolve():typeof a!="number"||!Number.isFinite(a)||a<0?Promise.reject(new Error(`請輸入正確的${l}`)):Promise.resolve(),trigger:["blur","change"]}),Za={username:[{required:!0,message:"請輸入登入帳號",trigger:"blur"}],password:[{required:!0,message:"請輸入登入密碼",trigger:"blur"}],role:[{required:!0,message:"請選擇系統權限",trigger:"change"}],organization:[{required:!0,message:"請選擇所屬機構",trigger:"change"}],department:[{required:!0,message:"請選擇所屬部門",trigger:"change"}],gender:[{required:!0,message:"請選擇性別",trigger:"change"}],name:[{required:!0,message:"請輸入員工姓名",trigger:"blur"}],email:[{required:!0,message:"請輸入有效 Email",type:"email",trigger:["blur","change"]}],laborPensionSelf:[jl("勞退自提")],employeeAdvance:[jl("員工預支")],salaryItems:[{validator:(l,e)=>{if(e===""||e===null||e===void 0)return Promise.resolve();if(!Array.isArray(e))return Promise.reject(new Error("請選擇有效的薪資項目"));const a=Rl();return Oe(e).map(pe).some(c=>!a.has(c))?Promise.reject(new Error("請選擇有效的薪資項目")):Promise.resolve()},trigger:"change"}]},et=q(()=>r.value.organization?ae.value.filter(l=>l.organization===r.value.organization):[]),lt=q(()=>r.value.department?te.value.filter(l=>l.department===r.value.department):[]),at=q(()=>r.value.organization&&r.value.department?le.value.filter(l=>l.role==="supervisor"&&l.organization===r.value.organization&&l.department===r.value.department):[]);De(he,l=>{l?_e.value=null:_e.value&&(nl(_e.value),_e.value=null)}),De(()=>r.value.department,async(l,e)=>{const a=r.value.subDepartment;if(!l){te.value=[],r.value.subDepartment&&(r.value.subDepartment="");return}if(await tl(l),r.value.department!==l)return;const s=r.value.subDepartment===a;!(!!a&&te.value.some(p=>xa(p)===a))&&l!==e&&s&&(r.value.subDepartment="")}),De(()=>r.value.salaryItems,l=>{const e=Oe(l),a=e.map(pe),s=ke(a);Ne(s,a)?Ne(a,e)||(r.value.salaryItems=a):r.value.salaryItems=s},{deep:!0}),De(()=>be.value,()=>{const l=Oe(r.value.salaryItems),e=l.map(pe),a=ke(e);Ne(a,e)?Ne(e,l)||(r.value.salaryItems=e):r.value.salaryItems=a},{deep:!0});function tt(){r.value.graduationStatus=""}function ot(){he.value=!0}async function Ml({resetMappings:l=!0,done:e}={}){if(_l.value)try{await ml.confirm("關閉後將清除目前的匯入檔案、預覽與對應設定，確定要離開？","確認關閉匯入",{type:"warning",confirmButtonText:"確認關閉",cancelButtonText:"繼續編輯"})}catch{return!1}return _e.value={resetMappings:l,resetReferenceData:!0,resetResolvedReferences:!0},typeof e=="function"?e():he.value=!1,!0}async function rt(){await Ml()}async function nt(l){await Ml({done:l})}function nl({resetMappings:l=!0,resetFile:e=!0,resetPreview:a=!0,resetErrors:s=!0,resetUploadList:d=!0,resetReferenceDialogs:c=!0,resetReferenceData:p=!0,resetResolvedReferences:f=l,resetOptions:n=l,referenceKeys:m}={}){if(Ve.value=!1,e&&(H.value=null),d&&(de.value=[]),a&&(se.value=[]),s&&(F.value=[]),c&&($.value=!1,we.value="",ce.value=!1),p){const b=Array.isArray(m)?m:l?W:G.value;He(b,{resetPending:!0,resetOptions:!0,resetSelections:!0,resetResolved:f})}l&&(Object.keys(U.columnMappings).forEach(b=>{b in ge||delete U.columnMappings[b]}),Object.entries(ge).forEach(([b,v])=>{U.columnMappings[b]=v})),n&&(U.options.defaultRole=Xe,U.options.resetPassword="",U.options.sendWelcomeEmail=!1)}function oe(l){return l==null?"":typeof l=="string"?l.trim().toLowerCase():String(l).trim().toLowerCase()}function xl(l=[]){const e=new Set,a=[];return l.forEach(s=>{const d=oe(s);!d||e.has(d)||(e.add(d),a.push(d))}),a}function st(){const l={},e={};return new Set([...G.value,...Object.keys(j),...Object.keys(M)]).forEach(s=>{Ae(s),l[s]={},Object.entries(j[s]||{}).forEach(([d,c])=>{typeof c=="string"&&c.trim()&&(l[s][d]=c)}),e[s]=xl(M[s])}),{valueMappingsPayload:l,ignorePayload:e}}function J(l){return l?l.normalizedValue?l.normalizedValue:oe(l.value):""}function it(l,e){if(!e||typeof e!="object")return"";if(l==="organization")return[e.name,e.unitName,e.orgCode,e.systemCode].filter(Boolean).join(" / ");if(l==="department"){const s=[e.name,e.code].filter(Boolean);return e.organization&&s.push(`所屬：${e.organization}`),s.join("｜")}if(l==="subDepartment"){const s=[e.name,e.code].filter(Boolean);return e.department&&s.push(`部門：${e.department}`),s.join("｜")}return[e.label,e.name,e.title,e.code,e.value,e.id].map(s=>s==null?"":String(s)).find(s=>s.trim())||""}function sl(l=""){return String(l).normalize("NFKC").replace(/^\uFEFF/,"").trim().toLowerCase()}function ut(l,e){const a=new Set;return e.forEach(s=>{const d=l==null?void 0:l[s];d!=null&&String(d).trim()!==""&&a.add(sl(d))}),a}function dt(l=[],e=["name","code","id","orgCode","unitName","systemCode"]){const a=new Map;return(l||[]).forEach(s=>{ut(s,e).forEach(d=>{d&&!a.has(d)&&a.set(d,s)})}),a}function ct(l){return l==="organization"?(me.value||[]).map(e=>({id:e._id??e.id??"",name:e.name??"",orgCode:e.orgCode??e.code??"",unitName:e.unitName??""})):l==="department"?(ae.value||[]).map(e=>({id:e._id??e.id??"",name:e.name??"",code:e.code??"",organization:e.organization??""})):l==="subDepartment"?(te.value||[]).map(e=>({id:e._id??e.id??"",name:e.name??"",code:e.code??"",department:e.department??""})):[]}function mt(l={}){const e=Object.keys(l||{}),a={};return e.forEach(s=>{const d=l[s]||{},c=Array.isArray(d.values)?d.values:[],p=Array.isArray(d.options)&&d.options.length?d.options:ct(s);let f=["id","code","name"];s==="organization"&&(f=["id","orgCode","name","unitName","systemCode"]);const n=dt(p,f);c.forEach(m=>{const b=(m==null?void 0:m.value)??"",v=(m==null?void 0:m.normalizedValue)||sl(b);if(!v)return;const y=n.get(v)||n.get(sl(String(b)));y!=null&&y.id?(Ae(s),j[s]||(j[s]={}),j[s][v]=String(y.id),M[s]=(M[s]||[]).filter(V=>V!==v)):(a[s]||(a[s]={values:[],options:p}),a[s].values.push(m))}),a[s]&&a[s].values.length===0&&delete a[s]}),{unresolved:a,keysUsed:e}}function pt(l={}){const e={},a=new Set(W);function s(d={}){const p=(Array.isArray(d==null?void 0:d.values)?d.values:Array.isArray(d)?d:[]).map(m=>{if(m&&typeof m=="object"){const v=m.value??m.name??m.label??m.code??m.id??m,y=Array.isArray(m.rows)?m.rows:[],V=oe(v);return{...m,value:v,rows:y,normalizedValue:V}}const b=m??"";return{value:b,rows:[],normalizedValue:oe(b)}}).filter(m=>m.value!=null&&String(m.value).trim()!==""),n=(Array.isArray(d==null?void 0:d.options)?d.options:[]).map((m,b)=>{if(m&&typeof m=="object"){const V=m._id??m.id??m.value??m.code??m.key??m.name??m.label??"",I=String(V||`option-${b}`);return{...m,id:I}}const v=m==null?"":String(m);return{id:v.trim()?v:`option-${b}`,label:v,name:v}});return{values:p,options:n}}return Object.entries(l||{}).forEach(([d,c])=>{if(d==null)return;const p=String(d).trim();if(!p)return;const f=da[p.toLowerCase()]||p;a.add(f),e[f]=s(c)}),a.forEach(d=>{e[d]||(e[d]={values:[],options:[]})}),{normalized:e,keys:Array.from(a)}}function ft(l=[]){const e=new Set((me.value||[]).map(m=>(m._id??m.id??m.name??m).toString().trim().toLowerCase())),a=new Set((ae.value||[]).map(m=>(m.code??m._id??m.id??m.name??m).toString().trim().toLowerCase())),s=new Set((te.value||[]).map(m=>(m.code??m._id??m.id??m.name??m).toString().trim().toLowerCase())),d={organization:new Map,department:new Map,subDepartment:new Map};l.forEach((m,b)=>{const v=b+3,y=m.organization??"",V=m.department??"",I=m.subDepartment??"";if(y){const w=oe(y);w&&!e.has(w)&&(d.organization.has(w)||d.organization.set(w,{value:y,rows:new Set}),d.organization.get(w).rows.add(v))}if(V){const w=oe(V);w&&!a.has(w)&&(d.department.has(w)||d.department.set(w,{value:V,rows:new Set}),d.department.get(w).rows.add(v))}if(I){const w=oe(I);w&&!s.has(w)&&(d.subDepartment.has(w)||d.subDepartment.set(w,{value:I,rows:new Set}),d.subDepartment.get(w).rows.add(v))}});const c=m=>Array.from(m.values()).map(b=>({value:b.value,rows:Array.from(b.rows),normalizedValue:oe(b.value)})),p=(me.value||[]).map(m=>({id:m._id??m.id??"",name:m.name??"",orgCode:m.orgCode??m.code??"",unitName:m.unitName??""})),f=(ae.value||[]).map(m=>({id:m._id??m.id??"",name:m.name??"",code:m.code??"",organization:m.organization??""})),n=(te.value||[]).map(m=>({id:m._id??m.id??"",name:m.name??"",code:m.code??"",department:m.department??""}));return{organization:{values:c(d.organization),options:p},department:{values:c(d.department),options:f},subDepartment:{values:c(d.subDepartment),options:n}}}function ve(l,e){return Ae(l),Y[l][e]||(Y[l][e]={mode:"map",targetId:""}),Y[l][e]}function vt(l={},e="",a=[]){we.value=e||"部分欄位需要對應既有的組織/部門資料",ce.value=!1;const s=(Array.isArray(a)&&a.length?a:Object.keys(l||{})).filter(p=>typeof p=="string"&&p.trim()!==""),d=s.length?s:[...W];He(d,{resetPending:!0,resetOptions:!0,resetSelections:!0});const c={organization:(me.value||[]).map(p=>({id:p._id??p.id??"",name:p.name??"",orgCode:p.orgCode??p.code??"",unitName:p.unitName??""})),department:(ae.value||[]).map(p=>({id:p._id??p.id??"",name:p.name??"",code:p.code??"",organization:p.organization??""})),subDepartment:(te.value||[]).map(p=>({id:p._id??p.id??"",name:p.name??"",code:p.code??"",department:p.department??""}))};G.value.forEach(p=>{const f=l&&typeof l=="object"?l[p]:void 0,n=Array.isArray(f==null?void 0:f.values)?f.values:[],m=Array.isArray(f==null?void 0:f.options)?f.options:[],b=m.length?m:c[p]||[];Ae(p),z[p]=n.map(v=>({...v})),X[p]=b.map(v=>({...v})),Y[p]={},n.forEach(v=>{var T,P;const y=J(v),V=ve(p,y),I=((T=j[p])==null?void 0:T[y])||"";((P=M[p])==null?void 0:P.includes(y))?(V.mode="ignore",V.targetId=""):I?(V.mode="map",V.targetId=I):(V.mode="map",V.targetId="")})}),$.value=!0}De($,l=>{l&&console.log("[ref-mapping] dialog opened; sections snapshot =",(G.value||[]).map(e=>{var a,s;return{k:e,values:((a=z[e])==null?void 0:a.length)||0,options:((s=X[e])==null?void 0:s.length)||0}}))});async function il({triggeredByMapping:l=!1}={}){if(!H.value){const e=l?"原始檔案已重置，請重新選擇匯入檔案後再試":"請先選擇要匯入的檔案";O.warning(e);return}if(!Vl.value){O.warning("請確認必要欄位對應是否完整");return}Ve.value=!0;try{const e=new FormData;e.append("file",H.value),e.append("mappings",JSON.stringify(U.columnMappings)),e.append("options",JSON.stringify(U.options));const{valueMappingsPayload:a,ignorePayload:s}=st();e.append("valueMappings",JSON.stringify(a)),e.append("ignore",JSON.stringify(s));const d=await Ot(e);let c={};try{c=await d.json()}catch{c={}}if(d.status===409){const{normalized:f,keys:n}=pt((c==null?void 0:c.missingReferences)||{});let m=f,b=n.length?n:[...W];if(b.every(T=>{var P,Q;return!((Q=(P=m[T])==null?void 0:P.values)!=null&&Q.length)}))try{const P=(await vl(H.value)).map(Q=>yl(Q,U.columnMappings));m=ft(P),b=Array.from(new Set([...b,...Object.keys(m||{})]))}catch(T){console.warn("client-side missing refs build failed:",T)}const{unresolved:y,keysUsed:V}=mt(m),I=V&&V.length?V:b,w=Object.values(y).some(T=>{var P;return(((P=T==null?void 0:T.values)==null?void 0:P.length)||0)>0});F.value=Array.isArray(c==null?void 0:c.errors)?c.errors:[],w?(vt(y,c==null?void 0:c.message,I),O.warning((c==null?void 0:c.message)||"匯入資料存在未對應的組織或部門資訊，請完成對應後重新提交")):await il({triggeredByMapping:!0});return}if(!d.ok){F.value=Array.isArray(c==null?void 0:c.errors)?c.errors:[];const f=(c==null?void 0:c.message)||(c==null?void 0:c.error)||"批量匯入失敗，請稍後再試";throw new Error(f)}const p=Array.isArray(c==null?void 0:c.preview)?c.preview:null;Array.isArray(p)&&p.length&&(se.value=p),F.value=Array.isArray(c==null?void 0:c.errors)?c.errors:[],F.value.length?O.warning("匯入完成，但有部分資料需要檢查"):O.success("匯入成功"),await ol(),F.value.length||($.value=!1,we.value="")}catch(e){const a=(e==null?void 0:e.message)||"批量匯入失敗，請稍後再試";O.error(a)}finally{Ve.value=!1}}async function yt(){if(!H.value){O.warning("原始檔案已重置，請重新選擇匯入檔案後再試"),$.value=!1;return}const l=Array.from(new Set([...G.value,...Object.keys(z)])),e=[];if(l.forEach(a=>{z[a].forEach(s=>{const d=J(s),c=Y[a][d];(!c||c.mode==="map"&&!c.targetId)&&e.push(s.value||d)})}),e.length){O.warning("請為所有未對應的項目選擇既有資料或設定忽略");return}l.forEach(a=>{z[a].forEach(s=>{const d=J(s),c=Y[a][d];c&&(c.mode==="ignore"?(delete j[a][d],M[a]=xl([...M[a],d])):c.mode==="map"&&c.targetId&&(j[a][d]=c.targetId,M[a]=M[a].filter(p=>p!==d)))})}),ce.value=!0;try{await il({triggeredByMapping:!0})}finally{ce.value=!1}}async function Fl(l=null){var e,a,s,d,c;if(We(),l!==null){Ce=l;const p=le.value[l];el=p._id||"",r.value={...structuredClone(rl),...p,password:"",photoList:[]},r.value.title=N(r.value.title),r.value.practiceTitle=N(r.value.practiceTitle),r.value.languages=ee(r.value.languages),r.value.disabilityLevel=N(r.value.disabilityLevel),r.value.permissionGrade=Dl(r.value.permissionGrade),r.value.signRole=Ll(r.value.signRole),r.value.signLevel=kl(r.value.signLevel),r.value.photo=r.value.photo||"";const f=Ka(r.value.photo,r.value.name);r.value.photoList=f?[f]:[],r.value.licenses=Ha(p.licenses??[]),r.value.trainings=Wa(p.trainings??[]),r.value.laborPensionSelf=B(r.value.laborPensionSelf)??0,r.value.employeeAdvance=B(r.value.employeeAdvance)??0,r.value.salaryItems=ke(r.value.salaryItems);const n=p.education??{};!r.value.educationLevel&&n.level&&(r.value.educationLevel=n.level),!r.value.schoolName&&n.school&&(r.value.schoolName=n.school),!r.value.major&&n.major&&(r.value.major=n.major),!r.value.graduationStatus&&n.status&&(r.value.graduationStatus=n.status),r.value.graduationYear=al(r.value.graduationYear||n.graduationYear||""),r.value.identityCategory=ee(r.value.identityCategory),r.value.height=B(p.height??((e=p.medicalCheck)==null?void 0:e.height)),r.value.weight=B(p.weight??((a=p.medicalCheck)==null?void 0:a.weight)),r.value.medicalBloodType=p.medicalBloodType??((s=p.medicalCheck)==null?void 0:s.bloodType)??"";const m=p.militaryService??{};r.value.serviceType=r.value.serviceType||m.serviceType||"",r.value.militaryBranch=r.value.militaryBranch||m.branch||"",r.value.militaryRank=r.value.militaryRank||m.rank||"";const b=r.value.dischargeYear===""||r.value.dischargeYear===null||r.value.dischargeYear===void 0?m.dischargeYear:r.value.dischargeYear;r.value.dischargeYear=B(b),r.value.department=((d=p.department)==null?void 0:d._id)||p.department||"",r.value.subDepartment=((c=p.subDepartment)==null?void 0:c._id)||p.subDepartment||"",r.value.educationLevel=N(r.value.educationLevel),r.value.graduationStatus=N(r.value.graduationStatus)}else Ce=null,el="",Qe.value="account",r.value={...structuredClone(rl)},r.value.licenses=[],r.value.trainings=[];if(await Bl(),r.value.department&&!/^[0-9a-fA-F]{24}$/.test(r.value.department)){const p=ae.value.find(f=>f.name===r.value.department);p&&(r.value.department=p._id)}await tl(r.value.department),Se.value=!0}async function gt(){var f;let l;try{await((f=zl.value)==null?void 0:f.validate())}catch(n){l=n}if(l){const n=Object.values(l).flat().map(m=>m.message.replace(/^請(?:輸入|選擇)(?:有效)?\s*/,""));ml.alert(`請補齊：${n.join("、")}`);return}const e=r.value,a={...e};a.title=N(e.title),a.practiceTitle=N(e.practiceTitle);const s=Ga(e.photoList);s.length?(a.photoList=s,a.photo=s[0]):Ce!==null?(a.photoList=[],a.photo=""):(delete a.photoList,e.photo||delete a.photo),a.languages=ee(e.languages),a.identityCategory=ee(e.identityCategory),a.disabilityLevel=N(e.disabilityLevel),a.educationLevel=N(e.educationLevel),a.graduationStatus=N(e.graduationStatus),a.laborPensionSelf=B(e.laborPensionSelf)??0,a.employeeAdvance=B(e.employeeAdvance)??0,a.salaryItems=ke(e.salaryItems),a.dischargeYear=B(e.dischargeYear),(a.supervisor===""||a.supervisor===null)&&delete a.supervisor;const d=(Array.isArray(e.licenses)?e.licenses:[]).map(n=>{const m=ll((n==null?void 0:n.fileList)??[]),b=typeof(n==null?void 0:n.name)=="string"?n.name.trim():(n==null?void 0:n.name)??"",v=typeof(n==null?void 0:n.number)=="string"?n.number.trim():(n==null?void 0:n.number)??"",y=(n==null?void 0:n.startDate)||"",V=(n==null?void 0:n.endDate)||"";return{name:b,number:v,startDate:y,endDate:V,fileList:m}}).filter(n=>n.name||n.number||n.startDate||n.endDate||Array.isArray(n.fileList)&&n.fileList.length);a.licenses=d;const c=(Array.isArray(e.trainings)?e.trainings:[]).map(n=>{const m=ll((n==null?void 0:n.fileList)??[]),b=ee((n==null?void 0:n.category)??(n==null?void 0:n.categories)),v=typeof(n==null?void 0:n.course)=="string"?n.course.trim():(n==null?void 0:n.course)??"",y=typeof(n==null?void 0:n.courseNo)=="string"?n.courseNo.trim():(n==null?void 0:n.courseNo)??"",V=(n==null?void 0:n.date)||"",I=B(n==null?void 0:n.score),w={course:v,courseNo:y,date:V,category:b,fileList:m};return I!==null&&(w.score=I),w}).filter(n=>n.course||n.courseNo||n.date||Array.isArray(n.category)&&n.category.length||Array.isArray(n.fileList)&&n.fileList.length||n.score!==void 0);a.trainings=c;let p;Ce===null?p=await re("/api/employees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}):p=await re(`/api/employees/${el}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),p&&p.ok?(await ol(),Se.value=!1,O.success("儲存成功")):O.error("儲存失敗")}async function bt(l){const e=le.value[l];(await re(`/api/employees/${e._id}`,{method:"DELETE"})).ok&&le.value.splice(l,1)}function ht(){r.value.experiences.push({unit:"",title:"",start:"",end:""})}function _t(l){r.value.experiences.splice(l,1)}function Vt(){r.value.licenses.push({name:"",number:"",startDate:"",endDate:"",fileList:[]})}function wt(l){r.value.licenses.splice(l,1)}function At(){r.value.trainings.push({course:"",courseNo:"",date:"",fileList:[],category:[],score:null})}function St(l){r.value.trainings.splice(l,1)}const Lt=q(()=>le.value.filter(l=>l.employmentStatus==="正職員工"||l.employmentStatus==="試用期員工").length);function kt(l){return{admin:"danger",supervisor:"warning",employee:"success"}[l]||"info"}function Dt(l){return{admin:"管理員",supervisor:"主管",employee:"員工"}[l]||l}function Et(l){return{admin:"",supervisor:"",employee:""}[l]||""}function It(l){return{正職員工:"success",試用期員工:"warning",離職員工:"danger",留職停薪:"info"}[l]||"default"}return(l,e)=>{const a=C("el-button"),s=C("el-avatar"),d=C("el-table-column"),c=C("el-tag"),p=C("el-table"),f=C("el-input"),n=C("el-form-item"),m=C("el-radio"),b=C("el-radio-group"),v=C("el-option"),y=C("el-select"),V=C("el-tab-pane"),I=C("el-upload"),w=C("el-date-picker"),T=C("el-input-number"),P=C("el-switch"),Q=C("el-tabs"),ql=C("el-form"),ul=C("el-dialog"),dl=C("el-alert");return g(),R(V,{label:"員工管理",name:"employeeMgmt"},{default:u(()=>[i("div",Nt,[i("div",Pt,[e[84]||(e[84]=i("div",{class:"header-content"},[i("h1",{class:"page-title"},"員工管理系統"),i("p",{class:"page-description"},"管理員工資料、權限設定、部門分配和薪資配置")],-1)),i("div",Bt,[i("div",zt,[i("div",jt,k(le.value.length),1),e[82]||(e[82]=i("div",{class:"stat-label"},"總員工數",-1))]),i("div",Mt,[i("div",xt,k(Lt.value),1),e[83]||(e[83]=i("div",{class:"stat-label"},"在職員工",-1))])])]),i("div",Ft,[e[87]||(e[87]=i("h2",{class:"section-title"},"員工列表",-1)),i("div",$t,[o(a,{type:"primary",onClick:e[0]||(e[0]=t=>Fl()),class:"add-btn"},{default:u(()=>e[85]||(e[85]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增員工 ")])),_:1}),o(a,{type:"success",plain:"",class:"import-btn","data-test":"bulk-import-button",onClick:ot},{default:u(()=>e[86]||(e[86]=[i("i",{class:"el-icon-upload2"},null,-1),D(" 批量匯入 ")])),_:1})])]),i("div",Yt,[o(p,{data:le.value,class:"employee-table","header-cell-style":{background:"#f8fafc",color:"#475569",fontWeight:"600"},"row-style":{height:"64px"}},{default:u(()=>[o(d,{prop:"name",label:"員工資訊","min-width":"200"},{default:u(({row:t})=>[i("div",qt,[o(s,{size:40,class:"employee-avatar"},{default:u(()=>[D(k(t.name?t.name.charAt(0):"N"),1)]),_:2},1024),i("div",Kt,[i("div",Gt,k(t.name||"未設定"),1),i("div",Xt,k(t.employeeNo||"無編號"),1)])])]),_:1}),o(d,{label:"部門",width:"180"},{default:u(({row:t})=>[i("div",Ht,[e[88]||(e[88]=i("i",{class:"el-icon-s-grid dept-icon"},null,-1)),i("span",null,k(Ma(t.department)),1)])]),_:1}),o(d,{prop:"title",label:"職稱",width:"150"},{default:u(({row:t})=>[t.title?(g(),R(c,{key:0,type:"info",class:"title-tag"},{default:u(()=>[D(k(ra(Te.value,t.title)),1)]),_:2},1024)):(g(),_("span",Wt,"未設定"))]),_:1}),o(d,{prop:"role",label:"系統權限",width:"120"},{default:u(({row:t})=>[o(c,{type:kt(t.role),class:"role-tag"},{default:u(()=>[D(k(Dt(t.role)),1)]),_:2},1032,["type"])]),_:1}),o(d,{prop:"employmentStatus",label:"在職狀態",width:"130"},{default:u(({row:t})=>[o(c,{type:It(t.employmentStatus),class:"status-tag"},{default:u(()=>[D(k(t.employmentStatus||"未設定"),1)]),_:2},1032,["type"])]),_:1}),o(d,{label:"聯絡方式",width:"200"},{default:u(({row:t})=>[i("div",Jt,[t.email?(g(),_("div",Qt,[e[89]||(e[89]=i("i",{class:"el-icon-message"},null,-1)),i("span",null,k(t.email),1)])):K("",!0),t.phone?(g(),_("div",Zt,[e[90]||(e[90]=i("i",{class:"el-icon-phone"},null,-1)),i("span",null,k(t.phone),1)])):K("",!0),!t.email&&!t.phone?(g(),_("div",eo," 無聯絡資訊 ")):K("",!0)])]),_:1}),o(d,{label:"操作",width:"200",fixed:"right"},{default:u(({row:t,$index:A})=>[i("div",lo,[o(a,{type:"primary",size:"small",onClick:h=>Fl(A),class:"edit-btn"},{default:u(()=>e[91]||(e[91]=[i("i",{class:"el-icon-edit"},null,-1),D(" 編輯 ")])),_:2},1032,["onClick"]),o(a,{type:"danger",size:"small",onClick:h=>bt(A),class:"delete-btn"},{default:u(()=>e[92]||(e[92]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),o(ul,{modelValue:Se.value,"onUpdate:modelValue":e[75]||(e[75]=t=>Se.value=t),title:"員工資料管理",width:"1200px",class:"employee-dialog","close-on-click-modal":!1},{footer:u(()=>[i("div",Mr,[o(a,{onClick:e[74]||(e[74]=t=>Se.value=!1),class:"cancel-btn"},{default:u(()=>e[131]||(e[131]=[D("取消")])),_:1}),o(a,{type:"primary",onClick:gt,class:"save-btn"},{default:u(()=>e[132]||(e[132]=[i("i",{class:"el-icon-check"},null,-1),D(" 儲存員工資料 ")])),_:1})])]),default:u(()=>[o(ql,{ref_key:"formRef",ref:zl,model:r.value,rules:Za,"label-width":"140px",class:"employee-form"},{default:u(()=>[o(Q,{modelValue:Qe.value,"onUpdate:modelValue":e[73]||(e[73]=t=>Qe.value=t),type:"border-card",class:"employee-tabs"},{default:u(()=>[o(V,{name:"account"},{label:u(()=>e[93]||(e[93]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-user"}),i("span",null,"帳號權限")],-1)])),default:u(()=>[i("div",ao,[i("div",to,[i("div",oo,[e[94]||(e[94]=i("h3",{class:"form-group-title"},"登入資訊",-1)),o(n,{label:"登入帳號",required:"",prop:"username"},{default:u(()=>[o(f,{modelValue:r.value.username,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.username=t),placeholder:"請輸入登入帳號"},null,8,["modelValue"])]),_:1}),o(n,{label:"登入密碼",required:"",prop:"password"},{default:u(()=>[o(f,{modelValue:r.value.password,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.password=t),type:"password",placeholder:"請輸入密碼","show-password":""},null,8,["modelValue"])]),_:1})]),i("div",ro,[e[95]||(e[95]=i("h3",{class:"form-group-title"},"權限設定",-1)),o(n,{label:"系統權限",required:"",prop:"role"},{default:u(()=>[o(b,{modelValue:r.value.role,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.role=t),class:"role-radio-group"},{default:u(()=>[(g(),_(S,null,L(Ie,t=>o(m,{key:t.value,label:t.value,class:"role-radio"},{default:u(()=>[i("div",no,[i("div",so,k(t.label),1),i("div",io,k(Et(t.value)),1)])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"權限職等"},{default:u(()=>[o(y,{modelValue:r.value.permissionGrade,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.permissionGrade=t),placeholder:"選擇職等",class:"code-select"},{default:u(()=>[(g(),_(S,null,L(gl,t=>o(v,{key:t.level,label:za(t),value:t.level},{default:u(()=>[i("div",uo,[i("div",co,k(t.level)+"｜"+k(t.description),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}),o(V,{name:"approval"},{label:u(()=>e[96]||(e[96]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-document-checked"}),i("span",null,"簽核設定")],-1)])),default:u(()=>[i("div",mo,[i("div",po,[i("div",fo,[e[97]||(e[97]=i("h3",{class:"form-group-title"},"簽核權限",-1)),o(n,{label:"簽核角色"},{default:u(()=>[o(b,{modelValue:r.value.signRole,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.signRole=t),class:"sign-role-group"},{default:u(()=>[(g(),_(S,null,L(Re,t=>o(m,{key:t.id,label:t.id,class:"sign-role-radio"},{default:u(()=>[i("div",vo,[i("div",yo,k(t.id)+"｜"+k(t.label),1),i("div",go,k(t.description),1)])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"簽核層級"},{default:u(()=>[o(y,{modelValue:r.value.signLevel,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.signLevel=t),placeholder:"選擇層級",class:"code-select"},{default:u(()=>[(g(),_(S,null,L(Je,t=>o(v,{key:t.id,label:ja(t),value:t.id},{default:u(()=>[i("div",bo,[i("div",ho,k(t.id)+"｜"+k(t.label),1),i("div",_o,k(t.description),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"員工標籤"},{default:u(()=>[o(y,{modelValue:r.value.signTags,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.signTags=t),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"選擇或新增標籤",class:"tag-select"},{default:u(()=>[(g(),_(S,null,L(Ua,t=>o(v,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}),o(V,{name:"personal"},{label:u(()=>e[98]||(e[98]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-user-solid"}),i("span",null,"個人資訊")],-1)])),default:u(()=>[i("div",Vo,[i("div",wo,[i("div",Ao,[e[100]||(e[100]=i("h3",{class:"form-group-title"},"基本資料",-1)),o(n,{label:"個人照片",class:"photo-upload-item"},{default:u(()=>[o(I,{class:"employee-photo-upload","file-list":r.value.photoList,"onUpdate:fileList":e[8]||(e[8]=t=>r.value.photoList=t),"http-request":Fa,"on-success":$a,"on-remove":Ya,"on-exceed":qa,"list-type":"picture-card",limit:1,accept:"image/*",disabled:Ze.value},{default:u(()=>e[99]||(e[99]=[i("div",{class:"upload-placeholder"},[i("i",{class:"el-icon-plus"}),i("span",null,"上傳照片")],-1)])),_:1},8,["file-list","disabled"])]),_:1}),i("div",So,[o(n,{label:"員工編號"},{default:u(()=>[o(f,{modelValue:r.value.employeeNo,"onUpdate:modelValue":e[9]||(e[9]=t=>r.value.employeeNo=t),placeholder:"請輸入員工編號"},null,8,["modelValue"])]),_:1}),o(n,{label:"員工姓名",required:"",prop:"name"},{default:u(()=>[o(f,{modelValue:r.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>r.value.name=t),placeholder:"請輸入員工姓名"},null,8,["modelValue"])]),_:1})]),i("div",Lo,[o(n,{label:"性別",required:"",prop:"gender"},{default:u(()=>[o(y,{modelValue:r.value.gender,"onUpdate:modelValue":e[11]||(e[11]=t=>r.value.gender=t),placeholder:"選擇性別"},{default:u(()=>[o(v,{label:"男",value:"M"}),o(v,{label:"女",value:"F"})]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"生日"},{default:u(()=>[o(w,{modelValue:r.value.birthday,"onUpdate:modelValue":e[12]||(e[12]=t=>r.value.birthday=t),type:"date",placeholder:"選擇生日"},null,8,["modelValue"])]),_:1})]),i("div",ko,[o(n,{label:"身分證號"},{default:u(()=>[o(f,{modelValue:r.value.idNumber,"onUpdate:modelValue":e[13]||(e[13]=t=>r.value.idNumber=t),placeholder:"請輸入身分證號"},null,8,["modelValue"])]),_:1}),o(n,{label:"出生地"},{default:u(()=>[o(f,{modelValue:r.value.birthplace,"onUpdate:modelValue":e[14]||(e[14]=t=>r.value.birthplace=t),placeholder:"請輸入出生地"},null,8,["modelValue"])]),_:1})]),i("div",Do,[o(n,{label:"血型"},{default:u(()=>[o(y,{modelValue:r.value.bloodType,"onUpdate:modelValue":e[15]||(e[15]=t=>r.value.bloodType=t),placeholder:"選擇血型"},{default:u(()=>[(g(),_(S,null,L(Al,t=>o(v,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"婚姻狀態"},{default:u(()=>[o(y,{modelValue:r.value.maritalStatus,"onUpdate:modelValue":e[16]||(e[16]=t=>r.value.maritalStatus=t),placeholder:"選擇婚姻狀態"},{default:u(()=>[o(v,{label:"未婚",value:"未婚"}),o(v,{label:"已婚",value:"已婚"}),o(v,{label:"離婚",value:"離婚"}),o(v,{label:"喪偶",value:"喪偶"})]),_:1},8,["modelValue"])]),_:1})]),o(n,{label:"語言能力"},{default:u(()=>[o(y,{modelValue:r.value.languages,"onUpdate:modelValue":e[17]||(e[17]=t=>r.value.languages=t),multiple:"",filterable:"",placeholder:"選擇語言",disabled:!Fe.value.length},{default:u(()=>[(g(!0),_(S,null,L(Fe.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),i("div",Eo,[o(n,{label:"身心障礙等級"},{default:u(()=>[o(y,{modelValue:r.value.disabilityLevel,"onUpdate:modelValue":e[18]||(e[18]=t=>r.value.disabilityLevel=t),placeholder:"選擇等級",clearable:"",disabled:!$e.value.length},{default:u(()=>[(g(!0),_(S,null,L($e.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(n,{label:"身分註記"},{default:u(()=>[o(y,{modelValue:r.value.identityCategory,"onUpdate:modelValue":e[19]||(e[19]=t=>r.value.identityCategory=t),multiple:"",filterable:"","collapse-tags":"",placeholder:"選擇身份別",disabled:!Ye.value.length},{default:u(()=>[(g(!0),_(S,null,L(Ye.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),o(n,{label:"扶養人數"},{default:u(()=>[o(T,{modelValue:r.value.dependents,"onUpdate:modelValue":e[20]||(e[20]=t=>r.value.dependents=t),min:0},null,8,["modelValue"])]),_:1})]),i("div",Io,[e[101]||(e[101]=i("h3",{class:"form-group-title"},"聯絡資訊",-1)),i("div",Uo,[o(n,{label:"Email",required:"",prop:"email"},{default:u(()=>[o(f,{modelValue:r.value.email,"onUpdate:modelValue":e[21]||(e[21]=t=>r.value.email=t),placeholder:"請輸入Email"},null,8,["modelValue"])]),_:1}),o(n,{label:"行動電話"},{default:u(()=>[o(f,{modelValue:r.value.phone,"onUpdate:modelValue":e[22]||(e[22]=t=>r.value.phone=t),placeholder:"請輸入行動電話"},null,8,["modelValue"])]),_:1})]),i("div",To,[o(n,{label:"市內電話"},{default:u(()=>[o(f,{modelValue:r.value.landline,"onUpdate:modelValue":e[23]||(e[23]=t=>r.value.landline=t),placeholder:"請輸入市內電話"},null,8,["modelValue"])]),_:1}),o(n,{label:"LINE ID"},{default:u(()=>[o(f,{modelValue:r.value.lineId,"onUpdate:modelValue":e[24]||(e[24]=t=>r.value.lineId=t),placeholder:"請輸入LINE ID"},null,8,["modelValue"])]),_:1})]),o(n,{label:"戶籍地址"},{default:u(()=>[o(f,{modelValue:r.value.householdAddress,"onUpdate:modelValue":e[25]||(e[25]=t=>r.value.householdAddress=t),placeholder:"請輸入戶籍地址"},null,8,["modelValue"])]),_:1}),o(n,{label:"聯絡地址"},{default:u(()=>[o(f,{modelValue:r.value.contactAddress,"onUpdate:modelValue":e[26]||(e[26]=t=>r.value.contactAddress=t),placeholder:"請輸入聯絡地址"},null,8,["modelValue"])]),_:1})])])])]),_:1}),o(V,{name:"employment"},{label:u(()=>e[102]||(e[102]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-office-building"}),i("span",null,"任職資訊")],-1)])),default:u(()=>[i("div",Ro,[i("div",Co,[i("div",Oo,[e[103]||(e[103]=i("h3",{class:"form-group-title"},"組織架構",-1)),i("div",No,[o(n,{label:"所屬機構",required:"",prop:"organization"},{default:u(()=>[o(y,{modelValue:r.value.organization,"onUpdate:modelValue":e[27]||(e[27]=t=>r.value.organization=t),placeholder:"選擇機構"},{default:u(()=>[(g(!0),_(S,null,L(me.value,t=>(g(),R(v,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"所屬部門",required:"",prop:"department"},{default:u(()=>[o(y,{modelValue:r.value.department,"onUpdate:modelValue":e[28]||(e[28]=t=>r.value.department=t),placeholder:"選擇部門"},{default:u(()=>[(g(!0),_(S,null,L(et.value,t=>(g(),R(v,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",Po,[o(n,{label:"小單位"},{default:u(()=>[o(y,{modelValue:r.value.subDepartment,"onUpdate:modelValue":e[29]||(e[29]=t=>r.value.subDepartment=t),placeholder:"選擇小單位"},{default:u(()=>[(g(!0),_(S,null,L(lt.value,t=>(g(),R(v,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"直屬主管"},{default:u(()=>[o(y,{modelValue:r.value.supervisor,"onUpdate:modelValue":e[30]||(e[30]=t=>r.value.supervisor=t),placeholder:"選擇主管"},{default:u(()=>[(g(!0),_(S,null,L(at.value,t=>(g(),R(v,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),i("div",Bo,[e[104]||(e[104]=i("h3",{class:"form-group-title"},"職務資訊",-1)),i("div",zo,[o(n,{label:"職稱"},{default:u(()=>[o(y,{modelValue:r.value.title,"onUpdate:modelValue":e[31]||(e[31]=t=>r.value.title=t),placeholder:"選擇職稱",disabled:!Te.value.length},{default:u(()=>[(g(!0),_(S,null,L(Te.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(n,{label:"執業職稱"},{default:u(()=>[o(y,{modelValue:r.value.practiceTitle,"onUpdate:modelValue":e[32]||(e[32]=t=>r.value.practiceTitle=t),placeholder:"選擇執業職稱",disabled:!xe.value.length},{default:u(()=>[(g(!0),_(S,null,L(xe.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",jo,[o(n,{label:"兼職人員"},{default:u(()=>[o(P,{modelValue:r.value.isPartTime,"onUpdate:modelValue":e[33]||(e[33]=t=>r.value.isPartTime=t),"active-text":"是","inactive-text":"否","active-color":"#10b981"},null,8,["modelValue"])]),_:1}),o(n,{label:"需要打卡"},{default:u(()=>[o(P,{modelValue:r.value.isClocking,"onUpdate:modelValue":e[34]||(e[34]=t=>r.value.isClocking=t),"active-text":"是","inactive-text":"否","active-color":"#10b981"},null,8,["modelValue"])]),_:1})])]),i("div",Mo,[e[105]||(e[105]=i("h3",{class:"form-group-title"},"聘用狀態",-1)),i("div",xo,[o(n,{label:"在職狀態"},{default:u(()=>[o(y,{modelValue:r.value.employmentStatus,"onUpdate:modelValue":e[35]||(e[35]=t=>r.value.employmentStatus=t),placeholder:"選擇狀態"},{default:u(()=>[o(v,{label:"正職員工",value:"正職員工"}),o(v,{label:"試用期員工",value:"試用期員工"}),o(v,{label:"離職員工",value:"離職員工"}),o(v,{label:"留職停薪",value:"留職停薪"})]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"試用期"},{default:u(()=>[o(y,{modelValue:r.value.probationDays,"onUpdate:modelValue":e[36]||(e[36]=t=>r.value.probationDays=t),placeholder:"選擇天數"},{default:u(()=>[o(v,{label:"無",value:""}),o(v,{label:"30天",value:"30"}),o(v,{label:"60天",value:"60"}),o(v,{label:"90天",value:"90"})]),_:1},8,["modelValue"])]),_:1})]),i("div",Fo,[o(n,{label:"到職日期"},{default:u(()=>[o(w,{modelValue:r.value.hireDate,"onUpdate:modelValue":e[37]||(e[37]=t=>r.value.hireDate=t),type:"date",placeholder:"選擇到職日期"},null,8,["modelValue"])]),_:1}),o(n,{label:"起聘日期"},{default:u(()=>[o(w,{modelValue:r.value.appointDate,"onUpdate:modelValue":e[38]||(e[38]=t=>r.value.appointDate=t),type:"date",placeholder:"選擇起聘日期"},null,8,["modelValue"])]),_:1})]),i("div",$o,[o(n,{label:"離職日期"},{default:u(()=>[o(w,{modelValue:r.value.resignDate,"onUpdate:modelValue":e[39]||(e[39]=t=>r.value.resignDate=t),type:"date",placeholder:"選擇離職日期"},null,8,["modelValue"])]),_:1}),o(n,{label:"解聘日期"},{default:u(()=>[o(w,{modelValue:r.value.dismissDate,"onUpdate:modelValue":e[40]||(e[40]=t=>r.value.dismissDate=t),type:"date",placeholder:"選擇解聘日期"},null,8,["modelValue"])]),_:1})]),i("div",Yo,[o(n,{label:"再任起聘"},{default:u(()=>[o(w,{modelValue:r.value.reAppointDate,"onUpdate:modelValue":e[41]||(e[41]=t=>r.value.reAppointDate=t),type:"date",placeholder:"選擇再任起聘日期"},null,8,["modelValue"])]),_:1}),o(n,{label:"再任解聘"},{default:u(()=>[o(w,{modelValue:r.value.reDismissDate,"onUpdate:modelValue":e[42]||(e[42]=t=>r.value.reDismissDate=t),type:"date",placeholder:"選擇再任解聘日期"},null,8,["modelValue"])]),_:1})]),i("div",qo,[o(n,{label:"聘任備註",class:"full-width-item"},{default:u(()=>[o(f,{modelValue:r.value.employmentNote,"onUpdate:modelValue":e[43]||(e[43]=t=>r.value.employmentNote=t),type:"textarea",rows:2,placeholder:"請輸入聘任備註"},null,8,["modelValue"])]),_:1})])])])])]),_:1}),o(V,{name:"more"},{label:u(()=>e[106]||(e[106]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-more"}),i("span",null,"更多資訊")],-1)])),default:u(()=>[i("div",Ko,[i("div",Go,[i("div",Xo,[e[107]||(e[107]=i("h3",{class:"form-group-title"},"身體檢查",-1)),i("div",Ho,[o(n,{label:"身高 (cm)"},{default:u(()=>[o(T,{modelValue:r.value.height,"onUpdate:modelValue":e[44]||(e[44]=t=>r.value.height=t),min:0,max:250,step:.1,precision:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入身高"},null,8,["modelValue"])]),_:1}),o(n,{label:"體重 (kg)"},{default:u(()=>[o(T,{modelValue:r.value.weight,"onUpdate:modelValue":e[45]||(e[45]=t=>r.value.weight=t),min:0,max:300,step:.1,precision:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入體重"},null,8,["modelValue"])]),_:1})]),i("div",Wo,[o(n,{label:"體檢血型"},{default:u(()=>[o(y,{modelValue:r.value.medicalBloodType,"onUpdate:modelValue":e[46]||(e[46]=t=>r.value.medicalBloodType=t),placeholder:"選擇血型",clearable:""},{default:u(()=>[(g(),_(S,null,L(Al,t=>o(v,{key:`medical-${t}`,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])]),i("div",Jo,[e[108]||(e[108]=i("h3",{class:"form-group-title"},"學歷資訊",-1)),i("div",Qo,[o(n,{label:"教育程度"},{default:u(()=>[o(y,{modelValue:r.value.educationLevel,"onUpdate:modelValue":e[47]||(e[47]=t=>r.value.educationLevel=t),placeholder:"選擇教育程度",disabled:!qe.value.length},{default:u(()=>[(g(!0),_(S,null,L(qe.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(n,{label:"學校名稱"},{default:u(()=>[o(f,{modelValue:r.value.schoolName,"onUpdate:modelValue":e[48]||(e[48]=t=>r.value.schoolName=t),placeholder:"請輸入學校名稱"},null,8,["modelValue"])]),_:1})]),i("div",Zo,[o(n,{label:"主修科系"},{default:u(()=>[o(f,{modelValue:r.value.major,"onUpdate:modelValue":e[49]||(e[49]=t=>r.value.major=t),placeholder:"請輸入主修科系"},null,8,["modelValue"])]),_:1}),o(n,{label:"畢業狀態"},{default:u(()=>[o(y,{modelValue:r.value.graduationStatus,"onUpdate:modelValue":e[50]||(e[50]=t=>r.value.graduationStatus=t),placeholder:"選擇畢業狀態",clearable:"",onClear:tt,disabled:!Ke.value.length},{default:u(()=>[(g(!0),_(S,null,L(Ke.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",er,[o(n,{label:"畢業年度",class:"full-width-item"},{default:u(()=>[o(f,{modelValue:r.value.graduationYear,"onUpdate:modelValue":e[51]||(e[51]=t=>r.value.graduationYear=t),placeholder:"請輸入畢業年度"},null,8,["modelValue"])]),_:1})])]),i("div",lr,[e[109]||(e[109]=i("h3",{class:"form-group-title"},"役別資訊",-1)),i("div",ar,[o(n,{label:"役別類型"},{default:u(()=>[o(y,{modelValue:r.value.serviceType,"onUpdate:modelValue":e[52]||(e[52]=t=>r.value.serviceType=t),placeholder:"選擇或輸入役別類型",filterable:"","allow-create":"","default-first-option":"",clearable:""},{default:u(()=>[(g(),_(S,null,L(Ta,t=>o(v,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"軍種"},{default:u(()=>[o(f,{modelValue:r.value.militaryBranch,"onUpdate:modelValue":e[53]||(e[53]=t=>r.value.militaryBranch=t),placeholder:"請輸入軍種"},null,8,["modelValue"])]),_:1})]),i("div",tr,[o(n,{label:"軍階"},{default:u(()=>[o(f,{modelValue:r.value.militaryRank,"onUpdate:modelValue":e[54]||(e[54]=t=>r.value.militaryRank=t),placeholder:"請輸入軍階"},null,8,["modelValue"])]),_:1}),o(n,{label:"退伍年"},{default:u(()=>[o(T,{modelValue:r.value.dischargeYear,"onUpdate:modelValue":e[55]||(e[55]=t=>r.value.dischargeYear=t),min:1900,max:Rt(Ra)+10,step:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入退伍年"},null,8,["modelValue","max"])]),_:1})])]),i("div",or,[e[112]||(e[112]=i("h3",{class:"form-group-title"},"緊急聯絡人",-1)),i("div",rr,[e[110]||(e[110]=i("h4",{class:"contact-subtitle"},"聯絡人一",-1)),i("div",nr,[o(n,{label:"姓名"},{default:u(()=>[o(f,{modelValue:r.value.emergency1.name,"onUpdate:modelValue":e[56]||(e[56]=t=>r.value.emergency1.name=t),placeholder:"請輸入姓名"},null,8,["modelValue"])]),_:1}),o(n,{label:"關係"},{default:u(()=>[o(y,{modelValue:r.value.emergency1.relation,"onUpdate:modelValue":e[57]||(e[57]=t=>r.value.emergency1.relation=t),placeholder:"選擇關係"},{default:u(()=>[(g(!0),_(S,null,L(Ge.value,t=>(g(),R(v,{key:`r1-${t.value}`,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",sr,[o(n,{label:"電話一"},{default:u(()=>[o(f,{modelValue:r.value.emergency1.phone1,"onUpdate:modelValue":e[58]||(e[58]=t=>r.value.emergency1.phone1=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1}),o(n,{label:"電話二"},{default:u(()=>[o(f,{modelValue:r.value.emergency1.phone2,"onUpdate:modelValue":e[59]||(e[59]=t=>r.value.emergency1.phone2=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1})])]),i("div",ir,[e[111]||(e[111]=i("h4",{class:"contact-subtitle"},"聯絡人二",-1)),i("div",ur,[o(n,{label:"姓名"},{default:u(()=>[o(f,{modelValue:r.value.emergency2.name,"onUpdate:modelValue":e[60]||(e[60]=t=>r.value.emergency2.name=t),placeholder:"請輸入姓名"},null,8,["modelValue"])]),_:1}),o(n,{label:"關係"},{default:u(()=>[o(y,{modelValue:r.value.emergency2.relation,"onUpdate:modelValue":e[61]||(e[61]=t=>r.value.emergency2.relation=t),placeholder:"選擇關係"},{default:u(()=>[(g(!0),_(S,null,L(Ge.value,t=>(g(),R(v,{key:`r2-${t.value}`,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",dr,[o(n,{label:"電話一"},{default:u(()=>[o(f,{modelValue:r.value.emergency2.phone1,"onUpdate:modelValue":e[62]||(e[62]=t=>r.value.emergency2.phone1=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1}),o(n,{label:"電話二"},{default:u(()=>[o(f,{modelValue:r.value.emergency2.phone2,"onUpdate:modelValue":e[63]||(e[63]=t=>r.value.emergency2.phone2=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1})])])]),i("div",cr,[e[115]||(e[115]=i("h3",{class:"form-group-title"},"工作經歷",-1)),i("div",mr,[(g(!0),_(S,null,L(r.value.experiences,(t,A)=>(g(),_("div",{key:A,class:"experience-item"},[i("div",pr,[i("h4",fr,"經歷 "+k(A+1),1),o(a,{type:"danger",size:"small",onClick:h=>_t(A),class:"remove-btn"},{default:u(()=>e[113]||(e[113]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",vr,[o(n,{label:"單位名稱"},{default:u(()=>[o(f,{modelValue:t.unit,"onUpdate:modelValue":h=>t.unit=h,placeholder:"請輸入單位名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"職稱"},{default:u(()=>[o(f,{modelValue:t.title,"onUpdate:modelValue":h=>t.title=h,placeholder:"請輸入職稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",yr,[o(n,{label:"到職年月"},{default:u(()=>[o(w,{modelValue:t.start,"onUpdate:modelValue":h=>t.start=h,type:"month",placeholder:"選擇到職年月"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"離職年月"},{default:u(()=>[o(w,{modelValue:t.end,"onUpdate:modelValue":h=>t.end=h,type:"month",placeholder:"選擇離職年月"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128))]),o(a,{type:"primary",onClick:ht,class:"add-item-btn"},{default:u(()=>e[114]||(e[114]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增經歷 ")])),_:1})]),i("div",gr,[e[120]||(e[120]=i("h3",{class:"form-group-title"},"證照",-1)),i("div",br,[(g(!0),_(S,null,L(r.value.licenses,(t,A)=>(g(),_("div",{key:`license-${A}`,class:"experience-item"},[i("div",hr,[i("h4",_r,"證照 "+k(A+1),1),o(a,{type:"danger",size:"small",onClick:h=>wt(A),class:"remove-btn"},{default:u(()=>e[116]||(e[116]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",Vr,[o(n,{label:"證照名稱"},{default:u(()=>[o(f,{modelValue:t.name,"onUpdate:modelValue":h=>t.name=h,placeholder:"請輸入證照名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"證照字號"},{default:u(()=>[o(f,{modelValue:t.number,"onUpdate:modelValue":h=>t.number=h,placeholder:"請輸入證照字號"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",wr,[o(n,{label:"核發日期"},{default:u(()=>[o(w,{modelValue:t.startDate,"onUpdate:modelValue":h=>t.startDate=h,type:"date",placeholder:"選擇核發日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"有效期限"},{default:u(()=>[o(w,{modelValue:t.endDate,"onUpdate:modelValue":h=>t.endDate=h,type:"date",placeholder:"選擇有效期限"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Ar,[o(n,{label:"證照檔案",class:"full-width-item"},{default:u(()=>[o(I,{"file-list":t.fileList,"onUpdate:fileList":h=>t.fileList=h,action:"#",multiple:"","list-type":"text","http-request":Ol,"on-success":(h,ie,cl)=>Nl("licenses",A,h,ie,cl),"on-remove":(h,ie)=>Pl("licenses",A,h,ie)},{tip:u(()=>e[118]||(e[118]=[i("div",{class:"upload-tip"},"可上傳多個檔案，將以連結形式儲存",-1)])),default:u(()=>[o(a,{type:"primary",plain:""},{default:u(()=>e[117]||(e[117]=[i("i",{class:"el-icon-upload2"},null,-1),D(" 上傳檔案 ")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","on-success","on-remove"])]),_:2},1024)])]))),128))]),o(a,{type:"primary",onClick:Vt,class:"add-item-btn"},{default:u(()=>e[119]||(e[119]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增證照 ")])),_:1})]),i("div",Sr,[e[125]||(e[125]=i("h3",{class:"form-group-title"},"教育訓練",-1)),i("div",Lr,[(g(!0),_(S,null,L(r.value.trainings,(t,A)=>(g(),_("div",{key:`training-${A}`,class:"experience-item"},[i("div",kr,[i("h4",Dr,"教育訓練 "+k(A+1),1),o(a,{type:"danger",size:"small",onClick:h=>St(A),class:"remove-btn"},{default:u(()=>e[121]||(e[121]=[i("i",{class:"el-icon-delete"},null,-1),D(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",Er,[o(n,{label:"課程名稱"},{default:u(()=>[o(f,{modelValue:t.course,"onUpdate:modelValue":h=>t.course=h,placeholder:"請輸入課程名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"課程代碼"},{default:u(()=>[o(f,{modelValue:t.courseNo,"onUpdate:modelValue":h=>t.courseNo=h,placeholder:"請輸入課程代碼"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Ir,[o(n,{label:"上課日期"},{default:u(()=>[o(w,{modelValue:t.date,"onUpdate:modelValue":h=>t.date=h,type:"date",placeholder:"選擇日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"積分類別",class:"full-width-item"},{default:u(()=>[o(y,{modelValue:t.category,"onUpdate:modelValue":h=>t.category=h,multiple:"","collapse-tags":"",placeholder:"選擇積分類別"},{default:u(()=>[(g(!0),_(S,null,L(bl.value,h=>(g(),R(v,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Ur,[o(n,{label:"積分"},{default:u(()=>[o(T,{modelValue:t.score,"onUpdate:modelValue":h=>t.score=h,min:0,step:.5,"value-on-clear":null},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(n,{label:"訓練檔案",class:"full-width-item"},{default:u(()=>[o(I,{"file-list":t.fileList,"onUpdate:fileList":h=>t.fileList=h,action:"#",multiple:"","list-type":"text","http-request":Ol,"on-success":(h,ie,cl)=>Nl("trainings",A,h,ie,cl),"on-remove":(h,ie)=>Pl("trainings",A,h,ie)},{tip:u(()=>e[123]||(e[123]=[i("div",{class:"upload-tip"},"支援多檔上傳，將以連結形式儲存",-1)])),default:u(()=>[o(a,{type:"primary",plain:""},{default:u(()=>e[122]||(e[122]=[i("i",{class:"el-icon-upload2"},null,-1),D(" 上傳檔案 ")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","on-success","on-remove"])]),_:2},1024)])]))),128))]),o(a,{type:"primary",onClick:At,class:"add-item-btn"},{default:u(()=>e[124]||(e[124]=[i("i",{class:"el-icon-plus"},null,-1),D(" 新增教育訓練 ")])),_:1})])])])]),_:1}),o(V,{name:"salary"},{label:u(()=>e[126]||(e[126]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-money"}),i("span",null,"薪資設定")],-1)])),default:u(()=>[i("div",Tr,[i("div",Rr,[i("div",Cr,[e[127]||(e[127]=i("h3",{class:"form-group-title"},"薪資資訊",-1)),i("div",Or,[o(n,{label:"薪資類別"},{default:u(()=>[o(y,{modelValue:r.value.salaryType,"onUpdate:modelValue":e[64]||(e[64]=t=>r.value.salaryType=t),placeholder:"選擇類別"},{default:u(()=>[(g(),_(S,null,L(Ia,t=>o(v,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"薪資金額"},{default:u(()=>[o(T,{modelValue:r.value.salaryAmount,"onUpdate:modelValue":e[65]||(e[65]=t=>r.value.salaryAmount=t),min:0,step:1e3,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),o(n,{label:"勞退自提",prop:"laborPensionSelf"},{default:u(()=>[o(T,{modelValue:r.value.laborPensionSelf,"onUpdate:modelValue":e[66]||(e[66]=t=>r.value.laborPensionSelf=t),min:0,step:100,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),o(n,{label:"員工預支",prop:"employeeAdvance"},{default:u(()=>[o(T,{modelValue:r.value.employeeAdvance,"onUpdate:modelValue":e[67]||(e[67]=t=>r.value.employeeAdvance=t),min:0,step:100,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),o(n,{class:"full-width-item",label:"薪資項目",prop:"salaryItems"},{default:u(()=>[o(y,{modelValue:r.value.salaryItems,"onUpdate:modelValue":e[68]||(e[68]=t=>r.value.salaryItems=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"選擇薪資項目"},{default:u(()=>[(g(!0),_(S,null,L(be.value,t=>(g(),R(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),i("div",Nr,[e[130]||(e[130]=i("h3",{class:"form-group-title"},"銀行帳戶",-1)),i("div",Pr,[e[128]||(e[128]=i("h4",{class:"account-subtitle"},"薪資帳戶 A",-1)),i("div",Br,[o(n,{label:"銀行代碼/名稱"},{default:u(()=>[o(f,{modelValue:r.value.salaryAccountA.bank,"onUpdate:modelValue":e[69]||(e[69]=t=>r.value.salaryAccountA.bank=t),placeholder:"請輸入銀行資訊"},null,8,["modelValue"])]),_:1}),o(n,{label:"帳號"},{default:u(()=>[o(f,{modelValue:r.value.salaryAccountA.acct,"onUpdate:modelValue":e[70]||(e[70]=t=>r.value.salaryAccountA.acct=t),placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1})])]),i("div",zr,[e[129]||(e[129]=i("h4",{class:"account-subtitle"},"薪資帳戶 B",-1)),i("div",jr,[o(n,{label:"銀行代碼/名稱"},{default:u(()=>[o(f,{modelValue:r.value.salaryAccountB.bank,"onUpdate:modelValue":e[71]||(e[71]=t=>r.value.salaryAccountB.bank=t),placeholder:"請輸入銀行資訊"},null,8,["modelValue"])]),_:1}),o(n,{label:"帳號"},{default:u(()=>[o(f,{modelValue:r.value.salaryAccountB.acct,"onUpdate:modelValue":e[72]||(e[72]=t=>r.value.salaryAccountB.acct=t),placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1})])])])])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(ul,{modelValue:he.value,"onUpdate:modelValue":e[79]||(e[79]=t=>he.value=t),title:"批量匯入員工",width:"720px",class:"bulk-import-dialog","close-on-click-modal":!1,"before-close":nt},{footer:u(()=>[o(a,{onClick:rt},{default:u(()=>e[144]||(e[144]=[D("取消")])),_:1}),o(a,{type:"primary",loading:Ve.value,disabled:!Vl.value||Ve.value,onClick:il},{default:u(()=>e[145]||(e[145]=[D(" 開始匯入 ")])),_:1},8,["loading","disabled"])]),default:u(()=>[i("div",xr,[o(dl,{type:"info","show-icon":"",closable:!1},{title:u(()=>e[133]||(e[133]=[D(" 下載範本後依欄位填寫資料，或直接使用範本內建的 5 筆示範資料測試匯入流程。 ")])),default:u(()=>[i("div",Fr,[e[135]||(e[135]=i("i",{class:"el-icon-document"},null,-1)),o(a,{type:"primary",link:"","data-test":"bulk-import-template-download",onClick:ga},{default:u(()=>e[134]||(e[134]=[D(" 下載匯入範本 ")])),_:1})])]),_:1})]),i("div",$r,[o(I,{drag:"",action:"","auto-upload":!1,accept:".xlsx,.xls,.csv","file-list":de.value,limit:1,"on-change":la,"on-remove":aa},{default:u(()=>e[136]||(e[136]=[i("i",{class:"el-icon-upload"},null,-1),i("div",{class:"el-upload__text"},[D(" 將檔案拖曳至此或 "),i("em",null,"點此選擇")],-1),i("div",{class:"el-upload__tip"},"支援 .xlsx、.xls、.csv 檔案格式，檔案大小請勿超過 5MB",-1)])),_:1},8,["file-list"])]),i("div",Yr,[e[139]||(e[139]=i("h3",{class:"bulk-import-subtitle"},"欄位格式與必填說明",-1)),e[140]||(e[140]=i("p",{class:"bulk-import-description"}," 系統已預先套用官方批量匯入 Excel 模板，請依下列欄位填寫資料後再上傳檔案。 ",-1)),o(dl,{type:"warning","show-icon":"",class:"bulk-import-required-alert",closable:!1},{title:u(()=>[D("必填欄位："+k(pa.value.join("、")),1)]),default:u(()=>[e[137]||(e[137]=i("div",null,"若未提供必填欄位資料，匯入時將提示錯誤並中止處理。",-1))]),_:1}),(g(!0),_(S,null,L(ma.value,t=>(g(),_("section",{key:t.title,class:"bulk-import-section"},[i("h4",qr,k(t.title),1),o(p,{data:t.fields,border:"",size:"small",class:"bulk-import-table"},{default:u(()=>[o(d,{prop:"header",label:"Excel 欄位 (英文)",width:"220"},{default:u(({row:A})=>[i("code",Kr,k(A.header),1)]),_:1}),o(d,{prop:"displayDescription",label:"欄位說明","min-width":"300"},{default:u(({row:A})=>[D(k(A.displayDescription||A.description||A.label||A.header),1)]),_:1}),o(d,{label:"是否必填",width:"120",align:"center"},{default:u(({row:A})=>[A.required?(g(),R(c,{key:0,type:"danger",size:"small"},{default:u(()=>e[138]||(e[138]=[D("必填")])),_:1})):(g(),_("span",Gr,"選填"))]),_:1})]),_:2},1032,["data"])]))),128)),e[141]||(e[141]=i("h3",{class:"bulk-import-subtitle bulk-import-options-title"},"匯入參數設定",-1)),o(ql,{model:U,"label-width":"150px"},{default:u(()=>[o(n,{label:"匯入預設權限",required:""},{default:u(()=>[o(y,{modelValue:U.options.defaultRole,"onUpdate:modelValue":e[76]||(e[76]=t=>U.options.defaultRole=t),placeholder:"請選擇預設權限"},{default:u(()=>[(g(),_(S,null,L(Ie,t=>o(v,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"預設登入密碼"},{default:u(()=>[o(f,{modelValue:U.options.resetPassword,"onUpdate:modelValue":e[77]||(e[77]=t=>U.options.resetPassword=t),type:"password","show-password":"",placeholder:"未設定則由後端自動產生"},null,8,["modelValue"])]),_:1}),o(n,{label:"寄發通知信"},{default:u(()=>[o(P,{modelValue:U.options.sendWelcomeEmail,"onUpdate:modelValue":e[78]||(e[78]=t=>U.options.sendWelcomeEmail=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),se.value.length||F.value.length?(g(),_("div",Xr,[F.value.length?(g(),R(dl,{key:0,type:"warning",closable:!1,"show-icon":"",class:"bulk-import-error"},{title:u(()=>e[142]||(e[142]=[D("匯入時發現以下問題，請確認後重新處理：")])),default:u(()=>[i("ul",Hr,[(g(!0),_(S,null,L(F.value,(t,A)=>(g(),_("li",{key:A},k(t),1))),128))])]),_:1})):K("",!0),se.value.length?(g(),_("div",Wr,[e[143]||(e[143]=i("h4",null,"匯入預覽",-1)),o(p,{data:se.value,size:"small",height:"240"},{default:u(()=>[o(d,{prop:"employeeNo",label:"員工編號",width:"140"}),o(d,{prop:"name",label:"姓名",width:"140"}),o(d,{prop:"department",label:"部門","min-width":"120"}),o(d,{prop:"role",label:"權限",width:"120"}),o(d,{prop:"email",label:"Email","min-width":"160"})]),_:1},8,["data"])])):K("",!0)])):K("",!0)]),_:1},8,["modelValue"]),o(ul,{modelValue:$.value,"onUpdate:modelValue":e[81]||(e[81]=t=>$.value=t),title:we.value||"補齊參照對應",width:"640px",class:"reference-mapping-dialog","close-on-click-modal":!1},{footer:u(()=>[o(a,{onClick:e[80]||(e[80]=t=>$.value=!1),disabled:ce.value},{default:u(()=>e[148]||(e[148]=[D(" 稍後再處理 ")])),_:1},8,["disabled"]),o(a,{type:"primary",loading:ce.value,onClick:yt},{default:u(()=>e[149]||(e[149]=[D(" 套用設定後重新匯入 ")])),_:1},8,["loading"])]),default:u(()=>[e[150]||(e[150]=i("p",{class:"reference-mapping-tip"}," 請為下列資料選擇對應的既有項目，或設定忽略後重新嘗試匯入。 ",-1)),$.value?(g(!0),_(S,{key:0},L(je.value,t=>(g(),_("div",{key:t.type,class:"reference-mapping-section"},[Array.isArray(t.values)&&t.values.length?(g(),_(S,{key:0},[i("h4",Jr,k(ca(t.type))+"對應",1),(g(!0),_(S,null,L(t.values,A=>(g(),_("div",{key:J(A),class:"reference-mapping-item"},[i("div",Qr,[i("span",Zr,k(A.value||"（空值）"),1),i("span",en,"出現於第 "+k((A.rows||[]).join("、"))+" 列",1)]),o(b,{modelValue:ve(t.type,J(A)).mode,"onUpdate:modelValue":h=>ve(t.type,J(A)).mode=h,class:"reference-mapping-mode"},{default:u(()=>[o(m,{label:"map"},{default:u(()=>e[146]||(e[146]=[D("指定既有資料")])),_:1}),o(m,{label:"ignore"},{default:u(()=>e[147]||(e[147]=[D("忽略此次匯入")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),ve(t.type,J(A)).mode==="map"?(g(),R(y,{key:0,modelValue:ve(t.type,J(A)).targetId,"onUpdate:modelValue":h=>ve(t.type,J(A)).targetId=h,placeholder:"請選擇既有項目",class:"reference-mapping-select",filterable:"",clearable:""},{default:u(()=>[(g(!0),_(S,null,L(t.options,h=>(g(),R(v,{key:h.id,label:it(t.type,h),value:h.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):K("",!0)]))),128))],64)):K("",!0)]))),128)):K("",!0),$.value&&je.value.every(t=>!t.values.length)?(g(),_("div",ln," 所有參照皆已處理，請重新送出匯入。 ")):K("",!0),je.value.every(t=>t.values.length===0)?(g(),_("div",an," 所有參照皆已處理，請重新送出匯入。 ")):K("",!0)]),_:1},8,["modelValue","title"])])]),_:1})}}},rn=Kl(on,[["__scopeId","data-v-fb79cbe9"]]),nn={class:"hr-management-system-setting"},sn={__name:"HRManagementSystemSetting",setup(Gl){const Ee=E("employeeMgmt");return(Z,ue)=>{const Pe=C("el-tabs");return g(),_("div",nn,[ue[1]||(ue[1]=i("h2",null,"人事管理與系統設定",-1)),o(Pe,{modelValue:Ee.value,"onUpdate:modelValue":ue[0]||(ue[0]=Be=>Ee.value=Be),type:"card"},{default:u(()=>[o(rn)]),_:1},8,["modelValue"])])}}},cn=Kl(sn,[["__scopeId","data-v-8631704d"]]);export{cn as default};
