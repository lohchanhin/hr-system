import{_ as L,r as v,c as w,a as j,b as o,d as t,w as r,e as n,u as M,o as f,f as S,g as k,h as B,s as R,E as h}from"./index-B6oJpjLF.js";import{a as I}from"./api-C-QqRWhG.js";import{u as N}from"./menu-VqsHPQtl.js";const F={class:"login-container"},T={class:"login-form-container"},q={key:0},z={key:1},E={__name:"Login",setup(U){const m=M(),C=N(),l=v({username:"",password:"",role:""}),c=v(null),u=v(!1),b={username:[{required:!0,message:"請輸入管理員帳號",trigger:"blur"},{min:3,message:"帳號長度至少3個字符",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:6,message:"密碼長度至少6個字符",trigger:"blur"}],role:[{required:!0,message:"請選擇角色",trigger:"change"}]},_=async()=>{if(c.value)try{if(!await c.value.validate())return;u.value=!0;const{username:e,password:p,role:a}=l.value,i=await I("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:p,role:a})},{autoRedirect:!1});if(i.ok){const s=await i.json();R(s.token),sessionStorage.setItem("role",s.user.role),sessionStorage.setItem("employeeId",s.user.employeeId||s.user.id),await C.fetchMenu(),h.success("登入成功！"),s.user.role==="supervisor"?m.push("/front/schedule"):s.user.role==="admin"&&m.push("/manager/settings")}else{const s=await i.json();h.error(s.message||"登入失敗，請檢查帳號密碼")}}catch(g){console.error("Login error:",g),h.error("登入過程中發生錯誤，請稍後再試")}finally{u.value=!1}};return(g,e)=>{const p=n("el-input"),a=n("el-form-item"),i=n("el-radio"),s=n("el-radio-group"),y=n("el-button"),V=n("el-form"),x=n("el-card");return f(),w("div",F,[e[12]||(e[12]=j('<div class="login-background" data-v-74231a89><div class="login-brand" data-v-74231a89><div class="brand-icon" data-v-74231a89><svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-74231a89><path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-74231a89></path><path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-74231a89></path><path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-74231a89></path></svg></div><h1 class="brand-title" data-v-74231a89>HR Management System</h1><p class="brand-subtitle" data-v-74231a89>後台管理系統</p></div></div>',1)),o("div",T,[t(x,{class:"login-card",shadow:"always"},{default:r(()=>[e[10]||(e[10]=o("div",{class:"login-header"},[o("h2",{class:"login-title"},"管理員登入"),o("p",{class:"login-description"},"請使用您的管理員帳號登入系統")],-1)),t(V,{model:l.value,ref_key:"loginFormRef",ref:c,class:"login-form",rules:b,onSubmit:S(_,["prevent"])},{default:r(()=>[t(a,{prop:"username",class:"form-item"},{default:r(()=>[e[4]||(e[4]=o("div",{class:"input-label"},[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),o("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),o("span",null,"管理員帳號")],-1)),t(p,{modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=d=>l.value.username=d),placeholder:"請輸入管理員帳號",size:"large",class:"custom-input"},null,8,["modelValue"])]),_:1}),t(a,{prop:"password",class:"form-item"},{default:r(()=>[e[5]||(e[5]=o("div",{class:"input-label"},[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),o("circle",{cx:"12",cy:"16",r:"1",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),o("path",{d:"M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),o("span",null,"密碼")],-1)),t(p,{modelValue:l.value.password,"onUpdate:modelValue":e[1]||(e[1]=d=>l.value.password=d),type:"password",placeholder:"請輸入密碼",size:"large",class:"custom-input","show-password":""},null,8,["modelValue"])]),_:1}),t(a,{prop:"role",class:"form-item"},{default:r(()=>[e[8]||(e[8]=o("div",{class:"input-label"},[o("span",null,"角色")],-1)),t(s,{modelValue:l.value.role,"onUpdate:modelValue":e[2]||(e[2]=d=>l.value.role=d)},{default:r(()=>[t(i,{label:"supervisor"},{default:r(()=>e[6]||(e[6]=[k("主管")])),_:1}),t(i,{label:"admin"},{default:r(()=>e[7]||(e[7]=[k("系統管理員")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(a,{class:"form-item"},{default:r(()=>[t(y,{type:"primary",size:"large",class:"login-button",loading:u.value,onClick:_,"native-type":"submit"},{default:r(()=>[u.value?(f(),w("span",z,"登入中...")):(f(),w("span",q,"登入系統"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),t(y,{type:"text",class:"employee-login-link",onClick:e[3]||(e[3]=d=>B(m).push("/login"))},{default:r(()=>e[9]||(e[9]=[k(" 返回員工登入 ")])),_:1}),e[11]||(e[11]=o("div",{class:"security-notice"},[o("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M12 22S8 18 8 13V6L12 4L16 6V13C16 18 12 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),o("span",null,"您的登入資訊將被安全加密處理")],-1))]),_:1})])])}}},D=L(E,[["__scopeId","data-v-74231a89"]]);export{D as default};
