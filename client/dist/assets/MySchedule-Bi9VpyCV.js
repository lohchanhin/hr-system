import{_ as k,r,B as _,j as v,q as Y,c as h,d,k as b,e as i,w as M,p as w,o as p}from"./index-Drg5voG6.js";import{a as f}from"./api-BD68GGQR.js";const j={class:"my-schedule"},S={key:1},x={__name:"MySchedule",setup(B){const n=r([]),u=r({}),c=r(_().format("YYYY-MM"));async function y(){try{const t=await f("/api/attendance-settings");if(t.ok){const e=await t.json(),o=Array.isArray(e==null?void 0:e.shifts)?e.shifts:e;u.value=Object.fromEntries(o.map(a=>[a._id,a.name]))}}catch(t){console.error(t)}}async function m(){const t=w();if(t)try{await y();const e=JSON.parse(atob(t.split(".")[1])),o=e.id||e._id||e.sub,a=await f(`/api/schedules/monthly?month=${c.value}&employee=${o}`);if(a.ok){const l=await a.json();n.value=l.map(s=>({...s,date:_(s.date).format("YYYY/MM/DD"),shiftName:u.value[s.shiftId]||""}))}}catch(e){console.error(e)}}return v(m),Y(c,m),(t,e)=>{const o=i("el-date-picker"),a=i("el-table-column"),l=i("el-table");return p(),h("div",j,[d(o,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),type:"month","value-format":"YYYY-MM"},null,8,["modelValue"]),n.value.length?(p(),b(l,{key:0,data:n.value,class:"schedule-table"},{default:M(()=>[d(a,{prop:"date",label:"日期",width:"120"}),d(a,{prop:"shiftName",label:"班別"})]),_:1},8,["data"])):(p(),h("p",S,"目前無排班資料"))])}}},g=k(x,[["__scopeId","data-v-fbdccf2d"]]);export{g as default};
