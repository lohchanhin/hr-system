import{_ as b,r as p,c as m,a as x,b as e,d as s,w as a,e as l,u as L,o as g,f as V,s as j,E as v}from"./index-BOg20HvU.js";import{u as M}from"./menu-Diu3JIyb.js";import{a as S}from"./api-D4yO7thr.js";const B={class:"login-container"},I={class:"login-form-container"},R={key:0},F={key:1},N={__name:"Login",setup(z){const f=L(),w=M(),r=p({username:"",password:""}),d=p(null),i=p(!1),h={username:[{required:!0,message:"請輸入管理員帳號",trigger:"blur"},{min:3,message:"帳號長度至少3個字符",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:6,message:"密碼長度至少6個字符",trigger:"blur"}]},k=async()=>{if(d.value)try{if(!await d.value.validate())return;i.value=!0;const o=await S("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r.value)});if(o.ok){const t=await o.json();j(t.token),localStorage.setItem("role",t.user.role),localStorage.setItem("employeeId",t.user.employeeId),v.success("登入成功！"),await w.fetchMenu();const n=w.items[0];n?f.push({name:n.name}):f.push({name:"Login"})}else{const t=await o.json();v.error(t.message||"登入失敗，請檢查帳號密碼")}}catch(u){console.error("Login error:",u),v.error("登入過程中發生錯誤，請稍後再試")}finally{i.value=!1}};return(u,o)=>{const t=l("el-input"),n=l("el-form-item"),_=l("el-button"),y=l("el-form"),C=l("el-card");return g(),m("div",B,[o[6]||(o[6]=x('<div class="login-background" data-v-025df10c><div class="login-brand" data-v-025df10c><div class="brand-icon" data-v-025df10c><svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-025df10c><path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-025df10c></path><path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-025df10c></path><path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-025df10c></path></svg></div><h1 class="brand-title" data-v-025df10c>HR Management System</h1><p class="brand-subtitle" data-v-025df10c>後台管理系統</p></div></div>',1)),e("div",I,[s(C,{class:"login-card",shadow:"always"},{default:a(()=>[o[4]||(o[4]=e("div",{class:"login-header"},[e("h2",{class:"login-title"},"管理員登入"),e("p",{class:"login-description"},"請使用您的管理員帳號登入系統")],-1)),s(y,{model:r.value,ref_key:"loginFormRef",ref:d,class:"login-form",rules:h,onSubmit:V(k,["prevent"])},{default:a(()=>[s(n,{prop:"username",class:"form-item"},{default:a(()=>[o[2]||(o[2]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"管理員帳號")],-1)),s(t,{modelValue:r.value.username,"onUpdate:modelValue":o[0]||(o[0]=c=>r.value.username=c),placeholder:"請輸入管理員帳號",size:"large",class:"custom-input"},null,8,["modelValue"])]),_:1}),s(n,{prop:"password",class:"form-item"},{default:a(()=>[o[3]||(o[3]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"12",cy:"16",r:"1",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"密碼")],-1)),s(t,{modelValue:r.value.password,"onUpdate:modelValue":o[1]||(o[1]=c=>r.value.password=c),type:"password",placeholder:"請輸入密碼",size:"large",class:"custom-input","show-password":""},null,8,["modelValue"])]),_:1}),s(n,{class:"form-item"},{default:a(()=>[s(_,{type:"primary",size:"large",class:"login-button",loading:i.value,onClick:k,"native-type":"submit"},{default:a(()=>[i.value?(g(),m("span",F,"登入中...")):(g(),m("span",R,"登入系統"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),o[5]||(o[5]=e("div",{class:"security-notice"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 22S8 18 8 13V6L12 4L16 6V13C16 18 12 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"您的登入資訊將被安全加密處理")],-1))]),_:1})])])}}},H=b(N,[["__scopeId","data-v-025df10c"]]);export{H as default};
