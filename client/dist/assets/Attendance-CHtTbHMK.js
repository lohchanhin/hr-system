import{_ as x,r as u,h as O,D as T,c as H,b as t,t as o,d as i,w as l,e as m,B as f,o as B,j as y}from"./index-BOg20HvU.js";import{a as b}from"./api-D4yO7thr.js";const A={class:"attendance-page"},N={class:"page-header"},S={class:"current-time"},V={class:"time-display"},E={class:"date-display"},R={class:"records-section"},F={class:"table-container"},J={class:"time-cell"},P={class:"remark-text"},U={__name:"Attendance",setup(W){const h={上班簽到:"clockIn",下班簽退:"clockOut",外出登記:"outing",中午休息:"breakIn"},v=Object.fromEntries(Object.entries(h).map(([s,e])=>[e,s])),r=u([]),_=u(""),k=u("");let p=null;async function Y(){const s=await b("/api/attendance");if(s.ok){const e=await s.json();r.value=e.map(a=>({action:v[a.action]||a.action,time:f(a.timestamp).format("YYYY-MM-DD HH:mm:ss"),remark:a.remark||""}))}}function w(){d("上班簽到")}function M(){d("下班簽退")}function D(){d("外出登記")}function I(){d("中午休息")}async function d(s){const e={action:h[s]||s,timestamp:new Date,remark:"",employee:localStorage.getItem("employeeId")||""},a=await b("/api/attendance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){const n=await a.json();r.value.push({action:v[n.action]||n.action,time:f(n.timestamp).format("YYYY-MM-DD HH:mm:ss"),remark:n.remark||""})}}function g(){const s=f();_.value=s.format("HH:mm:ss"),k.value=s.format("YYYY年MM月DD日 dddd")}function C(s){return{上班簽到:"success",下班簽退:"warning",外出登記:"info",中午休息:"primary"}[s]||"default"}return O(()=>{Y(),g(),p=setInterval(g,1e3)}),T(()=>{p&&clearInterval(p)}),(s,e)=>{const a=m("el-tag"),n=m("el-table-column"),j=m("el-table");return B(),H("div",A,[t("div",N,[e[0]||(e[0]=t("div",{class:"header-content"},[t("h1",{class:"page-title"},"出勤打卡"),t("p",{class:"page-description"},"快速進行上下班打卡、外出登記和補卡操作")],-1)),t("div",S,[t("div",V,o(_.value),1),t("div",E,o(k.value),1)])]),t("div",{class:"punch-section"},[e[5]||(e[5]=t("h2",{class:"section-title"},"快速打卡",-1)),t("div",{class:"punch-grid"},[t("div",{class:"punch-card",onClick:w},e[1]||(e[1]=[t("div",{class:"punch-icon clock-in"},[t("i",{class:"el-icon-sunrise"})],-1),t("h3",{class:"punch-title"},"上班簽到",-1),t("p",{class:"punch-desc"},"開始新的一天",-1)])),t("div",{class:"punch-card",onClick:M},e[2]||(e[2]=[t("div",{class:"punch-icon clock-out"},[t("i",{class:"el-icon-sunset"})],-1),t("h3",{class:"punch-title"},"下班簽退",-1),t("p",{class:"punch-desc"},"結束工作時間",-1)])),t("div",{class:"punch-card",onClick:D},e[3]||(e[3]=[t("div",{class:"punch-icon outing"},[t("i",{class:"el-icon-position"})],-1),t("h3",{class:"punch-title"},"外出登記",-1),t("p",{class:"punch-desc"},"臨時外出記錄",-1)])),t("div",{class:"punch-card",onClick:I},e[4]||(e[4]=[t("div",{class:"punch-icon break-time"},[t("i",{class:"el-icon-coffee-cup"})],-1),t("h3",{class:"punch-title"},"休息時間",-1),t("p",{class:"punch-desc"},"中午休息登記",-1)]))])]),t("div",R,[e[7]||(e[7]=t("h2",{class:"section-title"},"今日打卡記錄",-1)),t("div",F,[i(j,{data:r.value,class:"records-table","header-cell-style":{background:"#f8fafc",color:"#475569",fontWeight:"600"},"row-style":{height:"56px"}},{default:l(()=>[i(n,{prop:"action",label:"打卡類型",width:"140"},{default:l(({row:c})=>[i(a,{type:C(c.action),class:"action-tag"},{default:l(()=>[y(o(c.action),1)]),_:2},1032,["type"])]),_:1}),i(n,{prop:"time",label:"打卡時間",width:"200"},{default:l(({row:c})=>[t("div",J,[e[6]||(e[6]=t("i",{class:"el-icon-time time-icon"},null,-1)),y(" "+o(c.time),1)])]),_:1}),i(n,{prop:"remark",label:"備註說明"},{default:l(({row:c})=>[t("span",P,o(c.remark||"無備註"),1)]),_:1})]),_:1},8,["data"])])])])}}},G=x(U,[["__scopeId","data-v-c241b408"]]);export{G as default};
