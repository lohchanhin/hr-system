import{_ as Hl,r as D,j as x,y as ye,u as Nt,k as zt,m as Ee,e as R,n as T,o as g,w as u,b as i,d as o,v as k,c as h,F as S,t as L,g as E,q as X,h as Pt,E as N,B as ml,C as Bt}from"./index-D4KTiw27.js";import{a as re,b as Mt}from"./api-BCEPQkJB.js";const jt={class:"employee-management"},xt={class:"page-header"},Ft={class:"header-stats"},$t={class:"stat-item"},Yt={class:"stat-number"},qt={class:"stat-item"},Kt={class:"stat-number"},Gt={class:"content-header"},Xt={class:"content-actions"},Ht={class:"table-container"},Wt={class:"employee-info"},Jt={class:"employee-details"},Qt={class:"employee-name"},Zt={class:"employee-id"},er={class:"department-info"},lr={key:1,class:"no-data"},ar={class:"contact-info"},tr={key:0,class:"contact-item"},rr={key:1,class:"contact-item"},or={key:2,class:"no-data"},nr={class:"action-buttons"},sr={class:"tab-content"},ir={class:"form-section"},ur={class:"form-group"},dr={class:"form-group"},cr={class:"role-option"},mr={class:"role-name"},pr={class:"role-desc"},fr={class:"option-wrapper"},vr={class:"option-title"},gr={class:"tab-content"},yr={class:"form-section"},br={class:"form-group"},hr={class:"option-wrapper"},_r={class:"option-title"},Vr={class:"option-desc"},wr={class:"option-wrapper"},Ar={class:"option-title"},Sr={class:"option-desc"},Lr={class:"tab-content"},kr={class:"form-section"},Dr={class:"form-group"},Er={class:"form-row"},Ir={class:"form-row"},Ur={class:"form-row"},Cr={class:"form-row"},Tr={class:"form-row"},Rr={class:"form-group"},Or={class:"form-row"},Nr={class:"form-row"},zr={class:"tab-content"},Pr={class:"form-section"},Br={class:"form-group"},Mr={class:"form-row"},jr={class:"form-row"},xr={class:"form-group"},Fr={class:"form-row"},$r={class:"form-row"},Yr={class:"form-group"},qr={class:"form-row"},Kr={class:"form-row"},Gr={class:"form-row"},Xr={class:"form-row"},Hr={class:"form-row"},Wr={class:"tab-content"},Jr={class:"form-section"},Qr={class:"form-group"},Zr={class:"form-row"},eo={class:"form-row"},lo={class:"form-group"},ao={class:"form-row"},to={class:"form-row"},ro={class:"form-row"},oo={class:"form-group"},no={class:"form-row"},so={class:"form-row"},io={class:"form-group"},uo={class:"emergency-contact"},co={class:"form-row"},mo={class:"form-row"},po={class:"emergency-contact"},fo={class:"form-row"},vo={class:"form-row"},go={class:"form-group"},yo={class:"experience-list"},bo={class:"experience-header"},ho={class:"experience-title"},_o={class:"form-row"},Vo={class:"form-row"},wo={class:"form-group"},Ao={class:"experience-list"},So={class:"experience-header"},Lo={class:"experience-title"},ko={class:"form-row"},Do={class:"form-row"},Eo={class:"form-row"},Io={class:"form-group"},Uo={class:"experience-list"},Co={class:"experience-header"},To={class:"experience-title"},Ro={class:"form-row"},Oo={class:"form-row"},No={class:"form-row"},zo={class:"tab-content"},Po={class:"form-section"},Bo={class:"form-group"},Mo={class:"form-row"},jo={class:"form-group"},xo={class:"account-section"},Fo={class:"form-row"},$o={class:"account-section"},Yo={class:"form-row"},qo={class:"dialog-footer"},Ko={class:"bulk-import-header"},Go={class:"template-link"},Xo={class:"bulk-import-upload"},Ho={class:"bulk-import-form"},Wo={class:"bulk-import-section-title"},Jo={class:"bulk-import-header-code"},Qo={key:1,class:"bulk-import-optional-text"},Zo={key:0,class:"bulk-import-result"},en={class:"error-list"},ln={key:1,class:"bulk-import-preview"},an={key:0},tn={class:"reference-mapping-title"},rn={class:"reference-mapping-info"},on={class:"reference-mapping-value"},nn={class:"reference-mapping-rows"},sn={key:1,class:"reference-mapping-empty"},un="employee-import-template.csv",dn={__name:"EmployeeManagement",setup(Wl){var Kl,Gl;const oe=D(null),pl=x(()=>{const l=new Map;for(const e of G.value)if(e&&e.department){const a=Ul(e.department);a&&!l.has(e.department)&&l.set(e.department,a)}return Array.from(l.entries()).map(([e,a])=>({value:e,label:a}))}),de=x(()=>oe.value?G.value.filter(l=>l.department===oe.value):G.value);async function Pe(){if(typeof window<"u"&&window&&window.XLSX&&window.XLSX.utils)return window.XLSX;try{const l=await Bt(()=>import("./xlsx-DkH2s96g.js"),[]),e=l&&(l.default||l.XLSX)?l.default||l.XLSX:l;if(e&&e.utils&&e.read)return e}catch{}if(typeof window<"u"&&typeof document<"u"&&(await new Promise((l,e)=>{const a=document.querySelector("script[data-xlsx-cdn]");if(a){a.addEventListener("load",()=>l(null),{once:!0}),a.addEventListener("error",()=>e(new Error("XLSX_CDN_FAIL")),{once:!0});return}const r=document.createElement("script");r.src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js",r.async=!0,r.defer=!0,r.setAttribute("data-xlsx-cdn","1"),r.onload=()=>l(null),r.onerror=()=>e(new Error("XLSX_CDN_FAIL")),document.head.appendChild(r)}),window.XLSX&&window.XLSX.utils&&window.XLSX.read))return window.XLSX;throw new Error("XLSX_MODULE_INVALID_OR_NOT_FOUND")}function H(l=""){return l.replace(/^\uFEFF/,"")}function Jl(l){try{let e=new TextDecoder("utf-8",{fatal:!1}).decode(l);if(e.length>=2&&e.charCodeAt(0)===65279&&(e=H(e)),(e.slice(0,64).match(/\x00/g)||[]).length/Math.max(1,Math.min(64,e.length))>.2)throw new Error("maybe-utf16le");return H(e)}catch{try{return H(new TextDecoder("utf-16le",{fatal:!1}).decode(l))}catch{let e="";const a=new Uint8Array(l);for(let r=0;r<a.length;r++)e+=String.fromCharCode(a[r]);return H(e)}}}function Ql(l){const e=l.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(f=>f.length>0);if(!e.length)return[];const a=e[0],r=(a.match(/\t/g)||[]).length,d=(a.match(/,/g)||[]).length;return(r>d?"	":null)?e.map(f=>f.split("	")):[]}function Zl(l){const a=(typeof(l==null?void 0:l.name)=="string"?l.name:"").match(/\.([^.]+)$/i);return a?a[1].toLowerCase():""}async function ea(l){return l.arrayBuffer?await l.arrayBuffer():await new Promise((e,a)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=a,r.readAsArrayBuffer(l)})}function la(l){if(l==null||l==="")return"";const e=String(l).trim().replace(/\./g,"-").replace(/\//g,"-"),a=e.match(/^(\d{4})[-](\d{1,2})[-](\d{1,2})$/);if(!a)return e;const r=a[1],d=String(a[2]).padStart(2,"0"),c=String(a[3]).padStart(2,"0");return`${r}-${d}-${c}`}function aa(l){if(l==null||l==="")return"";const e=String(l).trim().toLowerCase();return["true","yes","y","1"].includes(e)?"TRUE":["false","no","n","0"].includes(e)?"FALSE":String(l)}function ta(l){return l==null||l===""?[]:String(l).split(",").map(e=>e.trim()).filter(Boolean)}function fl(l,e){if(!e)return[];const a=l.utils.sheet_to_json(e,{header:1,defval:""});if(!Array.isArray(a)||a.length===0)return[];const r=(a[0]||[]).map(f=>H(String(f??"").trim())),d=a.slice(2),c=[];for(const f of d){if(!Array.isArray(f)||f.every(s=>String(s??"").trim()===""))continue;const p={};for(let s=0;s<r.length;s++){const m=r[s]||`col_${s}`;p[m]=f[s]??""}c.push(p)}return c}function vl(l=""){return H(String(l)).trim().toLowerCase()}function Be(l=[]){const e=new Map(l.map(a=>[vl(a),a]));ne.forEach(a=>{const r=a.header||a.key,d=e.get(vl(r));d&&(C.columnMappings[a.key]=d)})}async function gl(l){var c,f;const e=await Pe(),a=await ea(l);try{const v=e.read(a,{type:"array",codepage:65001}),p=(c=v.SheetNames)==null?void 0:c[0],s=p?v.Sheets[p]:null,m=fl(e,s);if(m.length)return Be(Object.keys(m[0])),m}catch{}const r=Jl(a),d=Ql(r);if(d.length){const v=(d[0]||[]).map(y=>H(String(y??"").trim())),m=(d[1]||[]).some(y=>/必填|\(|\)|已婚|未婚|離婚|喪偶|TRUE|FALSE/.test(String(y||"")))?d.slice(2):d.slice(1);Be(v);const _=m.map(y=>{const V={};for(let I=0;I<v.length;I++)V[v[I]||`col_${I}`]=y[I]??"";return V}).filter(y=>Object.values(y).some(V=>String(V??"").trim()!==""));if(_.length)return _}try{const v=e.read(r,{type:"string"}),p=(f=v.SheetNames)==null?void 0:f[0],s=p?v.Sheets[p]:null,m=fl(e,s);if(m.length)return Be(Object.keys(m[0])),m}catch{}return[]}const yl=x(()=>(Q.value||[]).map(l=>({type:l,values:Array.isArray(F[l])?F[l]:[],options:Array.isArray(le[l])?le[l]:[]}))),ra=x(()=>yl.value.some(l=>l.values.length>0));function bl(l,e){const a={};for(const r of ne){const d=r.key,c=(e==null?void 0:e[d])||r.header,f=l[c];switch(d){case"birthday":case"hireDate":case"appointDate":case"resignDate":case"dismissDate":case"reAppointDate":case"reDismissDate":a[d]=la(f);break;case"isPartTime":case"isClocking":a[d]=aa(f);break;case"languages":case"identityCategory":case"salaryItems":a[d]=ta(f);break;case"laborPensionSelf":case"employeeAdvance":case"probationDays":case"dischargeYear":a[d]=f===""||f==null?"":String(f).replace(/[^\d.-]/g,"");break;default:a[d]=f??"";break}}return a}function oa(l,{rowOffset:e=0}={}){const a=[],r=ne.filter(d=>d.required).map(d=>d.key);return l.forEach((d,c)=>{const f=r.filter(v=>d[v]==null||String(d[v]).trim()==="");if(f.length){const v=f.map(s=>{const m=ne.find(_=>_.key===s);return(m==null?void 0:m.label)||(m==null?void 0:m.description)||(m==null?void 0:m.header)||s}).join("、"),p=c+1+e;a.push(`第 ${p} 列缺少必填欄位：${v}`)}}),a}function na(l){return l.map(e=>({employeeNo:e.employeeNo||e.employeeId||"",name:e.name||"",department:e.department||"",role:e.employmentStatus||e.status||"",email:e.email||""}))}async function sa(l){try{const e=Zl(l);if(!["xlsx","xls","csv"].includes(e))return N.warning("請上傳 .xlsx/.xls/.csv 檔案"),{ok:!1};const a=await gl(l);if(!a.length)return N.warning("檔案內容為空，或格式不符（請使用範本）"),{ok:!1};const r=a.map(f=>bl(f,C.columnMappings)),d=oa(r,{rowOffset:2}),c=na(r);return se.value=c,Y.value=d,{ok:!0}}catch(e){return console.error("解析匯入檔失敗：",e),N.error("解析匯入檔失敗，請確認檔案是否符合範本格式"),{ok:!1,error:e}}}async function ia(l){if(!((l==null?void 0:l.raw)||l))return;const a=W.value,r=ce.value.map(c=>({...c}));if(!!a&&a!==l.raw&&wl.value)try{await ml.confirm("重新選擇檔案將清除目前的預覽資料與參照對應設定，是否繼續？","確認更換匯入檔案",{type:"warning",confirmButtonText:"重新選擇",cancelButtonText:"保留現況"})}catch{ce.value=r;return}ol({resetMappings:!1,resetResolvedReferences:!0,referenceKeys:J}),W.value=l.raw,ce.value=[l],await sa(l.raw)}function ua(){ol({resetMappings:!1,resetResolvedReferences:!0,referenceKeys:J})}const da=Nt();function z(l){if(l==null)return"";if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return String(l);if(typeof l=="object"){const e=l.code??l.value??l.name??l.label??(typeof l.toString=="function"?l.toString():"");return typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):""}return""}function $(l=[]){return(Array.isArray(l)?l:[l]).map(a=>{if(a==null)return null;if(typeof a=="object"&&!Array.isArray(a)){const d=a.name??a.label??a.value??a.code??(typeof a.toString=="function"?a.toString():"");let c=a.code??a.value??"";if(!c&&d&&(c=d),!d&&!c)return null;const f=typeof c=="string"?c:String(c);return{label:d||f,value:f}}const r=String(a).trim();return r?{label:r,value:r}:null}).filter(Boolean)}function Me(l=[]){return(Array.isArray(l)?l:[]).map(e=>({...e}))}function ca(l,e=[]){if(!Array.isArray(l))return Me(e);const a=$(l);return a.length?a:Me(e)}function ee(l){return(Array.isArray(l)?l:l==null||l===""?[]:[l]).map(a=>z(a)).filter(a=>a!=="")}function ma(l,e){const a=z(e);if(!a)return"";const d=(Array.isArray(l==null?void 0:l.value)?l.value:Array.isArray(l)?l:[]).find(c=>c.value===a||c.label===a);return(d==null?void 0:d.label)??a}const Ie=[{label:"管理員",value:"admin"},{label:"主管",value:"supervisor"},{label:"員工",value:"employee"}],ne=Object.freeze([{key:"employeeNo",header:"employeeId",label:"員工編號",description:"員工編號",required:!0,category:"基本資料"},{key:"name",header:"name",label:"姓名",description:"姓名",required:!0,category:"基本資料"},{key:"gender",header:"gender",label:"性別",description:"性別 (M=男, F=女, O=其他)",category:"基本資料"},{key:"idNumber",header:"idNumber",label:"身分證號",description:"身分證號",category:"基本資料"},{key:"birthday",header:"birthDate",label:"生日",description:"生日 (yyyy-mm-dd)",category:"基本資料"},{key:"birthplace",header:"birthPlace",label:"出生地",description:"出生地",category:"基本資料"},{key:"bloodType",header:"bloodType",label:"血型",description:"血型 (A/B/O/AB/HR)",category:"基本資料"},{key:"languages",header:"languages",label:"語言",description:"語言 (多個以逗號分隔)",category:"個人特質"},{key:"disabilityLevel",header:"disabilityLevel",label:"失能等級",description:"失能等級",category:"個人特質"},{key:"identityCategory",header:"identityCategory",label:"身分類別",description:"身分類別 (多個以逗號分隔)",category:"個人特質"},{key:"maritalStatus",header:"maritalStatus",label:"婚姻狀況",description:"婚姻狀況 (已婚/未婚/離婚/喪偶)",category:"家庭狀況"},{key:"dependents",header:"dependents",label:"扶養人數",description:"扶養人數",category:"家庭狀況"},{key:"email",header:"email",label:"電子郵件",description:"電子郵件 (必填唯一)",required:!0,category:"聯絡資訊"},{key:"phone",header:"mobile",label:"手機號碼",description:"手機號碼",category:"聯絡資訊"},{key:"landline",header:"landline",label:"市話",description:"市話",category:"聯絡資訊"},{key:"householdAddress",header:"householdAddress",label:"戶籍地址",description:"戶籍地址",category:"聯絡資訊"},{key:"contactAddress",header:"contactAddress",label:"聯絡地址",description:"聯絡地址",category:"聯絡資訊"},{key:"lineId",header:"lineId",label:"Line 帳號",description:"Line 帳號",category:"聯絡資訊"},{key:"organization",header:"organization",label:"所屬機構",description:"所屬機構",category:"組織與職務"},{key:"department",header:"department",label:"部門 ID",description:"部門 ID",category:"組織與職務"},{key:"subDepartment",header:"subDepartment",label:"子部門 ID",description:"子部門 ID",category:"組織與職務"},{key:"supervisor",header:"supervisor",label:"主管員工 ID",description:"主管員工 ID",category:"組織與職務"},{key:"title",header:"title",label:"職稱",description:"職稱",category:"組織與職務"},{key:"practiceTitle",header:"practiceTitle",label:"執業職稱",description:"執業職稱",category:"組織與職務"},{key:"employmentStatus",header:"status",label:"人員狀態",description:"人員狀態 (正職員工/試用期/離職/留職停薪)",category:"雇用設定"},{key:"probationDays",header:"probationDays",label:"試用期天數",description:"試用期天數",category:"雇用設定"},{key:"isPartTime",header:"partTime",label:"是否兼職",description:"是否兼職 (TRUE/FALSE)",category:"雇用設定"},{key:"isClocking",header:"needClockIn",label:"是否需打卡",description:"是否需打卡 (TRUE/FALSE)",category:"雇用設定"},{key:"educationLevel",header:"education_level",label:"學歷程度",description:"學歷程度",category:"學歷資訊"},{key:"schoolName",header:"education_school",label:"畢業學校",description:"畢業學校",category:"學歷資訊"},{key:"major",header:"education_major",label:"主修科目",description:"主修科目",category:"學歷資訊"},{key:"graduationStatus",header:"education_status",label:"學歷狀態",description:"學歷狀態 (畢業/肄業)",category:"學歷資訊"},{key:"graduationYear",header:"education_graduationYear",label:"畢業年份",description:"畢業年份",category:"學歷資訊"},{key:"serviceType",header:"militaryService_type",label:"役別類型",description:"役別類型 (志願役/義務役)",category:"兵役資訊"},{key:"militaryBranch",header:"militaryService_branch",label:"軍種",description:"軍種",category:"兵役資訊"},{key:"militaryRank",header:"militaryService_rank",label:"軍階",description:"軍階",category:"兵役資訊"},{key:"dischargeYear",header:"militaryService_dischargeYear",label:"退伍年份",description:"退伍年份",category:"兵役資訊"},{key:"emergency1.name",header:"emergency1_name",label:"緊急聯絡人1 姓名",description:"緊急聯絡人1 姓名",category:"緊急聯絡人"},{key:"emergency1.relation",header:"emergency1_relation",label:"緊急聯絡人1 關係",description:"緊急聯絡人1 關係",category:"緊急聯絡人"},{key:"emergency1.phone1",header:"emergency1_phone1",label:"緊急聯絡人1 電話1",description:"緊急聯絡人1 電話1",category:"緊急聯絡人"},{key:"emergency1.phone2",header:"emergency1_phone2",label:"緊急聯絡人1 電話2",description:"緊急聯絡人1 電話2",category:"緊急聯絡人"},{key:"emergency2.name",header:"emergency2_name",label:"緊急聯絡人2 姓名",description:"緊急聯絡人2 姓名",category:"緊急聯絡人"},{key:"emergency2.relation",header:"emergency2_relation",label:"緊急聯絡人2 關係",description:"緊急聯絡人2 關係",category:"緊急聯絡人"},{key:"emergency2.phone1",header:"emergency2_phone1",label:"緊急聯絡人2 電話1",description:"緊急聯絡人2 電話1",category:"緊急聯絡人"},{key:"emergency2.phone2",header:"emergency2_phone2",label:"緊急聯絡人2 電話2",description:"緊急聯絡人2 電話2",category:"緊急聯絡人"},{key:"hireDate",header:"hireDate",label:"到職日期",description:"到職日期 (yyyy-mm-dd)",category:"任職期間"},{key:"appointDate",header:"startDate",label:"起聘日期",description:"起聘日期 (yyyy-mm-dd)",category:"任職期間"},{key:"resignDate",header:"resignationDate",label:"離職日期",description:"離職日期 (yyyy-mm-dd)",category:"任職期間"},{key:"dismissDate",header:"dismissalDate",label:"解聘日期",description:"解聘日期 (yyyy-mm-dd)",category:"任職期間"},{key:"reAppointDate",header:"rehireStartDate",label:"再任起聘",description:"再任起聘 (yyyy-mm-dd)",category:"任職期間"},{key:"reDismissDate",header:"rehireEndDate",label:"再任解聘",description:"再任解聘 (yyyy-mm-dd)",category:"任職期間"},{key:"employmentNote",header:"appointment_remark",label:"任職備註",description:"任職備註",category:"任職期間"},{key:"salaryType",header:"salaryType",label:"薪資類型",description:"薪資類型 (月薪/日薪/時薪)",category:"薪資與帳戶"},{key:"salaryAmount",header:"salaryAmount",label:"薪資金額",description:"薪資金額",category:"薪資與帳戶"},{key:"laborPensionSelf",header:"laborPensionSelf",label:"自提勞退 (%)",description:"自提勞退 (%)",category:"薪資與帳戶"},{key:"employeeAdvance",header:"employeeAdvance",label:"員工墊付金額",description:"員工墊付金額",category:"薪資與帳戶"},{key:"salaryAccountA.bank",header:"salaryAccountA_bank",label:"薪資帳戶A 銀行代號",description:"薪資帳戶A 銀行代號",category:"薪資與帳戶"},{key:"salaryAccountA.acct",header:"salaryAccountA_acct",label:"薪資帳戶A 帳號",description:"薪資帳戶A 帳號",category:"薪資與帳戶"},{key:"salaryAccountB.bank",header:"salaryAccountB_bank",label:"薪資帳戶B 銀行代號",description:"薪資帳戶B 銀行代號",category:"薪資與帳戶"},{key:"salaryAccountB.acct",header:"salaryAccountB_acct",label:"薪資帳戶B 帳號",description:"薪資帳戶B 帳號",category:"薪資與帳戶"},{key:"salaryItems",header:"salaryItems",label:"其他薪資項目",description:"其他薪資項目 (多個逗號分隔)",category:"薪資與帳戶"}]);function pa(l={}){const e=l.description||l.label||l.header||l.key||"";if(!l.required)return typeof e=="string"?e:String(e);const a=typeof e=="string"?e:String(e);return a.includes("必填")?a:`${a} (必填)`}const fa=ne.filter(l=>l.required).map(l=>l.key),be=Object.freeze(ne.reduce((l,e)=>(l[e.key]=e.header,l),{})),va=Object.freeze([{employeeId:"EMP-0001",name:"王曉明",gender:"M",birthDate:"1990-03-12",email:"import.hr001@example.com",mobile:"0912000001",organization:"總公司",department:"HR001",title:"人資專員",status:"正職員工",hireDate:"2020-07-01",partTime:"FALSE",needClockIn:"TRUE",lineId:"hr-king",languages:"中文,英文"},{employeeId:"EMP-0002",name:"林語彤",gender:"F",birthDate:"1994-08-25",email:"import.hr002@example.com",mobile:"0912000002",organization:"台北院區",department:"NUR101",title:"資深護理師",status:"試用期",hireDate:"2024-02-15",partTime:"FALSE",needClockIn:"TRUE",lineId:"nurse-ruby",languages:"中文,台語"},{employeeId:"EMP-0003",name:"陳建宇",gender:"M",birthDate:"1988-11-05",email:"import.hr003@example.com",mobile:"0912000003",organization:"總公司",department:"IT001",title:"系統工程師",status:"正職員工",hireDate:"2019-11-20",partTime:"FALSE",needClockIn:"FALSE",lineId:"it-jack",languages:"中文,英文"},{employeeId:"EMP-0004",name:"吳雅珊",gender:"F",birthDate:"1992-01-18",email:"import.hr004@example.com",mobile:"0912000004",organization:"總公司",department:"FIN201",title:"會計專員",status:"留職停薪",hireDate:"2018-04-09",partTime:"TRUE",needClockIn:"FALSE",lineId:"fin-olivia",languages:"中文,英文"},{employeeId:"EMP-0005",name:"張志強",gender:"M",birthDate:"1985-06-30",email:"import.hr005@example.com",mobile:"0912000005",organization:"新北院區",department:"OPS301",title:"營運主管",status:"離職",hireDate:"2016-01-03",resignationDate:"2023-12-31",partTime:"FALSE",needClockIn:"TRUE",lineId:"ops-alex",languages:"中文,英文"}]),Ue=x(()=>ne.map(l=>({...l,displayDescription:pa(l)}))),hl=[{level:"L1",description:"一般使用者 / 基層專員"},{level:"L2",description:"資深專員 / 小組長"},{level:"L3",description:"部門主管 / 課長"},{level:"L4",description:"處室主管 / 協理"},{level:"L5",description:"高階決策者 / 最高主管"}],Ce=D([]),je=D([]),xe=D([]),Fe=D([]),$e=D([]),Ye=D([]),qe=D([]),Ke=D([]),_l=D([]),he=D([]),Ge=((Kl=Ie.find(l=>l.value==="employee"))==null?void 0:Kl.value)??((Gl=Ie[0])==null?void 0:Gl.value)??"",_e=D(!1),Ve=D(null),we=D(!1),W=D(null),ce=D([]),se=D([]),Y=D([]),C=ye({columnMappings:{...be},options:{defaultRole:Ge,resetPassword:"",sendWelcomeEmail:!1}}),J=Object.freeze(["organization","department","subDepartment"]),Vl=Object.freeze({organization:"機構",department:"部門",subDepartment:"子部門"}),ga=Object.freeze({organization:["organization","org","organizations"],department:["department","dept","departments"],subDepartment:["subDepartment","subdept","sub_department","subDepartments"]}),ya=Object.freeze(Object.entries(ga).reduce((l,[e,a])=>((Array.isArray(a)?a:[]).concat(e).forEach(d=>{typeof d=="string"&&d.trim()&&(l[d.trim().toLowerCase()]=e)}),l),{})),K=D(!1),Ae=D(""),Q=D([...J]),F=ye({}),le=ye({}),q=ye({}),B=ye({}),M=ye({}),me=D(!1),wl=x(()=>{const l=!!W.value,e=(ce.value||[]).length>0,a=(se.value||[]).length>0,r=(Y.value||[]).length>0,d=K.value,c=!!Ae.value,f=Q.value.some(y=>(F[y]||[]).length>0),v=Object.values(B).some(y=>Object.keys(y||{}).length>0)||Object.values(M).some(y=>Array.isArray(y)&&y.length>0),p=Object.keys(be),s=new Set([...p,...Object.keys(C.columnMappings)]),m=Array.from(s).some(y=>{const V=C.columnMappings[y]??"",I=be[y]??"";return V!==I}),_=C.options.defaultRole!==Ge||!!C.options.resetPassword||!!C.options.sendWelcomeEmail;return l||e||a||r||d||c||f||v||m||_});Xe(J,{resetPending:!0,resetOptions:!0,resetSelections:!0,resetResolved:!0});function Se(l){Array.isArray(F[l])||(F[l]=[]),Array.isArray(le[l])||(le[l]=[]),(!q[l]||typeof q[l]!="object")&&(q[l]={}),(!B[l]||typeof B[l]!="object")&&(B[l]={}),Array.isArray(M[l])||(M[l]=[])}function Xe(l=[],{resetPending:e=!1,resetOptions:a=!1,resetSelections:r=!1,resetResolved:d=!1}={}){const c=new Set([...J,...Array.isArray(l)?l:[]]);Q.value=Array.from(c),[F,le,q].forEach(p=>{Object.keys(p).forEach(s=>{c.has(s)||delete p[s]})}),[B,M].forEach(p=>{Object.keys(p).forEach(s=>{c.has(s)||delete p[s]})}),Q.value.forEach(p=>{Se(p),e&&(F[p]=[]),a&&(le[p]=[]),r&&(q[p]={}),d&&(B[p]={},M[p]=[])})}function ba(l){if(l&&Vl[l])return Vl[l];const e=typeof l=="string"?l:"";if(!e.trim())return"其他參照";const a=e.replace(/[_-]+/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").trim();return a.charAt(0).toUpperCase()+a.slice(1)}const ha=x(()=>{const l=new Map;return Ue.value.forEach(e=>{const a=e.category||"其他欄位";l.has(a)||l.set(a,[]),l.get(a).push(e)}),Array.from(l.entries()).map(([e,a])=>({title:e,fields:a}))}),_a=x(()=>Ue.value.filter(l=>l.required).map(l=>l.label||l.description||l.header)),Va=x(()=>fa.filter(l=>{const e=C.columnMappings[l];return typeof e!="string"||!e.trim()}));function wa(l){return l==null?'""':`"${String(l).replace(/"/g,'""')}"`}function Aa(){const l=Ue.value.map(c=>c.header||c.key),e=Ue.value.map(c=>c.displayDescription||c.description||c.label||c.header||c.key),a=va.map(c=>l.map(f=>c[f]??""));return`\uFEFF${[l,e,...a].map(c=>c.map(wa).join(",")).join(`
`)}`}function Sa(){if(typeof window>"u"||typeof document>"u")return;const l=Aa(),e=new Blob([l],{type:"text/csv;charset=utf-8;"}),a=window.URL&&typeof window.URL.createObjectURL=="function"&&window.URL||(typeof URL<"u"&&typeof URL.createObjectURL=="function"?URL:null);if(!a){N.warning("無法產生範本下載，請改用手動建立檔案");return}const r=a.createObjectURL(e),d=document.createElement("a");d.href=r,d.setAttribute("download",un),document.body.appendChild(d);try{d.click()}finally{document.body.removeChild(d),typeof a.revokeObjectURL=="function"&&a.revokeObjectURL(r)}}const Al=x(()=>!!W.value&&Va.value.length===0),La=$(["護理師","照顧服務員","社工師","物理治療師","職能治療師","行政人員"]),ka=$(["護理師","社工師","物理治療師","職能治療師","醫師"]),Da=$(["中文","台語","客語","英語","馬來語"]),Ea=$(["極重度","重度身心障礙","中度身心障礙","輕度身心障礙"]),Ia=$(["原住民","新住民","榮民"]),Ua=$(["博士","碩士","大學","專科","高中職","國中以下"]),Ca=$(["畢業","肄業"]),Ta=$(["父","母","配偶","子","女","兄","姊","弟","妹","其他"]),Ra=$(["院內","院外","線上","研討會","自學"]),Oa=$(["本薪","全勤","加班費","交通津貼","伙食津貼","績效獎金"]),Sl=[{key:"C03",ref:Ce,fallback:La,label:"職稱"},{key:"C04",ref:je,fallback:ka,label:"執業職稱"},{key:"C05",ref:xe,fallback:Da,label:"語言能力"},{key:"C06",ref:Fe,fallback:Ea,label:"身心障礙等級"},{key:"C07",ref:$e,fallback:Ia,label:"身分類別"},{key:"C08",ref:Ye,fallback:Ua,label:"教育程度"},{key:"C08-1",ref:qe,fallback:Ca,label:"畢業狀態"},{key:"C09",ref:Ke,fallback:Ta,label:"緊急聯絡人稱謂"},{key:"C10",ref:_l,fallback:Ra,label:"教育訓練積分類別"},{key:"C14",ref:he,fallback:Oa,label:"津貼項目"}],Na=new Set(["C08-1"]);function He({notify:l=!0}={}){const e=[];return Sl.forEach(({ref:a,fallback:r,label:d})=>{(!Array.isArray(a.value)||a.value.length===0)&&(a.value=Me(r),e.push(d))}),l&&e.length&&N.warning(`字典 ${e.join("、")} 尚未設定，已套用預設選項`),e}const za=["月薪","日薪","時薪"],Te=[{id:"R001",label:"填報",description:"提出申請與初始資料填寫"},{id:"R002",label:"覆核",description:"確認申請內容與佐證完整性"},{id:"R003",label:"審核",description:"評估申請是否符合政策與規範"},{id:"R004",label:"核定",description:"做出最終核准或駁回決策"},{id:"R005",label:"知會",description:"接收流程進度並保留紀錄"},{id:"R006",label:"財務覆核",description:"檢視成本預算與財務影響"},{id:"R007",label:"人資覆核",description:"確保人事政策與法規符合"}],We=[{id:"U001",label:"L1",description:"單位承辦或第一層主管"},{id:"U002",label:"L2",description:"部門主管或組長"},{id:"U003",label:"L3",description:"處室主管或經理"},{id:"U004",label:"L4",description:"高階主管或副執行長"},{id:"U005",label:"L5",description:"執行長 / 院長 / 董事會"}],Pa=["資深","新人","外聘","志工"],Ba=["義務役","志願役","替代役","免役","尚未服役"],Ll=["A","B","O","AB","HR"],Ma=new Date().getFullYear(),ja=new Set(Te.map(l=>l.id)),kl=new Map(Te.map(l=>[l.label,l.id]));["填報人員","覆核人員","審核人員","核定人員","知會人員","財務覆核人員","人資覆核人員"].forEach((l,e)=>{const a=Te[e];a&&kl.set(l,a.id)});const xa=new Set(We.map(l=>l.id)),Fa=new Map(We.map(l=>[l.label,l.id])),$a=new Set(hl.map(l=>l.level)),Ya=new Map([["一級","L1"],["二級","L2"],["三級","L3"],["四級","L4"],["五級","L5"],["一般職等","L1"],["資深職等","L2"],["主管職等","L3"]]);function Dl(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?ja.has(e)?e:kl.get(e)??e:""}return l}function El(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?xa.has(e)?e:Fa.get(e)??e:""}return l}function Il(l){if(!l&&l!==0)return"";if(typeof l=="string"){const e=l.trim();return e?$a.has(e)?e:Ya.get(e)??e:""}return l}function qa(l){return l?`${l.level}｜${l.description}`:""}function Ka(l){return l?`${l.id}｜${l.label}`:""}const Je=D("account"),G=D([]),ae=D([]),ie=D([]),pe=D([]),Le=D(!1),Qe=D(!1);let Re=null,Ze="";function Ul(l){const e=ae.value.find(a=>a._id===l);return e?`${e.name}(${e.code})`:l}function Ga(l={}){return(l==null?void 0:l._id)??(l==null?void 0:l.id)??(l==null?void 0:l.value)??(l==null?void 0:l.code)??(typeof l=="string"?l:"")}function ke(l){return l.status===401?(N.error("登入逾時，請重新登入"),da.push("/manager/login"),!0):!1}function Cl(l){return new Promise((e,a)=>{const r=new FileReader;r.onload=()=>e(typeof r.result=="string"?r.result:""),r.onerror=()=>a(new Error("READ_ERROR")),r.readAsDataURL(l)})}function Tl(l=[]){const e=l.slice(-1).map(a=>{var c;const r=a.response,d=typeof r=="object"&&r!==null&&"url"in r&&r.url||typeof r=="object"&&r!==null&&"data"in r&&((c=r.data)==null?void 0:c.url)||(typeof r=="string"?r:"");return{...a,url:a.url||d||"",status:"success",percentage:a.percentage??100}});n.value.photoList=e,n.value.photo=e.length&&e[0].url||""}async function Xa({file:l,onSuccess:e,onError:a}){Qe.value=!0;try{const r=await Cl(l);e==null||e({url:r})}catch(r){a==null||a(r),N.error("照片載入失敗，請重新選擇檔案")}finally{Qe.value=!1}}function Ha(l,e,a){var r;e.url||(typeof l=="string"?e.url=l:l&&typeof l=="object"&&(e.url=l.url||((r=l==null?void 0:l.data)==null?void 0:r.url)||e.url||"")),Tl(a)}function Wa(l,e){Tl(e)}function Ja(){N.warning("僅能上傳一張照片")}function Qa(l,e=""){return l?{name:e?`${e} 照片`:"員工照片",url:l,status:"success",percentage:100}:null}function el(l=[]){return(Array.isArray(l)?l:[l]).map(e=>{var r;if(!e)return"";if(typeof e=="string")return e;if(e.url)return e.url;const a=e.response;if(typeof a=="string")return a;if(typeof a=="object"&&a!==null){if("url"in a&&a.url)return a.url;if("data"in a&&((r=a.data)!=null&&r.url))return a.data.url}return""}).filter(e=>typeof e=="string"&&e)}function Za(l=[]){return el(l)}function Rl(l=[],e="附件"){return(Array.isArray(l)?l:[l]).map((a,r)=>{var d;if(!a)return null;if(typeof a=="string")return{name:`${e}${r+1}`,url:a,status:"success",percentage:100,uid:`${e}-${r}`};if(typeof a=="object"){let c=a.url;if(!c){const v=a.response;typeof v=="string"?c=v:v&&typeof v=="object"&&(c=v.url||((d=v==null?void 0:v.data)==null?void 0:d.url)||"")}if(!c)return null;const f={...a,name:a.name||`${e}${r+1}`,url:c,status:"success",percentage:a.percentage??100};return f.uid||(f.uid=`${e}-${r}`),f}return null}).filter(a=>a&&typeof a.url=="string"&&a.url)}function Ol(l,e="附件"){if(!l)return[];const a=Array.isArray(l)?l:[l];return Rl(a,e)}function Oe(l){return Array.isArray(l)?l.filter(e=>e!==""&&e!==null&&e!==void 0):l===""||l===null||l===void 0?[]:[l]}function fe(l){return l===""||l===null||l===void 0?"":typeof l=="string"?l:String(l)}function Nl(){const l=Array.isArray(he.value)?he.value:[];return new Set(l.map(e=>{if(e&&typeof e=="object"){const a=e.value??e.code??e.name??e.label??(typeof e.toString=="function"?e.toString():"");return fe(a)}return fe(e)}).filter(Boolean))}function De(l){const e=Nl();return Oe(l).map(fe).filter(a=>e.has(a))}function Ne(l=[],e=[]){return l.length!==e.length?!1:l.every((a,r)=>a===e[r])}function et(l,e){return l==="licenses"?`證照${e+1}-附件`:`教育訓練${e+1}-附件`}function zl(l,e,a){const r=l==="licenses"?n.value.licenses:n.value.trainings;if(!Array.isArray(r)||!r[e])return;const d=et(l,e);r[e].fileList=Rl(a,d)}async function Pl({file:l,onSuccess:e,onError:a}){try{const r=await Cl(l);e==null||e({url:r})}catch(r){a==null||a(r),N.error("檔案載入失敗，請重新選擇")}}function Bl(l,e,a,r,d){var c;r.url||(typeof a=="string"?r.url=a:a&&typeof a=="object"&&(r.url=a.url||((c=a==null?void 0:a.data)==null?void 0:c.url)||r.url||"")),zl(l,e,d)}function Ml(l,e,a,r){zl(l,e,r)}function P(l){if(l===""||l===null||l===void 0)return null;const e=Number(l);return Number.isFinite(e)?e:null}function ll(l){return l==null?"":String(l)}function ve(l){return l==null||l===""?"":l}function lt(l=[]){return Array.isArray(l)?l.map((e={},a)=>({name:(e==null?void 0:e.name)??"",number:(e==null?void 0:e.number)??"",startDate:(e==null?void 0:e.startDate)??(e==null?void 0:e.issueDate)??"",endDate:(e==null?void 0:e.endDate)??(e==null?void 0:e.expiryDate)??"",fileList:Ol((e==null?void 0:e.fileList)??(e==null?void 0:e.files)??(e!=null&&e.file?[e.file]:[]),`證照${a+1}-附件`)})):[]}function at(l=[]){return Array.isArray(l)?l.map((e={},a)=>({course:(e==null?void 0:e.course)??(e==null?void 0:e.name)??"",courseNo:(e==null?void 0:e.courseNo)??(e==null?void 0:e.code)??"",date:(e==null?void 0:e.date)??"",category:ee((e==null?void 0:e.category)??(e==null?void 0:e.categories)),score:P(e==null?void 0:e.score),fileList:Ol((e==null?void 0:e.fileList)??(e==null?void 0:e.files)??(e!=null&&e.file?[e.file]:[]),`教育訓練${a+1}-附件`)})):[]}async function tt(){try{const l=await re("/api/other-control-settings/item-settings");if(ke(l))return;if(!l.ok)throw new Error(`ITEM_SETTINGS_FETCH_FAILED_${l.status}`);const e=await l.json(),a=e!=null&&e.itemSettings&&typeof e.itemSettings=="object"?e.itemSettings:e&&typeof e=="object"&&!Array.isArray(e)?e:{},r=[];Sl.forEach(({key:c,ref:f,fallback:v,label:p})=>{const s=a==null?void 0:a[c];(!Array.isArray(s)||!s.length)&&!Na.has(c)&&r.push(p),f.value=ca(s,v)});const d=[...new Set(r)].filter(Boolean);d.length&&N.warning(`字典 ${d.join("、")} 尚未設定，已套用預設選項`)}catch(l){console.warn("載入字典項目失敗：",l),He()}}async function jl(){const l=await re("/api/departments");ke(l)||l.ok&&(ae.value=await l.json())}async function al(l=""){const e=l?`/api/sub-departments?department=${l}`:"/api/sub-departments",a=await re(e);ke(a)||a.ok&&(ie.value=await a.json())}async function rt(){const l=await re("/api/organizations");ke(l)||l.ok&&(pe.value=await l.json())}async function tl(){const l=await re("/api/employees");if(!ke(l)&&l.ok){const e=await l.json();G.value=e.map(a=>{var d,c,f,v,p,s,m,_,y,V,I,w,U,O,j;const r=(a==null?void 0:a.appointment)??{};return{...a,title:z(a==null?void 0:a.title),practiceTitle:z(a==null?void 0:a.practiceTitle),languages:ee(a==null?void 0:a.languages),disabilityLevel:z(a==null?void 0:a.disabilityLevel),identityCategory:ee(a==null?void 0:a.identityCategory),permissionGrade:Il(a==null?void 0:a.permissionGrade),signRole:Dl(a==null?void 0:a.signRole),signLevel:El(a==null?void 0:a.signLevel),organization:((d=a.organization)==null?void 0:d._id)||a.organization||"",department:((c=a.department)==null?void 0:c._id)||a.department||"",subDepartment:((f=a.subDepartment)==null?void 0:f._id)||a.subDepartment||"",laborPensionSelf:P(a==null?void 0:a.laborPensionSelf)??0,employeeAdvance:P(a==null?void 0:a.employeeAdvance)??0,salaryItems:De(a==null?void 0:a.salaryItems),height:P(((v=a==null?void 0:a.medicalCheck)==null?void 0:v.height)??(a==null?void 0:a.height)),weight:P(((p=a==null?void 0:a.medicalCheck)==null?void 0:p.weight)??(a==null?void 0:a.weight)),medicalBloodType:((s=a==null?void 0:a.medicalCheck)==null?void 0:s.bloodType)??(a==null?void 0:a.medicalBloodType)??"",educationLevel:z(((m=a==null?void 0:a.education)==null?void 0:m.level)??(a==null?void 0:a.educationLevel)),schoolName:((_=a==null?void 0:a.education)==null?void 0:_.school)??(a==null?void 0:a.schoolName)??"",major:((y=a==null?void 0:a.education)==null?void 0:y.major)??(a==null?void 0:a.major)??"",graduationStatus:z(((V=a==null?void 0:a.education)==null?void 0:V.status)??(a==null?void 0:a.graduationStatus)),graduationYear:ll(((I=a==null?void 0:a.education)==null?void 0:I.graduationYear)??(a==null?void 0:a.graduationYear)??""),serviceType:((w=a==null?void 0:a.militaryService)==null?void 0:w.serviceType)??(a==null?void 0:a.serviceType)??"",militaryBranch:((U=a==null?void 0:a.militaryService)==null?void 0:U.branch)??(a==null?void 0:a.militaryBranch)??"",militaryRank:((O=a==null?void 0:a.militaryService)==null?void 0:O.rank)??(a==null?void 0:a.militaryRank)??"",dischargeYear:P(((j=a==null?void 0:a.militaryService)==null?void 0:j.dischargeYear)??(a==null?void 0:a.dischargeYear)),hireDate:ve((r==null?void 0:r.hireDate)??(a==null?void 0:a.hireDate)),appointDate:ve((r==null?void 0:r.appointDate)??(r==null?void 0:r.startDate)??(a==null?void 0:a.appointDate)),resignDate:ve((r==null?void 0:r.resignationDate)??(a==null?void 0:a.resignDate)),dismissDate:ve((r==null?void 0:r.dismissalDate)??(a==null?void 0:a.dismissDate)),reAppointDate:ve((r==null?void 0:r.reAppointDate)??(r==null?void 0:r.rehireStartDate)??(a==null?void 0:a.reAppointDate)),reDismissDate:ve((r==null?void 0:r.reDismissDate)??(r==null?void 0:r.rehireEndDate)??(a==null?void 0:a.reDismissDate)),employmentNote:ll((r==null?void 0:r.remark)??(a==null?void 0:a.employmentNote)??"")}})}}zt(()=>{He({notify:!1}),tt(),jl(),tl(),rt(),al()});const rl={username:"",password:"",role:"employee",permissionGrade:"",signRole:"",signTags:[],signLevel:"",employeeNo:"",name:"",gender:"",birthday:"",idNumber:"",birthplace:"",bloodType:"",languages:[],disabilityLevel:"",identityCategory:[],maritalStatus:"",dependents:0,email:"",phone:"",landline:"",householdAddress:"",contactAddress:"",lineId:"",photo:"",photoList:[],organization:"",department:"",supervisor:null,subDepartment:"",title:"",practiceTitle:"",isPartTime:!1,isClocking:!1,employmentStatus:"",probationDays:"",height:null,weight:null,medicalBloodType:"",educationLevel:"",schoolName:"",major:"",graduationStatus:"",graduationYear:"",serviceType:"",militaryBranch:"",militaryRank:"",dischargeYear:null,emergency1:{name:"",relation:"",phone1:"",phone2:""},emergency2:{name:"",relation:"",phone1:"",phone2:""},keywords:"",experiences:[],licenses:[],trainings:[],hireDate:"",appointDate:"",resignDate:"",dismissDate:"",reAppointDate:"",reDismissDate:"",employmentNote:"",salaryType:"",salaryAmount:0,laborPensionSelf:0,employeeAdvance:0,salaryAccountA:{bank:"",acct:""},salaryAccountB:{bank:"",acct:""},salaryItems:[]},n=D({...rl}),xl=D(),Fl=l=>({validator:(e,a)=>a===""||a===null||a===void 0?Promise.resolve():typeof a!="number"||!Number.isFinite(a)||a<0?Promise.reject(new Error(`請輸入正確的${l}`)):Promise.resolve(),trigger:["blur","change"]}),ot={username:[{required:!0,message:"請輸入登入帳號",trigger:"blur"}],password:[{required:!0,message:"請輸入登入密碼",trigger:"blur"}],role:[{required:!0,message:"請選擇系統權限",trigger:"change"}],organization:[{required:!0,message:"請選擇所屬機構",trigger:"change"}],department:[{required:!0,message:"請選擇所屬部門",trigger:"change"}],gender:[{required:!0,message:"請選擇性別",trigger:"change"}],name:[{required:!0,message:"請輸入員工姓名",trigger:"blur"}],email:[{required:!0,message:"請輸入有效 Email",type:"email",trigger:["blur","change"]}],laborPensionSelf:[Fl("勞退自提")],employeeAdvance:[Fl("員工預支")],salaryItems:[{validator:(l,e)=>{if(e===""||e===null||e===void 0)return Promise.resolve();if(!Array.isArray(e))return Promise.reject(new Error("請選擇有效的薪資項目"));const a=Nl();return Oe(e).map(fe).some(c=>!a.has(c))?Promise.reject(new Error("請選擇有效的薪資項目")):Promise.resolve()},trigger:"change"}]},nt=x(()=>n.value.organization?ae.value.filter(l=>l.organization===n.value.organization):[]),st=x(()=>n.value.department?ie.value.filter(l=>l.department===n.value.department):[]),it=x(()=>n.value.organization&&n.value.department?G.value.filter(l=>l.role==="supervisor"&&l.organization===n.value.organization&&l.department===n.value.department):[]);Ee(_e,l=>{l?Ve.value=null:Ve.value&&(ol(Ve.value),Ve.value=null)}),Ee(()=>n.value.department,async(l,e)=>{const a=n.value.subDepartment;if(!l){ie.value=[],n.value.subDepartment&&(n.value.subDepartment="");return}if(await al(l),n.value.department!==l)return;const r=n.value.subDepartment===a;!(!!a&&ie.value.some(f=>Ga(f)===a))&&l!==e&&r&&(n.value.subDepartment="")}),Ee(()=>n.value.salaryItems,l=>{const e=Oe(l),a=e.map(fe),r=De(a);Ne(r,a)?Ne(a,e)||(n.value.salaryItems=a):n.value.salaryItems=r},{deep:!0}),Ee(()=>he.value,()=>{const l=Oe(n.value.salaryItems),e=l.map(fe),a=De(e);Ne(a,e)?Ne(e,l)||(n.value.salaryItems=e):n.value.salaryItems=a},{deep:!0});function ut(){n.value.graduationStatus=""}function dt(){_e.value=!0}async function $l({resetMappings:l=!0,done:e}={}){if(wl.value)try{await ml.confirm("關閉後將清除目前的匯入檔案、預覽與對應設定，確定要離開？","確認關閉匯入",{type:"warning",confirmButtonText:"確認關閉",cancelButtonText:"繼續編輯"})}catch{return!1}return Ve.value={resetMappings:l,resetReferenceData:!0,resetResolvedReferences:!0},typeof e=="function"?e():_e.value=!1,!0}async function ct(){await $l()}async function mt(l){await $l({done:l})}function ol({resetMappings:l=!0,resetFile:e=!0,resetPreview:a=!0,resetErrors:r=!0,resetUploadList:d=!0,resetReferenceDialogs:c=!0,resetReferenceData:f=!0,resetResolvedReferences:v=l,resetOptions:p=l,referenceKeys:s}={}){if(we.value=!1,e&&(W.value=null),d&&(ce.value=[]),a&&(se.value=[]),r&&(Y.value=[]),c&&(K.value=!1,Ae.value="",me.value=!1),f){const m=Array.isArray(s)?s:l?J:Q.value;Xe(m,{resetPending:!0,resetOptions:!0,resetSelections:!0,resetResolved:v})}l&&(Object.keys(C.columnMappings).forEach(m=>{m in be||delete C.columnMappings[m]}),Object.entries(be).forEach(([m,_])=>{C.columnMappings[m]=_})),p&&(C.options.defaultRole=Ge,C.options.resetPassword="",C.options.sendWelcomeEmail=!1)}function te(l){return l==null?"":typeof l=="string"?l.trim().toLowerCase():String(l).trim().toLowerCase()}function Yl(l=[]){const e=new Set,a=[];return l.forEach(r=>{const d=te(r);!d||e.has(d)||(e.add(d),a.push(d))}),a}function pt(){const l={},e={};return new Set([...Q.value,...Object.keys(B),...Object.keys(M)]).forEach(r=>{Se(r),l[r]={},Object.entries(B[r]||{}).forEach(([d,c])=>{typeof c=="string"&&c.trim()&&(l[r][d]=c)}),e[r]=Yl(M[r])}),{valueMappingsPayload:l,ignorePayload:e}}function Z(l){return l?l.normalizedValue?l.normalizedValue:te(l.value):""}function nl(l=""){const e=String(l).trim();return/^[a-fA-F0-9]{24}$/.test(e)||/^object_[a-fA-F0-9]{24}$/.test(e)}function ft(l,e){if(!e||typeof e!="object")return"";if(l==="organization"){const d=[e.name,e.unitName,e.orgCode,e.systemCode].filter(Boolean);if(d.length)return d.join(" / ")}if(l==="department"){const d=[e.organizationName,e.organizationCode,e.organizationUnitName].map(v=>v==null?"":String(v).trim()).filter(Boolean),c=[e.name,e.code].filter(Boolean),f=[];if(d.length&&f.push(d.join("｜")),c.length&&f.push(c.join("｜")),!f.length&&e.organization&&f.push(String(e.organization)),f.length)return f.join(" / ")}if(l==="subDepartment"){const d=[e.organizationName,e.organizationCode,e.organizationUnitName].map(p=>p==null?"":String(p).trim()).filter(Boolean),c=[e.departmentName,e.departmentCode].map(p=>p==null?"":String(p).trim()).filter(Boolean),f=[e.name,e.code].filter(Boolean),v=[];if(d.length&&v.push(d.join("｜")),c.length&&v.push(c.join("｜")),f.length&&v.push(f.join("｜")),!v.length&&e.department&&v.push(String(e.department)),v.length)return v.join(" / ")}const r=[e.label,e.name,e.title,e.code,e.value,e.id].map(d=>d==null?"":String(d).trim()).filter(Boolean).find(d=>d)||"";return r?nl(r)&&![e.label,e.name,e.title,e.code,e.value].map(c=>c==null?"":String(c).trim()).some(c=>c&&!nl(c))?"（缺少可辨識的標籤）":r:""}function sl(l=""){return String(l).normalize("NFKC").replace(/^\uFEFF/,"").trim().toLowerCase()}function vt(l,e){const a=new Set;return e.forEach(r=>{const d=l==null?void 0:l[r];d!=null&&String(d).trim()!==""&&a.add(sl(d))}),a}function gt(l=[],e=["name","code","id","orgCode","unitName","systemCode"]){const a=new Map;return(l||[]).forEach(r=>{vt(r,e).forEach(d=>{d&&!a.has(d)&&a.set(d,r)})}),a}function ze(l){const e=new Map((pe.value||[]).map(r=>{const d=(r==null?void 0:r._id)??(r==null?void 0:r.id);return[d==null?"":String(d),r]})),a=new Map((ae.value||[]).map(r=>{const d=(r==null?void 0:r._id)??(r==null?void 0:r.id);return[d==null?"":String(d),{...r,organization:(r==null?void 0:r.organization)??""}]}));return l==="organization"?(pe.value||[]).map(r=>({id:r._id??r.id??"",name:r.name??"",orgCode:r.orgCode??r.code??"",unitName:r.unitName??""})):l==="department"?(ae.value||[]).map(r=>{var d,c,f;return{id:r._id??r.id??"",name:r.name??"",code:r.code??"",organization:r.organization??"",organizationName:((d=e.get(String(r.organization??"")))==null?void 0:d.name)??"",organizationUnitName:((c=e.get(String(r.organization??"")))==null?void 0:c.unitName)??"",organizationCode:((f=e.get(String(r.organization??"")))==null?void 0:f.orgCode)??""}}):l==="subDepartment"?(ie.value||[]).map(r=>{var d,c,f;return{id:r._id??r.id??"",name:r.name??"",code:r.code??"",department:r.department??"",departmentName:((d=a.get(String(r.department??"")))==null?void 0:d.name)??"",departmentCode:((c=a.get(String(r.department??"")))==null?void 0:c.code)??"",organization:((f=a.get(String(r.department??"")))==null?void 0:f.organization)??r.organization??"",organizationName:(()=>{var s;const v=a.get(String(r.department??"")),p=(v==null?void 0:v.organization)??r.organization??"";return((s=e.get(String(p)))==null?void 0:s.name)??""})(),organizationUnitName:(()=>{var s;const v=a.get(String(r.department??"")),p=(v==null?void 0:v.organization)??r.organization??"";return((s=e.get(String(p)))==null?void 0:s.unitName)??""})(),organizationCode:(()=>{var s;const v=a.get(String(r.department??"")),p=(v==null?void 0:v.organization)??r.organization??"";return((s=e.get(String(p)))==null?void 0:s.orgCode)??""})()}}):[]}function yt(l={}){const e=Object.keys(l||{}),a={};return e.forEach(r=>{const d=l[r]||{},c=Array.isArray(d.values)?d.values:[],f=Array.isArray(d.options)&&d.options.length?d.options:ze(r);let v=["id","code","name"];r==="organization"&&(v=["id","orgCode","name","unitName","systemCode"]);const p=gt(f,v);c.forEach(s=>{const m=(s==null?void 0:s.value)??"",_=(s==null?void 0:s.normalizedValue)||sl(m);if(!_)return;const y=p.get(_)||p.get(sl(String(m)));y!=null&&y.id?(Se(r),B[r]||(B[r]={}),B[r][_]=String(y.id),M[r]=(M[r]||[]).filter(V=>V!==_)):(a[r]||(a[r]={values:[],options:f}),a[r].values.push(s))}),a[r]&&a[r].values.length===0&&delete a[r]}),{unresolved:a,keysUsed:e}}function bt(l={}){const e={},a=new Set(J);function r(d={}){const f=(Array.isArray(d==null?void 0:d.values)?d.values:Array.isArray(d)?d:[]).map(s=>{if(s&&typeof s=="object"){const _=s.value??s.name??s.label??s.code??s.id??s,y=Array.isArray(s.rows)?s.rows:[],V=te(_);return{...s,value:_,rows:y,normalizedValue:V}}const m=s??"";return{value:m,rows:[],normalizedValue:te(m)}}).filter(s=>s.value!=null&&String(s.value).trim()!==""),p=(Array.isArray(d==null?void 0:d.options)?d.options:[]).map((s,m)=>{if(s&&typeof s=="object"){const V=s._id??s.id??s.value??s.code??s.key??s.name??s.label??"",I=String(V||`option-${m}`),w=["label","name","title","code"].map(j=>(s==null?void 0:s[j])==null?"":String(s==null?void 0:s[j]).trim()).some(j=>j),U=I.trim(),O=w?s.label??s.name??s.title??s.code??"":nl(U)?"（缺少可辨識的標籤）":s.label??"";return{...s,id:I,label:O||U||`option-${m}`,name:s.name??O??U??`option-${m}`}}const _=s==null?"":String(s),y=_.trim()?_:`option-${m}`;return{id:y,label:_.trim()||y,name:_.trim()||y}}).filter(s=>["label","name","title","code"].map(y=>(s==null?void 0:s[y])==null?"":String(s==null?void 0:s[y]).trim()).some(y=>y)?!0:!!((s==null?void 0:s.id)==null?"":String(s.id).trim()));return{values:f,options:p}}return Object.entries(l||{}).forEach(([d,c])=>{if(d==null)return;const f=String(d).trim();if(!f)return;const v=ya[f.toLowerCase()]||f;a.add(v),e[v]=r(c)}),a.forEach(d=>{e[d]||(e[d]={values:[],options:[]})}),{normalized:e,keys:Array.from(a)}}function ht(l=[]){const e=new Set((pe.value||[]).map(s=>(s._id??s.id??s.name??s).toString().trim().toLowerCase())),a=new Set((ae.value||[]).map(s=>(s.code??s._id??s.id??s.name??s).toString().trim().toLowerCase())),r=new Set((ie.value||[]).map(s=>(s.code??s._id??s.id??s.name??s).toString().trim().toLowerCase())),d={organization:new Map,department:new Map,subDepartment:new Map};l.forEach((s,m)=>{const _=m+3,y=s.organization??"",V=s.department??"",I=s.subDepartment??"";if(y){const w=te(y);w&&!e.has(w)&&(d.organization.has(w)||d.organization.set(w,{value:y,rows:new Set}),d.organization.get(w).rows.add(_))}if(V){const w=te(V);w&&!a.has(w)&&(d.department.has(w)||d.department.set(w,{value:V,rows:new Set}),d.department.get(w).rows.add(_))}if(I){const w=te(I);w&&!r.has(w)&&(d.subDepartment.has(w)||d.subDepartment.set(w,{value:I,rows:new Set}),d.subDepartment.get(w).rows.add(_))}});const c=s=>Array.from(s.values()).map(m=>({value:m.value,rows:Array.from(m.rows),normalizedValue:te(m.value)})),f=(pe.value||[]).map(s=>({id:s._id??s.id??"",name:s.name??"",orgCode:s.orgCode??s.code??"",unitName:s.unitName??""})),v=(ae.value||[]).map(s=>({id:s._id??s.id??"",name:s.name??"",code:s.code??"",organization:s.organization??""})),p=(ie.value||[]).map(s=>({id:s._id??s.id??"",name:s.name??"",code:s.code??"",department:s.department??""}));return{organization:{values:c(d.organization),options:f},department:{values:c(d.department),options:v},subDepartment:{values:c(d.subDepartment),options:p}}}function ge(l,e){return Se(l),q[l][e]||(q[l][e]={mode:"map",targetId:""}),q[l][e]}function _t(l={},e="",a=[]){Ae.value=e||"部分欄位需要對應既有的組織/部門資料",me.value=!1;const r=(Array.isArray(a)&&a.length?a:Object.keys(l||{})).filter(f=>typeof f=="string"&&f.trim()!==""),d=r.length?r:[...J];Xe(d,{resetPending:!0,resetOptions:!0,resetSelections:!0});const c={organization:ze("organization"),department:ze("department"),subDepartment:ze("subDepartment")};Q.value.forEach(f=>{const v=l&&typeof l=="object"?l[f]:void 0,p=Array.isArray(v==null?void 0:v.values)?v.values:[],s=Array.isArray(v==null?void 0:v.options)?v.options:[],m=s.length?s:c[f]||[];Se(f),F[f]=p.map(_=>({..._})),le[f]=m.map(_=>({..._})),q[f]={},p.forEach(_=>{var U,O;const y=Z(_),V=ge(f,y),I=((U=B[f])==null?void 0:U[y])||"";((O=M[f])==null?void 0:O.includes(y))?(V.mode="ignore",V.targetId=""):I?(V.mode="map",V.targetId=I):(V.mode="map",V.targetId="")})}),K.value=!0}Ee(K,l=>{l&&console.log("[ref-mapping] dialog opened; sections snapshot =",(Q.value||[]).map(e=>{var a,r;return{k:e,values:((a=F[e])==null?void 0:a.length)||0,options:((r=le[e])==null?void 0:r.length)||0}}))});async function il({triggeredByMapping:l=!1}={}){if(!W.value){const e=l?"原始檔案已重置，請重新選擇匯入檔案後再試":"請先選擇要匯入的檔案";N.warning(e);return}if(!Al.value){N.warning("請確認必要欄位對應是否完整");return}we.value=!0;try{const e=new FormData;e.append("file",W.value),e.append("mappings",JSON.stringify(C.columnMappings)),e.append("options",JSON.stringify(C.options));const{valueMappingsPayload:a,ignorePayload:r}=pt();e.append("valueMappings",JSON.stringify(a)),e.append("ignore",JSON.stringify(r));const d=await Mt(e);let c={};try{c=await d.json()}catch{c={}}if(d.status===409){const{normalized:v,keys:p}=bt((c==null?void 0:c.missingReferences)||{});let s=v,m=p.length?p:[...J];if(m.every(U=>{var O,j;return!((j=(O=s[U])==null?void 0:O.values)!=null&&j.length)}))try{const O=(await gl(W.value)).map(j=>bl(j,C.columnMappings));s=ht(O),m=Array.from(new Set([...m,...Object.keys(s||{})]))}catch(U){console.warn("client-side missing refs build failed:",U)}const{unresolved:y,keysUsed:V}=yt(s),I=V&&V.length?V:m,w=Object.values(y).some(U=>{var O;return(((O=U==null?void 0:U.values)==null?void 0:O.length)||0)>0});Y.value=Array.isArray(c==null?void 0:c.errors)?c.errors:[],w?(_t(y,c==null?void 0:c.message,I),N.warning((c==null?void 0:c.message)||"匯入資料存在未對應的組織或部門資訊，請完成對應後重新提交")):await il({triggeredByMapping:!0});return}if(!d.ok){Y.value=Array.isArray(c==null?void 0:c.errors)?c.errors:[];const v=typeof(c==null?void 0:c.rowNumber)=="number"?`（停在第 ${c.rowNumber} 列）`:"",p=(c==null?void 0:c.message)||(c==null?void 0:c.error)||"批量匯入失敗，請稍後再試",s=v&&!p.includes(v)?`${p}${v}`:p;throw new Error(s)}const f=Array.isArray(c==null?void 0:c.preview)?c.preview:null;Array.isArray(f)&&f.length&&(se.value=f),Y.value=Array.isArray(c==null?void 0:c.errors)?c.errors:[],Y.value.length?N.warning("匯入完成，但有部分資料需要檢查"):N.success("匯入成功"),await tl(),Y.value.length||(K.value=!1,Ae.value="")}catch(e){const a=(e==null?void 0:e.message)||"批量匯入失敗，請稍後再試";N.error(a)}finally{we.value=!1}}async function Vt(){if(!W.value){N.warning("原始檔案已重置，請重新選擇匯入檔案後再試"),K.value=!1;return}const l=Array.from(new Set([...Q.value,...Object.keys(F)])),e=[];if(l.forEach(a=>{F[a].forEach(r=>{const d=Z(r),c=q[a][d];(!c||c.mode==="map"&&!c.targetId)&&e.push(r.value||d)})}),e.length){N.warning("請為所有未對應的項目選擇既有資料或設定忽略");return}l.forEach(a=>{F[a].forEach(r=>{const d=Z(r),c=q[a][d];c&&(c.mode==="ignore"?(delete B[a][d],M[a]=Yl([...M[a],d])):c.mode==="map"&&c.targetId&&(B[a][d]=c.targetId,M[a]=M[a].filter(f=>f!==d)))})}),me.value=!0;try{await il({triggeredByMapping:!0})}finally{me.value=!1}}async function ql(l=null){var e,a,r,d,c;if(He(),l!==null){Re=l;const f=G.value[l];Ze=f._id||"",n.value={...structuredClone(rl),...f,password:"",photoList:[]},n.value.title=z(n.value.title),n.value.practiceTitle=z(n.value.practiceTitle),n.value.languages=ee(n.value.languages),n.value.disabilityLevel=z(n.value.disabilityLevel),n.value.permissionGrade=Il(n.value.permissionGrade),n.value.signRole=Dl(n.value.signRole),n.value.signLevel=El(n.value.signLevel),n.value.photo=n.value.photo||"";const v=Qa(n.value.photo,n.value.name);n.value.photoList=v?[v]:[],n.value.licenses=lt(f.licenses??[]),n.value.trainings=at(f.trainings??[]),n.value.laborPensionSelf=P(n.value.laborPensionSelf)??0,n.value.employeeAdvance=P(n.value.employeeAdvance)??0,n.value.salaryItems=De(n.value.salaryItems);const p=f.education??{};!n.value.educationLevel&&p.level&&(n.value.educationLevel=p.level),!n.value.schoolName&&p.school&&(n.value.schoolName=p.school),!n.value.major&&p.major&&(n.value.major=p.major),!n.value.graduationStatus&&p.status&&(n.value.graduationStatus=p.status),n.value.graduationYear=ll(n.value.graduationYear||p.graduationYear||""),n.value.identityCategory=ee(n.value.identityCategory),n.value.height=P(f.height??((e=f.medicalCheck)==null?void 0:e.height)),n.value.weight=P(f.weight??((a=f.medicalCheck)==null?void 0:a.weight)),n.value.medicalBloodType=f.medicalBloodType??((r=f.medicalCheck)==null?void 0:r.bloodType)??"";const s=f.militaryService??{};n.value.serviceType=n.value.serviceType||s.serviceType||"",n.value.militaryBranch=n.value.militaryBranch||s.branch||"",n.value.militaryRank=n.value.militaryRank||s.rank||"";const m=n.value.dischargeYear===""||n.value.dischargeYear===null||n.value.dischargeYear===void 0?s.dischargeYear:n.value.dischargeYear;n.value.dischargeYear=P(m),n.value.department=((d=f.department)==null?void 0:d._id)||f.department||"",n.value.subDepartment=((c=f.subDepartment)==null?void 0:c._id)||f.subDepartment||"",n.value.educationLevel=z(n.value.educationLevel),n.value.graduationStatus=z(n.value.graduationStatus)}else Re=null,Ze="",Je.value="account",n.value={...structuredClone(rl)},n.value.licenses=[],n.value.trainings=[];if(await jl(),n.value.department&&!/^[0-9a-fA-F]{24}$/.test(n.value.department)){const f=ae.value.find(v=>v.name===n.value.department);f&&(n.value.department=f._id)}await al(n.value.department),Le.value=!0}async function wt(){var v;let l;try{await((v=xl.value)==null?void 0:v.validate())}catch(p){l=p}if(l){const p=Object.values(l).flat().map(s=>s.message.replace(/^請(?:輸入|選擇)(?:有效)?\s*/,""));ml.alert(`請補齊：${p.join("、")}`);return}const e=n.value,a={...e};a.title=z(e.title),a.practiceTitle=z(e.practiceTitle);const r=Za(e.photoList);r.length?(a.photoList=r,a.photo=r[0]):Re!==null?(a.photoList=[],a.photo=""):(delete a.photoList,e.photo||delete a.photo),a.languages=ee(e.languages),a.identityCategory=ee(e.identityCategory),a.disabilityLevel=z(e.disabilityLevel),a.educationLevel=z(e.educationLevel),a.graduationStatus=z(e.graduationStatus),a.laborPensionSelf=P(e.laborPensionSelf)??0,a.employeeAdvance=P(e.employeeAdvance)??0,a.salaryItems=De(e.salaryItems),a.dischargeYear=P(e.dischargeYear),(a.supervisor===""||a.supervisor===null)&&delete a.supervisor;const d=(Array.isArray(e.licenses)?e.licenses:[]).map(p=>{const s=el((p==null?void 0:p.fileList)??[]),m=typeof(p==null?void 0:p.name)=="string"?p.name.trim():(p==null?void 0:p.name)??"",_=typeof(p==null?void 0:p.number)=="string"?p.number.trim():(p==null?void 0:p.number)??"",y=(p==null?void 0:p.startDate)||"",V=(p==null?void 0:p.endDate)||"";return{name:m,number:_,startDate:y,endDate:V,fileList:s}}).filter(p=>p.name||p.number||p.startDate||p.endDate||Array.isArray(p.fileList)&&p.fileList.length);a.licenses=d;const c=(Array.isArray(e.trainings)?e.trainings:[]).map(p=>{const s=el((p==null?void 0:p.fileList)??[]),m=ee((p==null?void 0:p.category)??(p==null?void 0:p.categories)),_=typeof(p==null?void 0:p.course)=="string"?p.course.trim():(p==null?void 0:p.course)??"",y=typeof(p==null?void 0:p.courseNo)=="string"?p.courseNo.trim():(p==null?void 0:p.courseNo)??"",V=(p==null?void 0:p.date)||"",I=P(p==null?void 0:p.score),w={course:_,courseNo:y,date:V,category:m,fileList:s};return I!==null&&(w.score=I),w}).filter(p=>p.course||p.courseNo||p.date||Array.isArray(p.category)&&p.category.length||Array.isArray(p.fileList)&&p.fileList.length||p.score!==void 0);a.trainings=c;let f;Re===null?f=await re("/api/employees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}):f=await re(`/api/employees/${Ze}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),f&&f.ok?(await tl(),Le.value=!1,N.success("儲存成功")):N.error("儲存失敗")}async function At(l){const e=G.value[l];(await re(`/api/employees/${e._id}`,{method:"DELETE"})).ok&&G.value.splice(l,1)}function St(){n.value.experiences.push({unit:"",title:"",start:"",end:""})}function Lt(l){n.value.experiences.splice(l,1)}function kt(){n.value.licenses.push({name:"",number:"",startDate:"",endDate:"",fileList:[]})}function Dt(l){n.value.licenses.splice(l,1)}function Et(){n.value.trainings.push({course:"",courseNo:"",date:"",fileList:[],category:[],score:null})}function It(l){n.value.trainings.splice(l,1)}const Ut=x(()=>G.value.filter(l=>l.employmentStatus==="正職員工"||l.employmentStatus==="試用期員工").length);function Ct(l){return{admin:"danger",supervisor:"warning",employee:"success"}[l]||"info"}function Tt(l){return{admin:"管理員",supervisor:"主管",employee:"員工"}[l]||l}function Rt(l){return{admin:"",supervisor:"",employee:""}[l]||""}function Ot(l){return{正職員工:"success",試用期員工:"warning",離職員工:"danger",留職停薪:"info"}[l]||"default"}return(l,e)=>{const a=R("el-option"),r=R("el-select"),d=R("el-button"),c=R("el-avatar"),f=R("el-table-column"),v=R("el-tag"),p=R("el-table"),s=R("el-input"),m=R("el-form-item"),_=R("el-radio"),y=R("el-radio-group"),V=R("el-tab-pane"),I=R("el-upload"),w=R("el-date-picker"),U=R("el-input-number"),O=R("el-switch"),j=R("el-tabs"),Xl=R("el-form"),ul=R("el-dialog"),dl=R("el-alert");return g(),T(V,{label:"員工管理",name:"employeeMgmt"},{default:u(()=>[i("div",jt,[i("div",xt,[e[85]||(e[85]=i("div",{class:"header-content"},[i("h1",{class:"page-title"},"員工管理系統"),i("p",{class:"page-description"},"管理員工資料、權限設定、部門分配和薪資配置")],-1)),i("div",Ft,[i("div",$t,[i("div",Yt,k(G.value.length),1),e[83]||(e[83]=i("div",{class:"stat-label"},"總員工數",-1))]),i("div",qt,[i("div",Kt,k(Ut.value),1),e[84]||(e[84]=i("div",{class:"stat-label"},"在職員工",-1))])])]),i("div",Gt,[e[88]||(e[88]=i("h2",{class:"section-title"},"員工列表",-1)),i("div",Xt,[o(r,{modelValue:oe.value,"onUpdate:modelValue":e[0]||(e[0]=t=>oe.value=t),placeholder:"篩選部門",clearable:"",class:"dept-filter-select",style:{"min-width":"200px","margin-right":"12px"}},{default:u(()=>[(g(!0),h(S,null,L(pl.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(d,{type:"primary",onClick:e[1]||(e[1]=t=>ql()),class:"add-btn"},{default:u(()=>e[86]||(e[86]=[i("i",{class:"el-icon-plus"},null,-1),E(" 新增員工 ")])),_:1}),o(d,{type:"success",plain:"",class:"import-btn","data-test":"bulk-import-button",onClick:dt},{default:u(()=>e[87]||(e[87]=[i("i",{class:"el-icon-upload2"},null,-1),E(" 批量匯入 ")])),_:1})])]),i("div",Ht,[o(p,{data:de.value,class:"employee-table","header-cell-style":{background:"#f8fafc",color:"#475569",fontWeight:"600"},"row-style":{height:"64px"}},{default:u(()=>[o(f,{prop:"name",label:"員工資訊","min-width":"200"},{default:u(({row:t})=>[i("div",Wt,[o(c,{size:40,class:"employee-avatar"},{default:u(()=>[E(k(t.name?t.name.charAt(0):"N"),1)]),_:2},1024),i("div",Jt,[i("div",Qt,k(t.name||"未設定"),1),i("div",Zt,k(t.employeeNo||"無編號"),1)])])]),_:1}),o(f,{label:"部門",width:"180"},{default:u(({row:t})=>[i("div",er,[e[89]||(e[89]=i("i",{class:"el-icon-s-grid dept-icon"},null,-1)),i("span",null,k(Ul(t.department)),1)])]),_:1}),o(f,{prop:"title",label:"職稱",width:"150"},{default:u(({row:t})=>[t.title?(g(),T(v,{key:0,type:"info",class:"title-tag"},{default:u(()=>[E(k(ma(Ce.value,t.title)),1)]),_:2},1024)):(g(),h("span",lr,"未設定"))]),_:1}),o(f,{prop:"role",label:"系統權限",width:"120"},{default:u(({row:t})=>[o(v,{type:Ct(t.role),class:"role-tag"},{default:u(()=>[E(k(Tt(t.role)),1)]),_:2},1032,["type"])]),_:1}),o(f,{prop:"employmentStatus",label:"在職狀態",width:"130"},{default:u(({row:t})=>[o(v,{type:Ot(t.employmentStatus),class:"status-tag"},{default:u(()=>[E(k(t.employmentStatus||"未設定"),1)]),_:2},1032,["type"])]),_:1}),o(f,{label:"聯絡方式",width:"200"},{default:u(({row:t})=>[i("div",ar,[t.email?(g(),h("div",tr,[e[90]||(e[90]=i("i",{class:"el-icon-message"},null,-1)),i("span",null,k(t.email),1)])):X("",!0),t.phone?(g(),h("div",rr,[e[91]||(e[91]=i("i",{class:"el-icon-phone"},null,-1)),i("span",null,k(t.phone),1)])):X("",!0),!t.email&&!t.phone?(g(),h("div",or," 無聯絡資訊 ")):X("",!0)])]),_:1}),o(f,{label:"操作",width:"200",fixed:"right"},{default:u(({row:t,$index:A})=>[i("div",nr,[o(d,{type:"primary",size:"small",onClick:b=>ql(A),class:"edit-btn"},{default:u(()=>e[92]||(e[92]=[i("i",{class:"el-icon-edit"},null,-1),E(" 編輯 ")])),_:2},1032,["onClick"]),o(d,{type:"danger",size:"small",onClick:b=>At(A),class:"delete-btn"},{default:u(()=>e[93]||(e[93]=[i("i",{class:"el-icon-delete"},null,-1),E(" 刪除 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),o(ul,{modelValue:Le.value,"onUpdate:modelValue":e[76]||(e[76]=t=>Le.value=t),title:"員工資料管理",width:"1200px",class:"employee-dialog","close-on-click-modal":!1},{footer:u(()=>[i("div",qo,[o(d,{onClick:e[75]||(e[75]=t=>Le.value=!1),class:"cancel-btn"},{default:u(()=>e[132]||(e[132]=[E("取消")])),_:1}),o(d,{type:"primary",onClick:wt,class:"save-btn"},{default:u(()=>e[133]||(e[133]=[i("i",{class:"el-icon-check"},null,-1),E(" 儲存員工資料 ")])),_:1})])]),default:u(()=>[o(Xl,{ref_key:"formRef",ref:xl,model:n.value,rules:ot,"label-width":"140px",class:"employee-form"},{default:u(()=>[o(j,{modelValue:Je.value,"onUpdate:modelValue":e[74]||(e[74]=t=>Je.value=t),type:"border-card",class:"employee-tabs"},{default:u(()=>[o(V,{name:"account"},{label:u(()=>e[94]||(e[94]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-user"}),i("span",null,"帳號權限")],-1)])),default:u(()=>[i("div",sr,[i("div",ir,[i("div",ur,[e[95]||(e[95]=i("h3",{class:"form-group-title"},"登入資訊",-1)),o(m,{label:"登入帳號",required:"",prop:"username"},{default:u(()=>[o(s,{modelValue:n.value.username,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.username=t),placeholder:"請輸入登入帳號"},null,8,["modelValue"])]),_:1}),o(m,{label:"登入密碼",required:"",prop:"password"},{default:u(()=>[o(s,{modelValue:n.value.password,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.password=t),type:"password",placeholder:"請輸入密碼","show-password":""},null,8,["modelValue"])]),_:1})]),i("div",dr,[e[96]||(e[96]=i("h3",{class:"form-group-title"},"權限設定",-1)),o(m,{label:"系統權限",required:"",prop:"role"},{default:u(()=>[o(y,{modelValue:n.value.role,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.role=t),class:"role-radio-group"},{default:u(()=>[(g(),h(S,null,L(Ie,t=>o(_,{key:t.value,label:t.value,class:"role-radio"},{default:u(()=>[i("div",cr,[i("div",mr,k(t.label),1),i("div",pr,k(Rt(t.value)),1)])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"權限職等"},{default:u(()=>[o(r,{modelValue:n.value.permissionGrade,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.permissionGrade=t),placeholder:"選擇職等",class:"code-select"},{default:u(()=>[(g(),h(S,null,L(hl,t=>o(a,{key:t.level,label:qa(t),value:t.level},{default:u(()=>[i("div",fr,[i("div",vr,k(t.level)+"｜"+k(t.description),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}),o(V,{name:"approval"},{label:u(()=>e[97]||(e[97]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-document-checked"}),i("span",null,"簽核設定")],-1)])),default:u(()=>[i("div",gr,[i("div",yr,[i("div",br,[e[98]||(e[98]=i("h3",{class:"form-group-title"},"簽核權限",-1)),o(m,{label:"簽核角色"},{default:u(()=>[o(y,{modelValue:n.value.signRole,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.signRole=t),class:"sign-role-group"},{default:u(()=>[(g(),h(S,null,L(Te,t=>o(_,{key:t.id,label:t.id,class:"sign-role-radio"},{default:u(()=>[i("div",hr,[i("div",_r,k(t.id)+"｜"+k(t.label),1),i("div",Vr,k(t.description),1)])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"簽核層級"},{default:u(()=>[o(r,{modelValue:n.value.signLevel,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.signLevel=t),placeholder:"選擇層級",class:"code-select"},{default:u(()=>[(g(),h(S,null,L(We,t=>o(a,{key:t.id,label:Ka(t),value:t.id},{default:u(()=>[i("div",wr,[i("div",Ar,k(t.id)+"｜"+k(t.label),1),i("div",Sr,k(t.description),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"員工標籤"},{default:u(()=>[o(r,{modelValue:n.value.signTags,"onUpdate:modelValue":e[8]||(e[8]=t=>n.value.signTags=t),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"選擇或新增標籤",class:"tag-select"},{default:u(()=>[(g(),h(S,null,L(Pa,t=>o(a,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])])])]),_:1}),o(V,{name:"personal"},{label:u(()=>e[99]||(e[99]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-user-solid"}),i("span",null,"個人資訊")],-1)])),default:u(()=>[i("div",Lr,[i("div",kr,[i("div",Dr,[e[101]||(e[101]=i("h3",{class:"form-group-title"},"基本資料",-1)),o(m,{label:"個人照片",class:"photo-upload-item"},{default:u(()=>[o(I,{class:"employee-photo-upload","file-list":n.value.photoList,"onUpdate:fileList":e[9]||(e[9]=t=>n.value.photoList=t),"http-request":Xa,"on-success":Ha,"on-remove":Wa,"on-exceed":Ja,"list-type":"picture-card",limit:1,accept:"image/*",disabled:Qe.value},{default:u(()=>e[100]||(e[100]=[i("div",{class:"upload-placeholder"},[i("i",{class:"el-icon-plus"}),i("span",null,"上傳照片")],-1)])),_:1},8,["file-list","disabled"])]),_:1}),i("div",Er,[o(m,{label:"員工編號"},{default:u(()=>[o(s,{modelValue:n.value.employeeNo,"onUpdate:modelValue":e[10]||(e[10]=t=>n.value.employeeNo=t),placeholder:"請輸入員工編號"},null,8,["modelValue"])]),_:1}),o(m,{label:"員工姓名",required:"",prop:"name"},{default:u(()=>[o(s,{modelValue:n.value.name,"onUpdate:modelValue":e[11]||(e[11]=t=>n.value.name=t),placeholder:"請輸入員工姓名"},null,8,["modelValue"])]),_:1})]),i("div",Ir,[o(m,{label:"性別",required:"",prop:"gender"},{default:u(()=>[o(r,{modelValue:n.value.gender,"onUpdate:modelValue":e[12]||(e[12]=t=>n.value.gender=t),placeholder:"選擇性別"},{default:u(()=>[o(a,{label:"男",value:"M"}),o(a,{label:"女",value:"F"})]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"生日"},{default:u(()=>[o(w,{modelValue:n.value.birthday,"onUpdate:modelValue":e[13]||(e[13]=t=>n.value.birthday=t),type:"date",placeholder:"選擇生日"},null,8,["modelValue"])]),_:1})]),i("div",Ur,[o(m,{label:"身分證號"},{default:u(()=>[o(s,{modelValue:n.value.idNumber,"onUpdate:modelValue":e[14]||(e[14]=t=>n.value.idNumber=t),placeholder:"請輸入身分證號"},null,8,["modelValue"])]),_:1}),o(m,{label:"出生地"},{default:u(()=>[o(s,{modelValue:n.value.birthplace,"onUpdate:modelValue":e[15]||(e[15]=t=>n.value.birthplace=t),placeholder:"請輸入出生地"},null,8,["modelValue"])]),_:1})]),i("div",Cr,[o(m,{label:"血型"},{default:u(()=>[o(r,{modelValue:n.value.bloodType,"onUpdate:modelValue":e[16]||(e[16]=t=>n.value.bloodType=t),placeholder:"選擇血型"},{default:u(()=>[(g(),h(S,null,L(Ll,t=>o(a,{key:t,value:t,label:t},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"婚姻狀態"},{default:u(()=>[o(r,{modelValue:n.value.maritalStatus,"onUpdate:modelValue":e[17]||(e[17]=t=>n.value.maritalStatus=t),placeholder:"選擇婚姻狀態"},{default:u(()=>[o(a,{label:"未婚",value:"未婚"}),o(a,{label:"已婚",value:"已婚"}),o(a,{label:"離婚",value:"離婚"}),o(a,{label:"喪偶",value:"喪偶"})]),_:1},8,["modelValue"])]),_:1})]),o(m,{label:"語言能力"},{default:u(()=>[o(r,{modelValue:n.value.languages,"onUpdate:modelValue":e[18]||(e[18]=t=>n.value.languages=t),multiple:"",filterable:"",placeholder:"選擇語言",disabled:!xe.value.length},{default:u(()=>[(g(!0),h(S,null,L(xe.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),i("div",Tr,[o(m,{label:"身心障礙等級"},{default:u(()=>[o(r,{modelValue:n.value.disabilityLevel,"onUpdate:modelValue":e[19]||(e[19]=t=>n.value.disabilityLevel=t),placeholder:"選擇等級",clearable:"",disabled:!Fe.value.length},{default:u(()=>[(g(!0),h(S,null,L(Fe.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(m,{label:"身分註記"},{default:u(()=>[o(r,{modelValue:n.value.identityCategory,"onUpdate:modelValue":e[20]||(e[20]=t=>n.value.identityCategory=t),multiple:"",filterable:"","collapse-tags":"",placeholder:"選擇身份別",disabled:!$e.value.length},{default:u(()=>[(g(!0),h(S,null,L($e.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),o(m,{label:"扶養人數"},{default:u(()=>[o(U,{modelValue:n.value.dependents,"onUpdate:modelValue":e[21]||(e[21]=t=>n.value.dependents=t),min:0},null,8,["modelValue"])]),_:1})]),i("div",Rr,[e[102]||(e[102]=i("h3",{class:"form-group-title"},"聯絡資訊",-1)),i("div",Or,[o(m,{label:"Email",required:"",prop:"email"},{default:u(()=>[o(s,{modelValue:n.value.email,"onUpdate:modelValue":e[22]||(e[22]=t=>n.value.email=t),placeholder:"請輸入Email"},null,8,["modelValue"])]),_:1}),o(m,{label:"行動電話"},{default:u(()=>[o(s,{modelValue:n.value.phone,"onUpdate:modelValue":e[23]||(e[23]=t=>n.value.phone=t),placeholder:"請輸入行動電話"},null,8,["modelValue"])]),_:1})]),i("div",Nr,[o(m,{label:"市內電話"},{default:u(()=>[o(s,{modelValue:n.value.landline,"onUpdate:modelValue":e[24]||(e[24]=t=>n.value.landline=t),placeholder:"請輸入市內電話"},null,8,["modelValue"])]),_:1}),o(m,{label:"LINE ID"},{default:u(()=>[o(s,{modelValue:n.value.lineId,"onUpdate:modelValue":e[25]||(e[25]=t=>n.value.lineId=t),placeholder:"請輸入LINE ID"},null,8,["modelValue"])]),_:1})]),o(m,{label:"戶籍地址"},{default:u(()=>[o(s,{modelValue:n.value.householdAddress,"onUpdate:modelValue":e[26]||(e[26]=t=>n.value.householdAddress=t),placeholder:"請輸入戶籍地址"},null,8,["modelValue"])]),_:1}),o(m,{label:"聯絡地址"},{default:u(()=>[o(s,{modelValue:n.value.contactAddress,"onUpdate:modelValue":e[27]||(e[27]=t=>n.value.contactAddress=t),placeholder:"請輸入聯絡地址"},null,8,["modelValue"])]),_:1})])])])]),_:1}),o(V,{name:"employment"},{label:u(()=>e[103]||(e[103]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-office-building"}),i("span",null,"任職資訊")],-1)])),default:u(()=>[i("div",zr,[i("div",Pr,[i("div",Br,[e[104]||(e[104]=i("h3",{class:"form-group-title"},"組織架構",-1)),i("div",Mr,[o(m,{label:"所屬機構",required:"",prop:"organization"},{default:u(()=>[o(r,{modelValue:n.value.organization,"onUpdate:modelValue":e[28]||(e[28]=t=>n.value.organization=t),placeholder:"選擇機構"},{default:u(()=>[(g(!0),h(S,null,L(pe.value,t=>(g(),T(a,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"所屬部門",required:"",prop:"department"},{default:u(()=>[o(r,{modelValue:n.value.department,"onUpdate:modelValue":e[29]||(e[29]=t=>n.value.department=t),placeholder:"選擇部門"},{default:u(()=>[(g(!0),h(S,null,L(nt.value,t=>(g(),T(a,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",jr,[o(m,{label:"小單位"},{default:u(()=>[o(r,{modelValue:n.value.subDepartment,"onUpdate:modelValue":e[30]||(e[30]=t=>n.value.subDepartment=t),placeholder:"選擇小單位"},{default:u(()=>[(g(!0),h(S,null,L(st.value,t=>(g(),T(a,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"直屬主管"},{default:u(()=>[o(r,{modelValue:n.value.supervisor,"onUpdate:modelValue":e[31]||(e[31]=t=>n.value.supervisor=t),placeholder:"選擇主管"},{default:u(()=>[(g(!0),h(S,null,L(it.value,t=>(g(),T(a,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),i("div",xr,[e[105]||(e[105]=i("h3",{class:"form-group-title"},"職務資訊",-1)),i("div",Fr,[o(m,{label:"職稱"},{default:u(()=>[o(r,{modelValue:n.value.title,"onUpdate:modelValue":e[32]||(e[32]=t=>n.value.title=t),placeholder:"選擇職稱",disabled:!Ce.value.length},{default:u(()=>[(g(!0),h(S,null,L(Ce.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(m,{label:"執業職稱"},{default:u(()=>[o(r,{modelValue:n.value.practiceTitle,"onUpdate:modelValue":e[33]||(e[33]=t=>n.value.practiceTitle=t),placeholder:"選擇執業職稱",disabled:!je.value.length},{default:u(()=>[(g(!0),h(S,null,L(je.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",$r,[o(m,{label:"兼職人員"},{default:u(()=>[o(O,{modelValue:n.value.isPartTime,"onUpdate:modelValue":e[34]||(e[34]=t=>n.value.isPartTime=t),"active-text":"是","inactive-text":"否","active-color":"#10b981"},null,8,["modelValue"])]),_:1}),o(m,{label:"需要打卡"},{default:u(()=>[o(O,{modelValue:n.value.isClocking,"onUpdate:modelValue":e[35]||(e[35]=t=>n.value.isClocking=t),"active-text":"是","inactive-text":"否","active-color":"#10b981"},null,8,["modelValue"])]),_:1})])]),i("div",Yr,[e[106]||(e[106]=i("h3",{class:"form-group-title"},"聘用狀態",-1)),i("div",qr,[o(m,{label:"在職狀態"},{default:u(()=>[o(r,{modelValue:n.value.employmentStatus,"onUpdate:modelValue":e[36]||(e[36]=t=>n.value.employmentStatus=t),placeholder:"選擇狀態"},{default:u(()=>[o(a,{label:"正職員工",value:"正職員工"}),o(a,{label:"試用期員工",value:"試用期員工"}),o(a,{label:"離職員工",value:"離職員工"}),o(a,{label:"留職停薪",value:"留職停薪"})]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"試用期"},{default:u(()=>[o(r,{modelValue:n.value.probationDays,"onUpdate:modelValue":e[37]||(e[37]=t=>n.value.probationDays=t),placeholder:"選擇天數"},{default:u(()=>[o(a,{label:"無",value:""}),o(a,{label:"30天",value:"30"}),o(a,{label:"60天",value:"60"}),o(a,{label:"90天",value:"90"})]),_:1},8,["modelValue"])]),_:1})]),i("div",Kr,[o(m,{label:"到職日期"},{default:u(()=>[o(w,{modelValue:n.value.hireDate,"onUpdate:modelValue":e[38]||(e[38]=t=>n.value.hireDate=t),type:"date",placeholder:"選擇到職日期"},null,8,["modelValue"])]),_:1}),o(m,{label:"起聘日期"},{default:u(()=>[o(w,{modelValue:n.value.appointDate,"onUpdate:modelValue":e[39]||(e[39]=t=>n.value.appointDate=t),type:"date",placeholder:"選擇起聘日期"},null,8,["modelValue"])]),_:1})]),i("div",Gr,[o(m,{label:"離職日期"},{default:u(()=>[o(w,{modelValue:n.value.resignDate,"onUpdate:modelValue":e[40]||(e[40]=t=>n.value.resignDate=t),type:"date",placeholder:"選擇離職日期"},null,8,["modelValue"])]),_:1}),o(m,{label:"解聘日期"},{default:u(()=>[o(w,{modelValue:n.value.dismissDate,"onUpdate:modelValue":e[41]||(e[41]=t=>n.value.dismissDate=t),type:"date",placeholder:"選擇解聘日期"},null,8,["modelValue"])]),_:1})]),i("div",Xr,[o(m,{label:"再任起聘"},{default:u(()=>[o(w,{modelValue:n.value.reAppointDate,"onUpdate:modelValue":e[42]||(e[42]=t=>n.value.reAppointDate=t),type:"date",placeholder:"選擇再任起聘日期"},null,8,["modelValue"])]),_:1}),o(m,{label:"再任解聘"},{default:u(()=>[o(w,{modelValue:n.value.reDismissDate,"onUpdate:modelValue":e[43]||(e[43]=t=>n.value.reDismissDate=t),type:"date",placeholder:"選擇再任解聘日期"},null,8,["modelValue"])]),_:1})]),i("div",Hr,[o(m,{label:"聘任備註",class:"full-width-item"},{default:u(()=>[o(s,{modelValue:n.value.employmentNote,"onUpdate:modelValue":e[44]||(e[44]=t=>n.value.employmentNote=t),type:"textarea",rows:2,placeholder:"請輸入聘任備註"},null,8,["modelValue"])]),_:1})])])])])]),_:1}),o(V,{name:"more"},{label:u(()=>e[107]||(e[107]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-more"}),i("span",null,"更多資訊")],-1)])),default:u(()=>[i("div",Wr,[i("div",Jr,[i("div",Qr,[e[108]||(e[108]=i("h3",{class:"form-group-title"},"身體檢查",-1)),i("div",Zr,[o(m,{label:"身高 (cm)"},{default:u(()=>[o(U,{modelValue:n.value.height,"onUpdate:modelValue":e[45]||(e[45]=t=>n.value.height=t),min:0,max:250,step:.1,precision:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入身高"},null,8,["modelValue"])]),_:1}),o(m,{label:"體重 (kg)"},{default:u(()=>[o(U,{modelValue:n.value.weight,"onUpdate:modelValue":e[46]||(e[46]=t=>n.value.weight=t),min:0,max:300,step:.1,precision:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入體重"},null,8,["modelValue"])]),_:1})]),i("div",eo,[o(m,{label:"體檢血型"},{default:u(()=>[o(r,{modelValue:n.value.medicalBloodType,"onUpdate:modelValue":e[47]||(e[47]=t=>n.value.medicalBloodType=t),placeholder:"選擇血型",clearable:""},{default:u(()=>[(g(),h(S,null,L(Ll,t=>o(a,{key:`medical-${t}`,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])]),i("div",lo,[e[109]||(e[109]=i("h3",{class:"form-group-title"},"學歷資訊",-1)),i("div",ao,[o(m,{label:"教育程度"},{default:u(()=>[o(r,{modelValue:n.value.educationLevel,"onUpdate:modelValue":e[48]||(e[48]=t=>n.value.educationLevel=t),placeholder:"選擇教育程度",disabled:!Ye.value.length},{default:u(()=>[(g(!0),h(S,null,L(Ye.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(m,{label:"學校名稱"},{default:u(()=>[o(s,{modelValue:n.value.schoolName,"onUpdate:modelValue":e[49]||(e[49]=t=>n.value.schoolName=t),placeholder:"請輸入學校名稱"},null,8,["modelValue"])]),_:1})]),i("div",to,[o(m,{label:"主修科系"},{default:u(()=>[o(s,{modelValue:n.value.major,"onUpdate:modelValue":e[50]||(e[50]=t=>n.value.major=t),placeholder:"請輸入主修科系"},null,8,["modelValue"])]),_:1}),o(m,{label:"畢業狀態"},{default:u(()=>[o(r,{modelValue:n.value.graduationStatus,"onUpdate:modelValue":e[51]||(e[51]=t=>n.value.graduationStatus=t),placeholder:"選擇畢業狀態",clearable:"",onClear:ut,disabled:!qe.value.length},{default:u(()=>[(g(!0),h(S,null,L(qe.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),i("div",ro,[o(m,{label:"畢業年度",class:"full-width-item"},{default:u(()=>[o(s,{modelValue:n.value.graduationYear,"onUpdate:modelValue":e[52]||(e[52]=t=>n.value.graduationYear=t),placeholder:"請輸入畢業年度"},null,8,["modelValue"])]),_:1})])]),i("div",oo,[e[110]||(e[110]=i("h3",{class:"form-group-title"},"役別資訊",-1)),i("div",no,[o(m,{label:"役別類型"},{default:u(()=>[o(r,{modelValue:n.value.serviceType,"onUpdate:modelValue":e[53]||(e[53]=t=>n.value.serviceType=t),placeholder:"選擇或輸入役別類型",filterable:"","allow-create":"","default-first-option":"",clearable:""},{default:u(()=>[(g(),h(S,null,L(Ba,t=>o(a,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"軍種"},{default:u(()=>[o(s,{modelValue:n.value.militaryBranch,"onUpdate:modelValue":e[54]||(e[54]=t=>n.value.militaryBranch=t),placeholder:"請輸入軍種"},null,8,["modelValue"])]),_:1})]),i("div",so,[o(m,{label:"軍階"},{default:u(()=>[o(s,{modelValue:n.value.militaryRank,"onUpdate:modelValue":e[55]||(e[55]=t=>n.value.militaryRank=t),placeholder:"請輸入軍階"},null,8,["modelValue"])]),_:1}),o(m,{label:"退伍年"},{default:u(()=>[o(U,{modelValue:n.value.dischargeYear,"onUpdate:modelValue":e[56]||(e[56]=t=>n.value.dischargeYear=t),min:1900,max:Pt(Ma)+10,step:1,"value-on-clear":null,"controls-position":"right",placeholder:"請輸入退伍年"},null,8,["modelValue","max"])]),_:1})])]),i("div",io,[e[113]||(e[113]=i("h3",{class:"form-group-title"},"緊急聯絡人",-1)),i("div",uo,[e[111]||(e[111]=i("h4",{class:"contact-subtitle"},"聯絡人一",-1)),i("div",co,[o(m,{label:"姓名"},{default:u(()=>[o(s,{modelValue:n.value.emergency1.name,"onUpdate:modelValue":e[57]||(e[57]=t=>n.value.emergency1.name=t),placeholder:"請輸入姓名"},null,8,["modelValue"])]),_:1}),o(m,{label:"關係"},{default:u(()=>[o(r,{modelValue:n.value.emergency1.relation,"onUpdate:modelValue":e[58]||(e[58]=t=>n.value.emergency1.relation=t),placeholder:"選擇關係"},{default:u(()=>[(g(!0),h(S,null,L(Ke.value,t=>(g(),T(a,{key:`r1-${t.value}`,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",mo,[o(m,{label:"電話一"},{default:u(()=>[o(s,{modelValue:n.value.emergency1.phone1,"onUpdate:modelValue":e[59]||(e[59]=t=>n.value.emergency1.phone1=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1}),o(m,{label:"電話二"},{default:u(()=>[o(s,{modelValue:n.value.emergency1.phone2,"onUpdate:modelValue":e[60]||(e[60]=t=>n.value.emergency1.phone2=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1})])]),i("div",po,[e[112]||(e[112]=i("h4",{class:"contact-subtitle"},"聯絡人二",-1)),i("div",fo,[o(m,{label:"姓名"},{default:u(()=>[o(s,{modelValue:n.value.emergency2.name,"onUpdate:modelValue":e[61]||(e[61]=t=>n.value.emergency2.name=t),placeholder:"請輸入姓名"},null,8,["modelValue"])]),_:1}),o(m,{label:"關係"},{default:u(()=>[o(r,{modelValue:n.value.emergency2.relation,"onUpdate:modelValue":e[62]||(e[62]=t=>n.value.emergency2.relation=t),placeholder:"選擇關係"},{default:u(()=>[(g(!0),h(S,null,L(Ke.value,t=>(g(),T(a,{key:`r2-${t.value}`,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),i("div",vo,[o(m,{label:"電話一"},{default:u(()=>[o(s,{modelValue:n.value.emergency2.phone1,"onUpdate:modelValue":e[63]||(e[63]=t=>n.value.emergency2.phone1=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1}),o(m,{label:"電話二"},{default:u(()=>[o(s,{modelValue:n.value.emergency2.phone2,"onUpdate:modelValue":e[64]||(e[64]=t=>n.value.emergency2.phone2=t),placeholder:"請輸入電話"},null,8,["modelValue"])]),_:1})])])]),i("div",go,[e[116]||(e[116]=i("h3",{class:"form-group-title"},"工作經歷",-1)),i("div",yo,[(g(!0),h(S,null,L(n.value.experiences,(t,A)=>(g(),h("div",{key:A,class:"experience-item"},[i("div",bo,[i("h4",ho,"經歷 "+k(A+1),1),o(d,{type:"danger",size:"small",onClick:b=>Lt(A),class:"remove-btn"},{default:u(()=>e[114]||(e[114]=[i("i",{class:"el-icon-delete"},null,-1),E(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",_o,[o(m,{label:"單位名稱"},{default:u(()=>[o(s,{modelValue:t.unit,"onUpdate:modelValue":b=>t.unit=b,placeholder:"請輸入單位名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"職稱"},{default:u(()=>[o(s,{modelValue:t.title,"onUpdate:modelValue":b=>t.title=b,placeholder:"請輸入職稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Vo,[o(m,{label:"到職年月"},{default:u(()=>[o(w,{modelValue:t.start,"onUpdate:modelValue":b=>t.start=b,type:"month",placeholder:"選擇到職年月"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"離職年月"},{default:u(()=>[o(w,{modelValue:t.end,"onUpdate:modelValue":b=>t.end=b,type:"month",placeholder:"選擇離職年月"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128))]),o(d,{type:"primary",onClick:St,class:"add-item-btn"},{default:u(()=>e[115]||(e[115]=[i("i",{class:"el-icon-plus"},null,-1),E(" 新增經歷 ")])),_:1})]),i("div",wo,[e[121]||(e[121]=i("h3",{class:"form-group-title"},"證照",-1)),i("div",Ao,[(g(!0),h(S,null,L(n.value.licenses,(t,A)=>(g(),h("div",{key:`license-${A}`,class:"experience-item"},[i("div",So,[i("h4",Lo,"證照 "+k(A+1),1),o(d,{type:"danger",size:"small",onClick:b=>Dt(A),class:"remove-btn"},{default:u(()=>e[117]||(e[117]=[i("i",{class:"el-icon-delete"},null,-1),E(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",ko,[o(m,{label:"證照名稱"},{default:u(()=>[o(s,{modelValue:t.name,"onUpdate:modelValue":b=>t.name=b,placeholder:"請輸入證照名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"證照字號"},{default:u(()=>[o(s,{modelValue:t.number,"onUpdate:modelValue":b=>t.number=b,placeholder:"請輸入證照字號"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Do,[o(m,{label:"核發日期"},{default:u(()=>[o(w,{modelValue:t.startDate,"onUpdate:modelValue":b=>t.startDate=b,type:"date",placeholder:"選擇核發日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"有效期限"},{default:u(()=>[o(w,{modelValue:t.endDate,"onUpdate:modelValue":b=>t.endDate=b,type:"date",placeholder:"選擇有效期限"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Eo,[o(m,{label:"證照檔案",class:"full-width-item"},{default:u(()=>[o(I,{"file-list":t.fileList,"onUpdate:fileList":b=>t.fileList=b,action:"#",multiple:"","list-type":"text","http-request":Pl,"on-success":(b,ue,cl)=>Bl("licenses",A,b,ue,cl),"on-remove":(b,ue)=>Ml("licenses",A,b,ue)},{tip:u(()=>e[119]||(e[119]=[i("div",{class:"upload-tip"},"可上傳多個檔案，將以連結形式儲存",-1)])),default:u(()=>[o(d,{type:"primary",plain:""},{default:u(()=>e[118]||(e[118]=[i("i",{class:"el-icon-upload2"},null,-1),E(" 上傳檔案 ")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","on-success","on-remove"])]),_:2},1024)])]))),128))]),o(d,{type:"primary",onClick:kt,class:"add-item-btn"},{default:u(()=>e[120]||(e[120]=[i("i",{class:"el-icon-plus"},null,-1),E(" 新增證照 ")])),_:1})]),i("div",Io,[e[126]||(e[126]=i("h3",{class:"form-group-title"},"教育訓練",-1)),i("div",Uo,[(g(!0),h(S,null,L(n.value.trainings,(t,A)=>(g(),h("div",{key:`training-${A}`,class:"experience-item"},[i("div",Co,[i("h4",To,"教育訓練 "+k(A+1),1),o(d,{type:"danger",size:"small",onClick:b=>It(A),class:"remove-btn"},{default:u(()=>e[122]||(e[122]=[i("i",{class:"el-icon-delete"},null,-1),E(" 刪除 ")])),_:2},1032,["onClick"])]),i("div",Ro,[o(m,{label:"課程名稱"},{default:u(()=>[o(s,{modelValue:t.course,"onUpdate:modelValue":b=>t.course=b,placeholder:"請輸入課程名稱"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"課程代碼"},{default:u(()=>[o(s,{modelValue:t.courseNo,"onUpdate:modelValue":b=>t.courseNo=b,placeholder:"請輸入課程代碼"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",Oo,[o(m,{label:"上課日期"},{default:u(()=>[o(w,{modelValue:t.date,"onUpdate:modelValue":b=>t.date=b,type:"date",placeholder:"選擇日期"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"積分類別",class:"full-width-item"},{default:u(()=>[o(r,{modelValue:t.category,"onUpdate:modelValue":b=>t.category=b,multiple:"","collapse-tags":"",placeholder:"選擇積分類別"},{default:u(()=>[(g(!0),h(S,null,L(_l.value,b=>(g(),T(a,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),i("div",No,[o(m,{label:"積分"},{default:u(()=>[o(U,{modelValue:t.score,"onUpdate:modelValue":b=>t.score=b,min:0,step:.5,"value-on-clear":null},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,{label:"訓練檔案",class:"full-width-item"},{default:u(()=>[o(I,{"file-list":t.fileList,"onUpdate:fileList":b=>t.fileList=b,action:"#",multiple:"","list-type":"text","http-request":Pl,"on-success":(b,ue,cl)=>Bl("trainings",A,b,ue,cl),"on-remove":(b,ue)=>Ml("trainings",A,b,ue)},{tip:u(()=>e[124]||(e[124]=[i("div",{class:"upload-tip"},"支援多檔上傳，將以連結形式儲存",-1)])),default:u(()=>[o(d,{type:"primary",plain:""},{default:u(()=>e[123]||(e[123]=[i("i",{class:"el-icon-upload2"},null,-1),E(" 上傳檔案 ")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","on-success","on-remove"])]),_:2},1024)])]))),128))]),o(d,{type:"primary",onClick:Et,class:"add-item-btn"},{default:u(()=>e[125]||(e[125]=[i("i",{class:"el-icon-plus"},null,-1),E(" 新增教育訓練 ")])),_:1})])])])]),_:1}),o(V,{name:"salary"},{label:u(()=>e[127]||(e[127]=[i("div",{class:"tab-label"},[i("i",{class:"el-icon-money"}),i("span",null,"薪資設定")],-1)])),default:u(()=>[i("div",zo,[i("div",Po,[i("div",Bo,[e[128]||(e[128]=i("h3",{class:"form-group-title"},"薪資資訊",-1)),i("div",Mo,[o(m,{label:"薪資類別"},{default:u(()=>[o(r,{modelValue:n.value.salaryType,"onUpdate:modelValue":e[65]||(e[65]=t=>n.value.salaryType=t),placeholder:"選擇類別"},{default:u(()=>[(g(),h(S,null,L(za,t=>o(a,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"薪資金額"},{default:u(()=>[o(U,{modelValue:n.value.salaryAmount,"onUpdate:modelValue":e[66]||(e[66]=t=>n.value.salaryAmount=t),min:0,step:1e3,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),o(m,{label:"勞退自提",prop:"laborPensionSelf"},{default:u(()=>[o(U,{modelValue:n.value.laborPensionSelf,"onUpdate:modelValue":e[67]||(e[67]=t=>n.value.laborPensionSelf=t),min:0,step:100,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),o(m,{label:"員工預支",prop:"employeeAdvance"},{default:u(()=>[o(U,{modelValue:n.value.employeeAdvance,"onUpdate:modelValue":e[68]||(e[68]=t=>n.value.employeeAdvance=t),min:0,step:100,formatter:t=>`$ ${t??0}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t?t.replace(/\$\s?|(,*)/g,""):""},null,8,["modelValue","formatter","parser"])]),_:1}),o(m,{class:"full-width-item",label:"薪資項目",prop:"salaryItems"},{default:u(()=>[o(r,{modelValue:n.value.salaryItems,"onUpdate:modelValue":e[69]||(e[69]=t=>n.value.salaryItems=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"選擇薪資項目"},{default:u(()=>[(g(!0),h(S,null,L(he.value,t=>(g(),T(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),i("div",jo,[e[131]||(e[131]=i("h3",{class:"form-group-title"},"銀行帳戶",-1)),i("div",xo,[e[129]||(e[129]=i("h4",{class:"account-subtitle"},"薪資帳戶 A",-1)),i("div",Fo,[o(m,{label:"銀行代碼/名稱"},{default:u(()=>[o(s,{modelValue:n.value.salaryAccountA.bank,"onUpdate:modelValue":e[70]||(e[70]=t=>n.value.salaryAccountA.bank=t),placeholder:"請輸入銀行資訊"},null,8,["modelValue"])]),_:1}),o(m,{label:"帳號"},{default:u(()=>[o(s,{modelValue:n.value.salaryAccountA.acct,"onUpdate:modelValue":e[71]||(e[71]=t=>n.value.salaryAccountA.acct=t),placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1})])]),i("div",$o,[e[130]||(e[130]=i("h4",{class:"account-subtitle"},"薪資帳戶 B",-1)),i("div",Yo,[o(m,{label:"銀行代碼/名稱"},{default:u(()=>[o(s,{modelValue:n.value.salaryAccountB.bank,"onUpdate:modelValue":e[72]||(e[72]=t=>n.value.salaryAccountB.bank=t),placeholder:"請輸入銀行資訊"},null,8,["modelValue"])]),_:1}),o(m,{label:"帳號"},{default:u(()=>[o(s,{modelValue:n.value.salaryAccountB.acct,"onUpdate:modelValue":e[73]||(e[73]=t=>n.value.salaryAccountB.acct=t),placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1})])])])])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(ul,{modelValue:_e.value,"onUpdate:modelValue":e[80]||(e[80]=t=>_e.value=t),title:"批量匯入員工",width:"720px",class:"bulk-import-dialog","close-on-click-modal":!1,"before-close":mt},{footer:u(()=>[o(d,{onClick:ct},{default:u(()=>e[145]||(e[145]=[E("取消")])),_:1}),o(d,{type:"primary",loading:we.value,disabled:!Al.value||we.value,onClick:il},{default:u(()=>e[146]||(e[146]=[E(" 開始匯入 ")])),_:1},8,["loading","disabled"])]),default:u(()=>[i("div",Ko,[o(dl,{type:"info","show-icon":"",closable:!1},{title:u(()=>e[134]||(e[134]=[E(" 下載範本後依欄位填寫資料，或直接使用範本內建的 5 筆示範資料測試匯入流程。 ")])),default:u(()=>[i("div",Go,[e[136]||(e[136]=i("i",{class:"el-icon-document"},null,-1)),o(d,{type:"primary",link:"","data-test":"bulk-import-template-download",onClick:Sa},{default:u(()=>e[135]||(e[135]=[E(" 下載匯入範本 ")])),_:1})])]),_:1})]),i("div",Xo,[o(I,{drag:"",action:"","auto-upload":!1,accept:".xlsx,.xls,.csv","file-list":ce.value,limit:1,"on-change":ia,"on-remove":ua},{default:u(()=>e[137]||(e[137]=[i("i",{class:"el-icon-upload"},null,-1),i("div",{class:"el-upload__text"},[E(" 將檔案拖曳至此或 "),i("em",null,"點此選擇")],-1),i("div",{class:"el-upload__tip"},"支援 .xlsx、.xls、.csv 檔案格式，檔案大小請勿超過 5MB",-1)])),_:1},8,["file-list"])]),i("div",Ho,[e[140]||(e[140]=i("h3",{class:"bulk-import-subtitle"},"欄位格式與必填說明",-1)),e[141]||(e[141]=i("p",{class:"bulk-import-description"}," 系統已預先套用官方批量匯入 Excel 模板，請依下列欄位填寫資料後再上傳檔案。 ",-1)),o(dl,{type:"warning","show-icon":"",class:"bulk-import-required-alert",closable:!1},{title:u(()=>[E("必填欄位："+k(_a.value.join("、")),1)]),default:u(()=>[e[138]||(e[138]=i("div",null,"若未提供必填欄位資料，匯入時將提示錯誤並中止處理。",-1))]),_:1}),(g(!0),h(S,null,L(ha.value,t=>(g(),h("section",{key:t.title,class:"bulk-import-section"},[i("h4",Wo,k(t.title),1),o(p,{data:t.fields,border:"",size:"small",class:"bulk-import-table"},{default:u(()=>[o(f,{prop:"header",label:"Excel 欄位 (英文)",width:"220"},{default:u(({row:A})=>[i("code",Jo,k(A.header),1)]),_:1}),o(f,{prop:"displayDescription",label:"欄位說明","min-width":"300"},{default:u(({row:A})=>[E(k(A.displayDescription||A.description||A.label||A.header),1)]),_:1}),o(f,{label:"是否必填",width:"120",align:"center"},{default:u(({row:A})=>[A.required?(g(),T(v,{key:0,type:"danger",size:"small"},{default:u(()=>e[139]||(e[139]=[E("必填")])),_:1})):(g(),h("span",Qo,"選填"))]),_:1})]),_:2},1032,["data"])]))),128)),e[142]||(e[142]=i("h3",{class:"bulk-import-subtitle bulk-import-options-title"},"匯入參數設定",-1)),o(Xl,{model:C,"label-width":"150px"},{default:u(()=>[o(m,{label:"匯入預設權限",required:""},{default:u(()=>[o(r,{modelValue:C.options.defaultRole,"onUpdate:modelValue":e[77]||(e[77]=t=>C.options.defaultRole=t),placeholder:"請選擇預設權限"},{default:u(()=>[(g(),h(S,null,L(Ie,t=>o(a,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"預設登入密碼"},{default:u(()=>[o(s,{modelValue:C.options.resetPassword,"onUpdate:modelValue":e[78]||(e[78]=t=>C.options.resetPassword=t),type:"password","show-password":"",placeholder:"未設定則由後端自動產生"},null,8,["modelValue"])]),_:1}),o(m,{label:"寄發通知信"},{default:u(()=>[o(O,{modelValue:C.options.sendWelcomeEmail,"onUpdate:modelValue":e[79]||(e[79]=t=>C.options.sendWelcomeEmail=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),se.value.length||Y.value.length?(g(),h("div",Zo,[Y.value.length?(g(),T(dl,{key:0,type:"warning",closable:!1,"show-icon":"",class:"bulk-import-error"},{title:u(()=>e[143]||(e[143]=[E("匯入時發現以下問題，請確認後重新處理：")])),default:u(()=>[i("ul",en,[(g(!0),h(S,null,L(Y.value,(t,A)=>(g(),h("li",{key:A},k(t),1))),128))])]),_:1})):X("",!0),se.value.length?(g(),h("div",ln,[e[144]||(e[144]=i("h4",null,"匯入預覽",-1)),o(p,{data:se.value,size:"small",height:"240"},{default:u(()=>[o(f,{prop:"employeeNo",label:"員工編號",width:"140"}),o(f,{prop:"name",label:"姓名",width:"140"}),o(f,{prop:"department",label:"部門","min-width":"120"}),o(f,{prop:"role",label:"權限",width:"120"}),o(f,{prop:"email",label:"Email","min-width":"160"})]),_:1},8,["data"])])):X("",!0)])):X("",!0)]),_:1},8,["modelValue"]),o(ul,{modelValue:K.value,"onUpdate:modelValue":e[82]||(e[82]=t=>K.value=t),title:Ae.value||"補齊參照對應",width:"640px",class:"reference-mapping-dialog","close-on-click-modal":!1},{footer:u(()=>[o(d,{onClick:e[81]||(e[81]=t=>K.value=!1),disabled:me.value},{default:u(()=>e[149]||(e[149]=[E(" 稍後再處理 ")])),_:1},8,["disabled"]),o(d,{type:"primary",loading:me.value,onClick:Vt},{default:u(()=>e[150]||(e[150]=[E(" 套用設定後重新匯入 ")])),_:1},8,["loading"])]),default:u(()=>[e[151]||(e[151]=i("p",{class:"reference-mapping-tip"}," 請為下列資料選擇對應的既有項目，或設定忽略後重新嘗試匯入。 ",-1)),K.value?(g(),h("div",an,[l.section&&Array.isArray(l.section.values)&&l.section.values.length?(g(!0),h(S,{key:0},L(yl.value,t=>(g(),h("div",{key:t.type,class:"reference-mapping-section"},[i("h4",tn,k(ba(t.type))+"對應 ",1),(g(!0),h(S,null,L(t.values,A=>(g(),h("div",{key:Z(A),class:"reference-mapping-item"},[i("div",rn,[i("span",on,k(A.value||"（空值）"),1),i("span",nn," 出現於第 "+k((A.rows||[]).join("、"))+" 列 ",1)]),o(y,{modelValue:ge(t.type,Z(A)).mode,"onUpdate:modelValue":b=>ge(t.type,Z(A)).mode=b,class:"reference-mapping-mode"},{default:u(()=>[o(_,{label:"map"},{default:u(()=>e[147]||(e[147]=[E("指定既有資料")])),_:1}),o(_,{label:"ignore"},{default:u(()=>e[148]||(e[148]=[E("忽略此次匯入")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),ge(t.type,Z(A)).mode==="map"?(g(),T(r,{key:0,modelValue:ge(t.type,Z(A)).targetId,"onUpdate:modelValue":b=>ge(t.type,Z(A)).targetId=b,placeholder:"請選擇既有項目",class:"reference-mapping-select",filterable:"",clearable:""},{default:u(()=>[(g(!0),h(S,null,L(t.options,b=>(g(),T(a,{key:b.id,label:ft(t.type,b),value:b.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):X("",!0)]))),128))]))),128)):X("",!0),ra.value?X("",!0):(g(),h("div",sn," 所有參照皆已處理，請重新送出匯入。 "))])):X("",!0)]),_:1},8,["modelValue","title"])])]),_:1})}}},cn=Hl(dn,[["__scopeId","data-v-8516fb03"]]),mn={class:"hr-management-system-setting"},pn={__name:"HRManagementSystemSetting",setup(Wl){const oe=D("employeeMgmt");return(pl,de)=>{const Pe=R("el-tabs");return g(),h("div",mn,[de[1]||(de[1]=i("h2",null,"人事管理與系統設定",-1)),o(Pe,{modelValue:oe.value,"onUpdate:modelValue":de[0]||(de[0]=H=>oe.value=H),type:"card"},{default:u(()=>[o(cn)]),_:1},8,["modelValue"])])}}},gn=Hl(pn,[["__scopeId","data-v-8631704d"]]);export{gn as default};
