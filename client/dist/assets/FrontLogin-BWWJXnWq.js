import{_ as j,r as v,c as p,a as V,b as e,d as n,w as i,e as u,u as M,o as k,f as L,F as B,k as S,n as F,t as _,s as H,E as m}from"./index-BOg20HvU.js";import{u as I}from"./menu-Diu3JIyb.js";import{a as R}from"./api-D4yO7thr.js";const T={class:"front-login-container"},Z={class:"login-form-container"},z={class:"role-selection"},N=["onClick"],q=["innerHTML"],E={class:"role-info"},$={class:"role-name"},O={class:"role-desc"},P={key:0},U={key:1},D={__name:"FrontLogin",setup(J){const d=M(),g=I(),t=v({role:"employee",username:"",password:""}),h=v(null),c=v(!1),C=[{value:"employee",label:"一般員工",description:"查看排班、打卡考勤",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'},{value:"supervisor",label:"部門主管",description:"管理排班、審核請假",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M23 21V19C23 18.1645 22.7155 17.3541 22.2094 16.6977C21.7033 16.0414 20.9999 15.5759 20.2 15.3805" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 3.13C16.8003 3.32548 17.5037 3.79099 18.0098 4.44738C18.5159 5.10377 18.8002 5.91416 18.8002 6.75C18.8002 7.58584 18.5159 8.39623 18.0098 9.05262C17.5037 9.70901 16.8003 10.1745 16 10.37" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'},{value:"admin",label:"系統管理員",description:"完整系統管理權限",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 15L8 11L10.5 8.5L12 10L15.5 6.5L18 9L12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'}],b={role:[{required:!0,message:"請選擇身份",trigger:"change"}],username:[{required:!0,message:"請輸入員工帳號",trigger:"blur"},{min:3,message:"帳號長度至少3個字符",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:6,message:"密碼長度至少6個字符",trigger:"blur"}]};async function f(){var w;if(h.value)try{if(!await h.value.validate())return;c.value=!0;const l=await R("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.value.username,password:t.value.password})}),s=await l.json();if(l.ok)switch(H(s.token),localStorage.setItem("role",s.user.role),localStorage.setItem("employeeId",s.user.employeeId),m.success(`歡迎回來，${(w=C.find(a=>a.value===s.user.role))==null?void 0:w.label}！`),await g.fetchMenu(),s.user.role){case"employee":d.push("/front/attendance");break;case"supervisor":d.push("/front/schedule");break;case"admin":const a=g.items[0];a?d.push({name:a.name}):d.push("/layout");break;default:d.push("/front/attendance");break}else m.error(s.message||"登入失敗，請檢查帳號密碼")}catch(o){console.error("Login error:",o),m.error(`登入失敗: ${o.message}`)}finally{c.value=!1}}return(w,o)=>{const l=u("el-form-item"),s=u("el-input"),a=u("el-button"),x=u("el-form"),y=u("el-card");return k(),p("div",T,[o[7]||(o[7]=V('<div class="login-background" data-v-42b46cdf><div class="login-brand" data-v-42b46cdf><div class="brand-icon" data-v-42b46cdf><svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-42b46cdf><path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-42b46cdf></path><circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-42b46cdf></circle><path d="M23 21V19C23 18.1645 22.7155 17.3541 22.2094 16.6977C21.7033 16.0414 20.9999 15.5759 20.2 15.3805" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-42b46cdf></path><path d="M16 3.13C16.8003 3.32548 17.5037 3.79099 18.0098 4.44738C18.5159 5.10377 18.8002 5.91416 18.8002 6.75C18.8002 7.58584 18.5159 8.39623 18.0098 9.05262C17.5037 9.70901 16.8003 10.1745 16 10.37" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-42b46cdf></path></svg></div><h1 class="brand-title" data-v-42b46cdf>員工入口</h1><p class="brand-subtitle" data-v-42b46cdf>Human Resources Portal</p></div></div>',1)),e("div",Z,[n(y,{class:"login-card",shadow:"always"},{default:i(()=>[o[5]||(o[5]=e("div",{class:"login-header"},[e("h2",{class:"login-title"},"員工登入"),e("p",{class:"login-description"},"選擇您的身份並登入系統")],-1)),n(x,{model:t.value,ref_key:"loginFormRef",ref:h,class:"login-form",rules:b,onSubmit:L(f,["prevent"])},{default:i(()=>[n(l,{prop:"role",class:"form-item"},{default:i(()=>[o[2]||(o[2]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"選擇身份")],-1)),e("div",z,[(k(),p(B,null,S(C,r=>e("div",{key:r.value,class:F(["role-card",{active:t.value.role===r.value}]),onClick:A=>t.value.role=r.value},[e("div",{class:"role-icon",innerHTML:r.icon},null,8,q),e("div",E,[e("div",$,_(r.label),1),e("div",O,_(r.description),1)])],10,N)),64))])]),_:1}),n(l,{prop:"username",class:"form-item"},{default:i(()=>[o[3]||(o[3]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"員工帳號")],-1)),n(s,{modelValue:t.value.username,"onUpdate:modelValue":o[0]||(o[0]=r=>t.value.username=r),placeholder:"請輸入員工帳號",size:"large",class:"custom-input"},null,8,["modelValue"])]),_:1}),n(l,{prop:"password",class:"form-item"},{default:i(()=>[o[4]||(o[4]=e("div",{class:"input-label"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"12",cy:"16",r:"1",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"密碼")],-1)),n(s,{modelValue:t.value.password,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value.password=r),type:"password",placeholder:"請輸入密碼",size:"large",class:"custom-input","show-password":""},null,8,["modelValue"])]),_:1}),n(l,{class:"form-item"},{default:i(()=>[n(a,{type:"primary",size:"large",class:"login-button",loading:c.value,onClick:f,"native-type":"submit"},{default:i(()=>[c.value?(k(),p("span",U,"登入中...")):(k(),p("span",P,"登入系統"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),o[6]||(o[6]=e("div",{class:"access-info"},[e("div",{class:"info-item"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 6V12L16 14",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"24小時全天候服務")]),e("div",{class:"info-item"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 22S8 18 8 13V6L12 4L16 6V13C16 18 12 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"安全加密傳輸")])],-1))]),_:1})])])}}},W=j(D,[["__scopeId","data-v-42b46cdf"]]);export{W as default};
