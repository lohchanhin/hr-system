import{a as b}from"./api-ZZnZ46lj.js";import{_ as A,r as k,g as M,c as N,d as V,a as l,w as a,b as u,o as S,e as p}from"./index-DoO9I7c3.js";const T={class:"attendance-mgmt-setting"},D={__name:"AttendanceManagementSetting",setup(I){const t=k({enableImport:!1,importFormat:"",importMapping:"",allowMakeUpClock:!0,makeUpDays:3,makeUpNeedApprove:!0,supervisorCrossDept:!1,hrAllDept:!0,employeeHistoryMonths:6,nonExtWorkAlert:!1,overtimeNoClockNotify:!0,notifyTargets:["員工","主管"]}),m=k(""),r=localStorage.getItem("token")||"";async function x(){const i=await b("/api/attendance-settings",{headers:{Authorization:`Bearer ${r}`}});if(i.ok){const e=await i.json();e.length&&(Object.assign(t.value,e[0]),m.value=e[0]._id||"")}}async function g(){const i={...t.value};let e;if(m.value?e=await b(`/api/attendance-settings/${m.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(i)}):e=await b("/api/attendance-settings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(i)}),e.ok){const s=await e.json();m.value=s._id||m.value,alert("已儲存「考勤管理設定」")}}return M(x),(i,e)=>{const s=u("el-divider"),d=u("el-switch"),n=u("el-form-item"),v=u("el-option"),y=u("el-select"),c=u("el-input"),_=u("el-input-number"),f=u("el-checkbox"),U=u("el-checkbox-group"),C=u("el-button"),w=u("el-form");return S(),N("div",T,[e[19]||(e[19]=V("h2",null,"考勤管理設定",-1)),l(w,{model:t.value,"label-width":"180px",class:"setting-form"},{default:a(()=>[l(s,{"content-position":"left"},{default:a(()=>e[12]||(e[12]=[p("資料匯入設定")])),_:1}),l(n,{label:"是否啟用外部刷卡匯入"},{default:a(()=>[l(d,{modelValue:t.value.enableImport,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.enableImport=o),"active-text":"啟用","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),l(n,{label:"匯入檔案格式"},{default:a(()=>[l(y,{modelValue:t.value.importFormat,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.importFormat=o),placeholder:"選擇匯入檔格式",disabled:!t.value.enableImport},{default:a(()=>[l(v,{label:"CSV",value:"csv"}),l(v,{label:"Excel (XLSX)",value:"xlsx"}),l(v,{label:"TXT (定長欄位)",value:"txt"})]),_:1},8,["modelValue","disabled"])]),_:1}),l(n,{label:"匯入欄位對應 (範例)"},{default:a(()=>[l(c,{modelValue:t.value.importMapping,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.importMapping=o),placeholder:"如：員工編號→Column A, 日期→Column B, 上班時間→Column C...",disabled:!t.value.enableImport},null,8,["modelValue","disabled"])]),_:1}),l(s,{"content-position":"left"},{default:a(()=>e[13]||(e[13]=[p("補打卡審核設定")])),_:1}),l(n,{label:"是否允許員工提出補打卡"},{default:a(()=>[l(d,{modelValue:t.value.allowMakeUpClock,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.allowMakeUpClock=o),"active-text":"允許","inactive-text":"不允許"},null,8,["modelValue"])]),_:1}),l(n,{label:"最晚可補打卡天數"},{default:a(()=>[l(_,{modelValue:t.value.makeUpDays,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.makeUpDays=o),min:0,disabled:!t.value.allowMakeUpClock},null,8,["modelValue","disabled"]),e[14]||(e[14]=V("small",null,"（允許員工多少天之內可以補打卡）",-1))]),_:1}),l(n,{label:"補打卡是否需主管簽核"},{default:a(()=>[l(d,{modelValue:t.value.makeUpNeedApprove,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.makeUpNeedApprove=o),disabled:!t.value.allowMakeUpClock},null,8,["modelValue","disabled"])]),_:1}),l(s,{"content-position":"left"},{default:a(()=>e[15]||(e[15]=[p("查詢權限設定")])),_:1}),l(n,{label:"主管是否可查跨部門考勤"},{default:a(()=>[l(d,{modelValue:t.value.supervisorCrossDept,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.supervisorCrossDept=o),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),l(n,{label:"HR 是否可查所有部門"},{default:a(()=>[l(d,{modelValue:t.value.hrAllDept,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.hrAllDept=o),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),l(n,{label:"員工可查詢歷史紀錄(月)"},{default:a(()=>[l(_,{modelValue:t.value.employeeHistoryMonths,"onUpdate:modelValue":e[8]||(e[8]=o=>t.value.employeeHistoryMonths=o),min:1},null,8,["modelValue"]),e[16]||(e[16]=V("small",null,"（員工可往前查詢幾個月？）",-1))]),_:1}),l(s,{"content-position":"left"},{default:a(()=>e[17]||(e[17]=[p("異常提醒")])),_:1}),l(n,{label:"非延長工時提醒"},{default:a(()=>[l(d,{modelValue:t.value.nonExtWorkAlert,"onUpdate:modelValue":e[9]||(e[9]=o=>t.value.nonExtWorkAlert=o),"active-text":"啟用","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),l(n,{label:"逾時未打卡是否自動通知"},{default:a(()=>[l(d,{modelValue:t.value.overtimeNoClockNotify,"onUpdate:modelValue":e[10]||(e[10]=o=>t.value.overtimeNoClockNotify=o),"active-text":"啟用","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),l(n,{label:"通知對象"},{default:a(()=>[l(U,{modelValue:t.value.notifyTargets,"onUpdate:modelValue":e[11]||(e[11]=o=>t.value.notifyTargets=o)},{default:a(()=>[l(f,{label:"員工"}),l(f,{label:"主管"}),l(f,{label:"HR"})]),_:1},8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[l(C,{type:"primary",onClick:g},{default:a(()=>e[18]||(e[18]=[p("儲存設定")])),_:1})]),_:1})]),_:1},8,["model"])])}}},E=A(D,[["__scopeId","data-v-d15818dd"]]);export{E as default};
