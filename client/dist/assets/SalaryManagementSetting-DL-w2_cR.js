import{a as F}from"./api-747mdiEG.js";import{_ as Te,r,j as A,k as Le,c as D,b as o,d as l,w as a,e as m,o as h,g as d,F as le,t as ae,n as te,q as Y,v as i,A as Oe}from"./index-BkCwXqkM.js";const Ee={class:"salary-management-setting"},Ye={class:"tab-content"},Ge={slot:"footer",class:"dialog-footer"},We={class:"tab-content"},qe={class:"tab-content"},Je={slot:"footer",class:"dialog-footer"},Ke={class:"tab-content"},Qe={class:"tab-content"},Xe={class:"export-card__header"},Ze={class:"export-card__title"},el={class:"export-card__actions"},ll={key:0},al={class:"stat-item"},tl={class:"stat-value"},ol={class:"stat-item"},nl={class:"stat-value"},sl={class:"stat-item"},dl={class:"stat-value"},il={class:"stat-item"},ul={class:"stat-value"},rl={key:0},pl={class:"stat-box"},ml={class:"stat-value"},vl={class:"stat-box"},fl={class:"stat-value"},cl={class:"stat-box"},bl={class:"stat-value"},_l={class:"stat-box"},yl={class:"stat-value"},hl={key:0,style:{"margin-top":"20px"}},gl={class:"stat-box"},wl={class:"stat-value"},kl={class:"stat-box"},Vl={class:"stat-value"},xl={class:"stat-box"},Dl={class:"stat-value"},Sl={class:"stat-box"},Cl={class:"stat-value"},Fl={key:0,style:{"margin-top":"20px"}},Pl={class:"stat-box"},Ul={class:"stat-value"},Al={class:"stat-box"},Nl={class:"stat-value"},jl={key:0,style:{"margin-top":"20px"}},Bl={style:{"margin-top":"20px","text-align":"right","font-size":"18px","font-weight":"bold"}},Rl={__name:"SalaryManagementSetting",setup($l){const ue=r("grade"),I=r(null),P=r([{gradeName:"初階A",baseSalary:28e3,description:"新進職等"},{gradeName:"中階B",baseSalary:35e3,description:"需具2年以上經驗"},{gradeName:"高階C",baseSalary:5e4,description:"需具5年以上經驗"}]),M=r(!1);let G=null;const k=r({gradeName:"",baseSalary:0,description:""});function re(n=null){n!==null?(G=n,k.value={...P.value[n]}):(G=null,k.value={gradeName:"",baseSalary:0,description:""}),M.value=!0}function ce(){G===null?P.value.push({...k.value}):P.value[G]={...k.value},M.value=!1,T()}function be(n){P.value.splice(n,1),T()}const g=r({historyMonths:24,effectiveRule:"nextMonth1",needMultiApproval:!0,needRetroactive:!0});function _e(){console.log("儲存調薪與異動規則:",g.value),T()}const C=r({defaultBank:"004",batchFormat:"formatA"}),W=r(!1),pe=r([{employeeName:"王小明",bankCode:"004",accountNumber:"1234567890123"},{employeeName:"李主管",bankCode:"822",accountNumber:"0987654321"}]);function ye(){W.value=!0}function he(n){alert(`編輯帳戶：${pe.value[n].employeeName}`)}function ge(){console.log("儲存發放設定:",C.value),T()}const V=r({includeDependents:!1,courtGarnishment:!1,diffAdjustmentMonths:3});function we(){console.log("儲存其他薪資設定:",V.value),T()}const U=r(new Date().toISOString().substring(0,7)+"-01"),z=r([]),q=r(""),J=r(""),K=r(""),Q=r(""),N=r("taiwan"),X=r(!0),oe=r(!1),me=r([]),ve=r([]),fe=r([]),Z=r(!1),f=r(null),S=r(null),H=A(()=>{if(!Q.value)return z.value;const n=Q.value.toLowerCase();return z.value.filter(e=>{var u;return e.name.toLowerCase().includes(n)||((u=e.employeeId)==null?void 0:u.toLowerCase().includes(n))})}),ke=A(()=>H.value.reduce((n,e)=>n+(e.baseSalary||0),0)),Ve=A(()=>H.value.reduce((n,e)=>n+(e.netPay||0),0)),xe=A(()=>H.value.reduce((n,e)=>{const u=(e.laborInsuranceFee||0)+(e.healthInsuranceFee||0)+(e.laborPensionSelf||0)+(e.otherDeductions||0);return n+u},0)),De={taiwan:[{label:"付款代號",prop:"code",width:100},{label:"付款日期",prop:"date",width:120},{label:"付款帳號",prop:"account",width:160},{label:"收款戶名",prop:"payee",width:120},{label:"收款行代碼",prop:"bank",width:100},{label:"收款帳號",prop:"payeeAccount",width:160},{label:"備註",prop:"note"}],taichung:[{label:"流水號",prop:"serial",width:100},{label:"姓名",prop:"name",width:120},{label:"轉入帳號",prop:"account",width:160},{label:"轉入金額",prop:"amount",width:120,align:"right"},{label:"核證總數",prop:"checksum",width:120}],bonusSlip:[{label:"員工編號",prop:"employeeId",width:120},{label:"姓名",prop:"name",width:120},{label:"部門",prop:"department",width:140},{label:"銀行代碼",prop:"bankCode",width:100},{label:"帳號末四碼",prop:"accountTail",width:110},{label:"加班費",prop:"overtime",width:100,align:"right"},{label:"績效獎金",prop:"performance",width:110,align:"right"},{label:"其他獎金",prop:"otherBonus",width:110,align:"right"},{label:"簽核調整",prop:"adjustment",width:110,align:"right"},{label:"獎金合計",prop:"total",width:110,align:"right"}]},Se={taiwan:[{code:"0001",date:"2024/05/31",account:"050-5206-123456789012",payee:"王曉明",bank:"050-5206",payeeAccount:"1234-5678-9012",note:"薪資"},{code:"0002",date:"2024/05/31",account:"050-5206-123456789012",payee:"李小華",bank:"050-5206",payeeAccount:"7890-1234-5678",note:"薪資"}],taichung:[{serial:"1",name:"王曉明",account:"054-123-4567890",amount:"35,000",checksum:"35,000"},{serial:"2",name:"李小華",account:"054-987-6543210",amount:"32,000",checksum:"99,000"}],bonusSlip:[{employeeId:"E001",name:"王曉明",department:"工程部",bankCode:"004",accountTail:"9012",overtime:"1,200",performance:"2,000",otherBonus:"800",adjustment:"0",total:"4,000"},{employeeId:"E002",name:"李小華",department:"行政部",bankCode:"822",accountTail:"4321",overtime:"600",performance:"1,200",otherBonus:"500",adjustment:"-100",total:"2,200"}]},Ce=A(()=>De[N.value]||[]),Fe=A(()=>Se[N.value]||[]),Pe=A(()=>{if(!f.value)return[];const n=[],e=f.value;if(e.salaryType==="時薪")n.push({item:"基本薪資計算",description:`${(e.actualWorkHours||0).toFixed(2)} 小時 × ${p(e.hourlyRate)}`,amount:e.baseSalary||0,type:"income"});else if(e.salaryType==="日薪"){const u=e.hourlyRate*8;n.push({item:"基本薪資計算",description:`${e.workDays||0} 天 × ${p(u)}`,amount:e.baseSalary||0,type:"income"})}else n.push({item:"基本薪資",description:"月薪制",amount:e.baseSalary||0,type:"income"});return e.leaveDeduction>0&&n.push({item:"請假扣款",description:`無薪假 ${(e.unpaidLeaveHours||0).toFixed(2)} 小時`,amount:e.leaveDeduction,type:"deduction"}),e.laborInsuranceFee>0&&n.push({item:"勞保費",description:"員工自付額",amount:e.laborInsuranceFee,type:"deduction"}),e.healthInsuranceFee>0&&n.push({item:"健保費",description:"員工自付額",amount:e.healthInsuranceFee,type:"deduction"}),e.laborPensionSelf>0&&n.push({item:"勞退提繳",description:"個人提繳",amount:e.laborPensionSelf,type:"deduction"}),e.employeeAdvance>0&&n.push({item:"員工借支",description:"",amount:e.employeeAdvance,type:"deduction"}),e.otherDeductions>0&&n.push({item:"其他扣款",description:"",amount:e.otherDeductions,type:"deduction"}),e.overtimePay>0&&n.push({item:"加班費",description:`${(e.overtimeHours||0).toFixed(2)} 小時`,amount:e.overtimePay,type:"bonus"}),e.nightShiftAllowance>0&&n.push({item:"夜班津貼",description:"",amount:e.nightShiftAllowance,type:"bonus"}),e.performanceBonus>0&&n.push({item:"績效獎金",description:"",amount:e.performanceBonus,type:"bonus"}),e.otherBonuses>0&&n.push({item:"其他獎金",description:"",amount:e.otherBonuses,type:"bonus"}),n});async function Ue(){try{oe.value=!0;const n=new URLSearchParams({month:U.value,format:N.value}),e=await F(`/api/payroll/export?${n}`,{method:"POST"});if(!e.ok){const L=await e.json().catch(()=>({}));throw new Error(L.error||"匯出失敗，請稍後再試")}const u=await e.blob(),s=URL.createObjectURL(u),_=document.createElement("a");_.href=s,_.download=`payroll_${U.value}_${N.value}.xlsx`,_.click(),URL.revokeObjectURL(s)}catch(n){console.error("匯出薪資Excel失敗:",n),alert(n.message||"匯出失敗，請稍後再試")}finally{oe.value=!1}}function p(n){return n==null||isNaN(n)?"NT$ 0":"NT$ "+Math.round(n).toLocaleString("zh-TW")}async function j(){try{const n=new URLSearchParams({month:U.value});q.value&&n.append("organization",q.value),J.value&&n.append("department",J.value),K.value&&n.append("subDepartment",K.value);const e=await F(`/api/payroll/overview/monthly?${n}`);e.ok?z.value=await e.json():(console.error("Failed to fetch monthly overview"),z.value=[])}catch(n){console.error("Error fetching monthly overview:",n),z.value=[]}}async function Ae(){try{const n=await F("/api/organizations");n.ok&&(me.value=await n.json())}catch(n){console.error("Error fetching organizations:",n)}}async function Ne(){try{const n=await F("/api/departments");n.ok&&(ve.value=await n.json())}catch(n){console.error("Error fetching departments:",n)}}async function je(){try{const n=await F("/api/subdepartments");n.ok&&(fe.value=await n.json())}catch(n){console.error("Error fetching sub-departments:",n)}}async function Be(n){f.value=n,Z.value=!0;try{const e=await F(`/api/payroll/complete-data/${n._id}/${U.value}`);e.ok?S.value=await e.json():(console.error("Failed to fetch employee detail data"),S.value=null)}catch(e){console.error("Error fetching employee detail data:",e),S.value=null}}async function Re(){const n=await F("/api/salary-settings");if(n.ok){const e=await n.json();if(e.length){const u=e[0];I.value=u._id,P.value=u.grades||[],Object.assign(g.value,u.adjust||{}),Object.assign(C.value,u.payment||{}),Object.assign(V.value,u.other||{})}}}async function T(){const n={grades:P.value,adjust:g.value,payment:C.value,other:V.value},e=I.value?`/api/salary-settings/${I.value}`:"/api/salary-settings",u=I.value?"PUT":"POST",s=await F(e,{method:u,headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(s.ok){const _=await s.json();I.value=_._id}}return Le(()=>{Re(),Ae(),Ne(),je(),j()}),(n,e)=>{const u=m("el-button"),s=m("el-table-column"),_=m("el-table"),L=m("el-input"),v=m("el-form-item"),ne=m("el-input-number"),O=m("el-form"),se=m("el-dialog"),E=m("el-tab-pane"),w=m("el-option"),B=m("el-select"),ee=m("el-switch"),$e=m("el-date-picker"),de=m("el-radio-button"),Ie=m("el-radio-group"),Me=m("el-alert"),x=m("el-card"),c=m("el-col"),R=m("el-row"),ie=m("el-tag"),$=m("el-descriptions-item"),ze=m("el-descriptions"),He=m("el-tabs");return h(),D("div",Ee,[e[74]||(e[74]=o("h2",null,"薪資管理設定",-1)),l(He,{modelValue:ue.value,"onUpdate:modelValue":e[27]||(e[27]=t=>ue.value=t),type:"card"},{default:a(()=>[l(E,{label:"職等與底薪",name:"grade"},{default:a(()=>[o("div",Ye,[l(u,{type:"primary",onClick:e[0]||(e[0]=t=>re())},{default:a(()=>[...e[28]||(e[28]=[d("新增職等",-1)])]),_:1}),l(_,{data:P.value,style:{"margin-top":"20px"}},{default:a(()=>[l(s,{prop:"gradeName",label:"職等名稱",width:"180"}),l(s,{prop:"baseSalary",label:"基本薪資",width:"120"}),l(s,{prop:"description",label:"說明"}),l(s,{label:"操作",width:"180"},{default:a(({row:t,$index:y})=>[l(u,{type:"primary",onClick:b=>re(y)},{default:a(()=>[...e[29]||(e[29]=[d("編輯",-1)])]),_:1},8,["onClick"]),l(u,{type:"danger",onClick:b=>be(y)},{default:a(()=>[...e[30]||(e[30]=[d("刪除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),l(se,{modelValue:M.value,"onUpdate:modelValue":e[5]||(e[5]=t=>M.value=t),title:"職等設定",width:"400px"},{default:a(()=>[l(O,{model:k.value,"label-width":"100px"},{default:a(()=>[l(v,{label:"名稱"},{default:a(()=>[l(L,{modelValue:k.value.gradeName,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value.gradeName=t),placeholder:"如：職等A / 初階 / 資深…"},null,8,["modelValue"])]),_:1}),l(v,{label:"基本薪資"},{default:a(()=>[l(ne,{modelValue:k.value.baseSalary,"onUpdate:modelValue":e[2]||(e[2]=t=>k.value.baseSalary=t),min:0},null,8,["modelValue"])]),_:1}),l(v,{label:"說明"},{default:a(()=>[l(L,{modelValue:k.value.description,"onUpdate:modelValue":e[3]||(e[3]=t=>k.value.description=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),o("span",Ge,[l(u,{onClick:e[4]||(e[4]=t=>M.value=!1)},{default:a(()=>[...e[31]||(e[31]=[d("取消",-1)])]),_:1}),l(u,{type:"primary",onClick:ce},{default:a(()=>[...e[32]||(e[32]=[d("儲存",-1)])]),_:1})])]),_:1},8,["modelValue"])])]),_:1}),l(E,{label:"調薪與異動",name:"adjust"},{default:a(()=>[o("div",We,[l(O,{model:g.value,"label-width":"180px"},{default:a(()=>[l(v,{label:"歷史薪資保留(個月)"},{default:a(()=>[l(ne,{modelValue:g.value.historyMonths,"onUpdate:modelValue":e[6]||(e[6]=t=>g.value.historyMonths=t),min:0},null,8,["modelValue"]),e[33]||(e[33]=o("small",null,"保留多久前的薪資紀錄",-1))]),_:1}),l(v,{label:"調薪生效日規則"},{default:a(()=>[l(B,{modelValue:g.value.effectiveRule,"onUpdate:modelValue":e[7]||(e[7]=t=>g.value.effectiveRule=t)},{default:a(()=>[l(w,{label:"次月一號",value:"nextMonth1"}),l(w,{label:"當月同日",value:"sameDay"}),l(w,{label:"依簽核通過日",value:"approvalDate"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"是否需多層簽核"},{default:a(()=>[l(ee,{modelValue:g.value.needMultiApproval,"onUpdate:modelValue":e[8]||(e[8]=t=>g.value.needMultiApproval=t)},null,8,["modelValue"])]),_:1}),l(v,{label:"薪資差異補發 / 補扣"},{default:a(()=>[l(ee,{modelValue:g.value.needRetroactive,"onUpdate:modelValue":e[9]||(e[9]=t=>g.value.needRetroactive=t)},null,8,["modelValue"])]),_:1}),l(v,null,{default:a(()=>[l(u,{type:"primary",onClick:_e},{default:a(()=>[...e[34]||(e[34]=[d("儲存調薪規則",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),l(E,{label:"發放與帳戶",name:"payment"},{default:a(()=>[o("div",qe,[l(O,{model:C.value,"label-width":"160px"},{default:a(()=>[l(v,{label:"預設銀行代碼"},{default:a(()=>[l(B,{modelValue:C.value.defaultBank,"onUpdate:modelValue":e[10]||(e[10]=t=>C.value.defaultBank=t),placeholder:"選擇銀行"},{default:a(()=>[l(w,{label:"台灣銀行 (004)",value:"004"}),l(w,{label:"台新銀行 (812)",value:"812"}),l(w,{label:"中國信託 (822)",value:"822"}),l(w,{label:"國泰世華 (013)",value:"013"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"發薪帳戶維護"},{default:a(()=>[l(u,{type:"primary",onClick:e[11]||(e[11]=t=>ye())},{default:a(()=>[...e[35]||(e[35]=[d("管理帳戶",-1)])]),_:1})]),_:1}),l(v,{label:"薪資轉帳批次格式"},{default:a(()=>[l(B,{modelValue:C.value.batchFormat,"onUpdate:modelValue":e[12]||(e[12]=t=>C.value.batchFormat=t)},{default:a(()=>[l(w,{label:"自訂格式 A",value:"formatA"}),l(w,{label:"自訂格式 B",value:"formatB"})]),_:1},8,["modelValue"])]),_:1}),l(v,null,{default:a(()=>[l(u,{type:"primary",onClick:ge},{default:a(()=>[...e[36]||(e[36]=[d("儲存發放設定",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),l(se,{modelValue:W.value,"onUpdate:modelValue":e[14]||(e[14]=t=>W.value=t),title:"銀行帳戶維護",width:"600px"},{default:a(()=>[l(_,{data:pe.value},{default:a(()=>[l(s,{prop:"employeeName",label:"員工姓名",width:"120"}),l(s,{prop:"bankCode",label:"銀行代碼",width:"100"}),l(s,{prop:"accountNumber",label:"帳號"}),l(s,{label:"操作",width:"120"},{default:a(({row:t,$index:y})=>[l(u,{type:"primary",onClick:b=>he(y)},{default:a(()=>[...e[37]||(e[37]=[d("編輯",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),o("span",Je,[l(u,{onClick:e[13]||(e[13]=t=>W.value=!1)},{default:a(()=>[...e[38]||(e[38]=[d("關閉",-1)])]),_:1})])]),_:1},8,["modelValue"])]),_:1}),l(E,{label:"其他設定",name:"others"},{default:a(()=>[o("div",Ke,[l(O,{model:V.value,"label-width":"180px"},{default:a(()=>[l(v,{label:"扶養親屬資料 (是否納入撫養額)"},{default:a(()=>[l(ee,{modelValue:V.value.includeDependents,"onUpdate:modelValue":e[15]||(e[15]=t=>V.value.includeDependents=t)},null,8,["modelValue"])]),_:1}),l(v,{label:"法院扣押處理"},{default:a(()=>[l(ee,{modelValue:V.value.courtGarnishment,"onUpdate:modelValue":e[16]||(e[16]=t=>V.value.courtGarnishment=t)},null,8,["modelValue"]),e[39]||(e[39]=o("small",null,"若啟用，需在員工資料內填寫扣押比例或金額",-1))]),_:1}),l(v,{label:"薪資差異調整 (歷史月份)"},{default:a(()=>[l(ne,{modelValue:V.value.diffAdjustmentMonths,"onUpdate:modelValue":e[17]||(e[17]=t=>V.value.diffAdjustmentMonths=t),min:0},null,8,["modelValue"]),e[40]||(e[40]=o("small",null,"允許調整多少個月前的薪資紀錄",-1))]),_:1}),l(v,null,{default:a(()=>[l(u,{type:"primary",onClick:we},{default:a(()=>[...e[41]||(e[41]=[d("儲存其他設定",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),l(E,{label:"月薪資總覽",name:"monthlyOverview"},{default:a(()=>[o("div",Qe,[l(O,{inline:!0,class:"filter-form"},{default:a(()=>[l(v,{label:"月份"},{default:a(()=>[l($e,{modelValue:U.value,"onUpdate:modelValue":e[18]||(e[18]=t=>U.value=t),type:"month",placeholder:"選擇月份",format:"YYYY-MM","value-format":"YYYY-MM-01",onChange:j},null,8,["modelValue"])]),_:1}),l(v,{label:"機構"},{default:a(()=>[l(B,{modelValue:q.value,"onUpdate:modelValue":e[19]||(e[19]=t=>q.value=t),placeholder:"全部機構",clearable:"",onChange:j},{default:a(()=>[(h(!0),D(le,null,ae(me.value,t=>(h(),te(w,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"部門"},{default:a(()=>[l(B,{modelValue:J.value,"onUpdate:modelValue":e[20]||(e[20]=t=>J.value=t),placeholder:"全部部門",clearable:"",onChange:j},{default:a(()=>[(h(!0),D(le,null,ae(ve.value,t=>(h(),te(w,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"單位"},{default:a(()=>[l(B,{modelValue:K.value,"onUpdate:modelValue":e[21]||(e[21]=t=>K.value=t),placeholder:"全部單位",clearable:"",onChange:j},{default:a(()=>[(h(!0),D(le,null,ae(fe.value,t=>(h(),te(w,{key:t._id,label:t.name,value:t._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"員工"},{default:a(()=>[l(L,{modelValue:Q.value,"onUpdate:modelValue":e[22]||(e[22]=t=>Q.value=t),placeholder:"搜尋員工姓名",clearable:"",onInput:n.filterOverviewData,style:{width:"200px"}},null,8,["modelValue","onInput"])]),_:1}),l(v,null,{default:a(()=>[l(u,{type:"primary",onClick:j},{default:a(()=>[...e[42]||(e[42]=[d("查詢",-1)])]),_:1})]),_:1})]),_:1}),l(x,{class:"export-card",shadow:"never"},{header:a(()=>[o("div",Xe,[o("div",Ze,[e[46]||(e[46]=o("span",{style:{"margin-right":"12px"}},"匯出格式",-1)),l(Ie,{modelValue:N.value,"onUpdate:modelValue":e[23]||(e[23]=t=>N.value=t),size:"small"},{default:a(()=>[l(de,{label:"taiwan"},{default:a(()=>[...e[43]||(e[43]=[d("臺灣企銀",-1)])]),_:1}),l(de,{label:"taichung"},{default:a(()=>[...e[44]||(e[44]=[d("台中銀行",-1)])]),_:1}),l(de,{label:"bonusSlip"},{default:a(()=>[...e[45]||(e[45]=[d("個人獎金紙條",-1)])]),_:1})]),_:1},8,["modelValue"])]),o("div",el,[l(u,{size:"small",plain:"",type:"info",onClick:e[24]||(e[24]=t=>X.value=!X.value)},{default:a(()=>[d(i(X.value?"隱藏示意表格":"顯示示意表格"),1)]),_:1}),l(u,{type:"primary",size:"small",loading:oe.value,onClick:Ue},{default:a(()=>[...e[47]||(e[47]=[d(" 下載匯出 ",-1)])]),_:1},8,["loading"])])])]),default:a(()=>[X.value?(h(),D("div",ll,[l(Me,{title:"以下為示意表格，實際匯出內容會套用當月薪資資料",type:"info","show-icon":"",class:"export-card__alert"}),l(_,{data:Fe.value,border:"",stripe:"",size:"small","max-height":"260"},{default:a(()=>[(h(!0),D(le,null,ae(Ce.value,t=>(h(),te(s,{key:t.prop,prop:t.prop,label:t.label,width:t.width,align:t.align||"center"},null,8,["prop","label","width","align"]))),128))]),_:1},8,["data"])])):Y("",!0)]),_:1}),l(R,{gutter:20,style:{"margin-bottom":"20px"}},{default:a(()=>[l(c,{span:6},{default:a(()=>[l(x,null,{default:a(()=>[o("div",al,[e[48]||(e[48]=o("div",{class:"stat-label"},"總人數",-1)),o("div",tl,i(H.value.length),1)])]),_:1})]),_:1}),l(c,{span:6},{default:a(()=>[l(x,null,{default:a(()=>[o("div",ol,[e[49]||(e[49]=o("div",{class:"stat-label"},"薪資總額",-1)),o("div",nl,i(p(ke.value)),1)])]),_:1})]),_:1}),l(c,{span:6},{default:a(()=>[l(x,null,{default:a(()=>[o("div",sl,[e[50]||(e[50]=o("div",{class:"stat-label"},"實發總額",-1)),o("div",dl,i(p(Ve.value)),1)])]),_:1})]),_:1}),l(c,{span:6},{default:a(()=>[l(x,null,{default:a(()=>[o("div",il,[e[51]||(e[51]=o("div",{class:"stat-label"},"扣款總額",-1)),o("div",ul,i(p(xe.value)),1)])]),_:1})]),_:1})]),_:1}),l(_,{data:H.value,border:"",stripe:"",style:{width:"100%"},"max-height":"600"},{default:a(()=>[l(s,{prop:"employeeId",label:"員工編號",width:"120",fixed:""}),l(s,{prop:"name",label:"姓名",width:"100",fixed:""}),l(s,{prop:"department",label:"部門",width:"120"}),l(s,{prop:"subDepartment",label:"單位",width:"120"}),l(s,{prop:"salaryType",label:"薪資類型",width:"100"}),l(s,{label:"工作時數",align:"center"},{default:a(()=>[l(s,{prop:"workDays",label:"上班天數",width:"100",align:"right"},{default:a(({row:t})=>[d(i(t.workDays||0),1)]),_:1}),l(s,{prop:"actualWorkHours",label:"實際工時",width:"100",align:"right"},{default:a(({row:t})=>[d(i((t.actualWorkHours||0).toFixed(2)),1)]),_:1}),l(s,{prop:"hourlyRate",label:"時薪",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.hourlyRate)),1)]),_:1})]),_:1}),l(s,{label:"請假",align:"center"},{default:a(()=>[l(s,{prop:"leaveHours",label:"請假時數",width:"100",align:"right"},{default:a(({row:t})=>[d(i((t.leaveHours||0).toFixed(2)),1)]),_:1}),l(s,{prop:"leaveDeduction",label:"請假扣款",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.leaveDeduction)),1)]),_:1})]),_:1}),l(s,{label:"加班",align:"center"},{default:a(()=>[l(s,{prop:"overtimeHours",label:"加班時數",width:"100",align:"right"},{default:a(({row:t})=>[d(i((t.overtimeHours||0).toFixed(2)),1)]),_:1}),l(s,{prop:"overtimePay",label:"加班費",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.overtimePay)),1)]),_:1})]),_:1}),l(s,{prop:"baseSalary",label:"基本薪資",width:"120",align:"right"},{default:a(({row:t})=>[d(i(p(t.baseSalary)),1)]),_:1}),l(s,{label:"扣款項目",align:"center"},{default:a(()=>[l(s,{prop:"laborInsuranceFee",label:"勞保費",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.laborInsuranceFee)),1)]),_:1}),l(s,{prop:"healthInsuranceFee",label:"健保費",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.healthInsuranceFee)),1)]),_:1}),l(s,{prop:"laborPensionSelf",label:"勞退",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.laborPensionSelf)),1)]),_:1}),l(s,{prop:"otherDeductions",label:"其他扣款",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.otherDeductions)),1)]),_:1})]),_:1}),l(s,{label:"加項",align:"center"},{default:a(()=>[l(s,{prop:"nightShiftAllowance",label:"夜班津貼",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.nightShiftAllowance)),1)]),_:1}),l(s,{prop:"performanceBonus",label:"績效獎金",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.performanceBonus)),1)]),_:1}),l(s,{prop:"otherBonuses",label:"其他獎金",width:"100",align:"right"},{default:a(({row:t})=>[d(i(p(t.otherBonuses)),1)]),_:1})]),_:1}),l(s,{prop:"netPay",label:"實發金額",width:"120",align:"right",fixed:"right"},{default:a(({row:t})=>[o("strong",null,i(p(t.netPay)),1)]),_:1}),l(s,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[l(u,{type:"primary",size:"small",onClick:y=>Be(t)},{default:a(()=>[...e[52]||(e[52]=[d("詳細",-1)])]),_:1},8,["onClick"]),l(ie,{type:t.hasPayrollRecord?"success":"info",size:"small"},{default:a(()=>[d(i(t.hasPayrollRecord?"已計算":"未計算"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"]),l(se,{modelValue:Z.value,"onUpdate:modelValue":e[26]||(e[26]=t=>Z.value=t),title:"員工薪資詳細資料",width:"90%","close-on-click-modal":!1},{footer:a(()=>[l(u,{onClick:e[25]||(e[25]=t=>Z.value=!1)},{default:a(()=>[...e[73]||(e[73]=[d("關閉",-1)])]),_:1})]),default:a(()=>[f.value?(h(),D("div",rl,[l(x,{class:"detail-card",shadow:"never"},{header:a(()=>[...e[53]||(e[53]=[o("div",{class:"card-header"},[o("span",null,"基本資訊")],-1)])]),default:a(()=>[l(ze,{column:3,border:""},{default:a(()=>[l($,{label:"員工編號"},{default:a(()=>[d(i(f.value.employeeId),1)]),_:1}),l($,{label:"姓名"},{default:a(()=>[d(i(f.value.name),1)]),_:1}),l($,{label:"部門"},{default:a(()=>[d(i(f.value.department),1)]),_:1}),l($,{label:"單位"},{default:a(()=>[d(i(f.value.subDepartment),1)]),_:1}),l($,{label:"薪資類型"},{default:a(()=>[d(i(f.value.salaryType),1)]),_:1}),l($,{label:"月份"},{default:a(()=>[d(i(U.value),1)]),_:1})]),_:1})]),_:1}),l(x,{class:"detail-card",shadow:"never",style:{"margin-top":"20px"}},{header:a(()=>[...e[54]||(e[54]=[o("div",{class:"card-header"},[o("span",null,"工作時數統計")],-1)])]),default:a(()=>{var t,y;return[l(R,{gutter:20},{default:a(()=>[l(c,{span:6},{default:a(()=>[o("div",pl,[e[55]||(e[55]=o("div",{class:"stat-label"},"上班天數",-1)),o("div",ml,i(f.value.workDays||0)+" 天",1)])]),_:1}),l(c,{span:6},{default:a(()=>[o("div",vl,[e[56]||(e[56]=o("div",{class:"stat-label"},"應出勤時數",-1)),o("div",fl,i((f.value.scheduledHours||0).toFixed(2))+" 小時",1)])]),_:1}),l(c,{span:6},{default:a(()=>[o("div",cl,[e[57]||(e[57]=o("div",{class:"stat-label"},"實際工時",-1)),o("div",bl,i((f.value.actualWorkHours||0).toFixed(2))+" 小時",1)])]),_:1}),l(c,{span:6},{default:a(()=>[o("div",_l,[e[58]||(e[58]=o("div",{class:"stat-label"},"時薪",-1)),o("div",yl,i(p(f.value.hourlyRate)),1)])]),_:1})]),_:1}),(y=(t=S.value)==null?void 0:t.dailyDetails)!=null&&y.length?(h(),D("div",hl,[e[59]||(e[59]=o("h4",null,"每日出勤明細",-1)),l(_,{data:S.value.dailyDetails,border:"",size:"small","max-height":"300"},{default:a(()=>[l(s,{prop:"date",label:"日期",width:"120"}),l(s,{prop:"shiftName",label:"班別",width:"120"}),l(s,{prop:"scheduledHours",label:"排班時數",width:"100",align:"right"},{default:a(({row:b})=>[d(i(b.scheduledHours.toFixed(2)),1)]),_:1}),l(s,{prop:"workedHours",label:"實際工時",width:"100",align:"right"},{default:a(({row:b})=>[d(i(b.workedHours.toFixed(2)),1)]),_:1}),l(s,{label:"出勤狀態",width:"100"},{default:a(({row:b})=>[l(ie,{type:b.hasAttendance?"success":"danger",size:"small"},{default:a(()=>[d(i(b.hasAttendance?"已打卡":"缺勤"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])])):Y("",!0)]}),_:1}),l(x,{class:"detail-card",shadow:"never",style:{"margin-top":"20px"}},{header:a(()=>[...e[60]||(e[60]=[o("div",{class:"card-header"},[o("span",null,"請假統計")],-1)])]),default:a(()=>{var t,y;return[l(R,{gutter:20},{default:a(()=>[l(c,{span:6},{default:a(()=>[o("div",gl,[e[61]||(e[61]=o("div",{class:"stat-label"},"總請假時數",-1)),o("div",wl,i((f.value.leaveHours||0).toFixed(2))+" 小時",1)])]),_:1}),l(c,{span:6},{default:a(()=>[o("div",kl,[e[62]||(e[62]=o("div",{class:"stat-label"},"有薪假時數",-1)),o("div",Vl,i((f.value.paidLeaveHours||0).toFixed(2))+" 小時",1)])]),_:1}),l(c,{span:6},{default:a(()=>[o("div",xl,[e[63]||(e[63]=o("div",{class:"stat-label"},"無薪假時數",-1)),o("div",Dl,i((f.value.unpaidLeaveHours||0).toFixed(2))+" 小時",1)])]),_:1}),l(c,{span:6},{default:a(()=>[o("div",Sl,[e[64]||(e[64]=o("div",{class:"stat-label"},"請假扣款",-1)),o("div",Cl,i(p(f.value.leaveDeduction)),1)])]),_:1})]),_:1}),(y=(t=S.value)==null?void 0:t.leaveRecords)!=null&&y.length?(h(),D("div",Fl,[e[65]||(e[65]=o("h4",null,"請假記錄",-1)),l(_,{data:S.value.leaveRecords,border:"",size:"small"},{default:a(()=>[l(s,{prop:"leaveType",label:"假別",width:"120"}),l(s,{prop:"startDate",label:"開始日期",width:"120"}),l(s,{prop:"endDate",label:"結束日期",width:"120"}),l(s,{prop:"days",label:"天數",width:"80",align:"right"},{default:a(({row:b})=>[d(i(b.days.toFixed(1)),1)]),_:1}),l(s,{prop:"hours",label:"時數",width:"80",align:"right"},{default:a(({row:b})=>[d(i(b.hours.toFixed(2)),1)]),_:1}),l(s,{label:"給薪狀態",width:"100"},{default:a(({row:b})=>[l(ie,{type:b.isPaid?"success":"warning",size:"small"},{default:a(()=>[d(i(b.isPaid?"有薪":"無薪"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])])):Y("",!0)]}),_:1}),l(x,{class:"detail-card",shadow:"never",style:{"margin-top":"20px"}},{header:a(()=>[...e[66]||(e[66]=[o("div",{class:"card-header"},[o("span",null,"加班統計")],-1)])]),default:a(()=>{var t,y;return[l(R,{gutter:20},{default:a(()=>[l(c,{span:12},{default:a(()=>[o("div",Pl,[e[67]||(e[67]=o("div",{class:"stat-label"},"加班時數",-1)),o("div",Ul,i((f.value.overtimeHours||0).toFixed(2))+" 小時",1)])]),_:1}),l(c,{span:12},{default:a(()=>[o("div",Al,[e[68]||(e[68]=o("div",{class:"stat-label"},"加班費",-1)),o("div",Nl,i(p(f.value.overtimePay)),1)])]),_:1})]),_:1}),(y=(t=S.value)==null?void 0:t.overtimeRecords)!=null&&y.length?(h(),D("div",jl,[e[69]||(e[69]=o("h4",null,"加班記錄",-1)),l(_,{data:S.value.overtimeRecords,border:"",size:"small"},{default:a(()=>[l(s,{prop:"date",label:"日期",width:"120"}),l(s,{prop:"hours",label:"加班時數",width:"100",align:"right"},{default:a(({row:b})=>[d(i(b.hours.toFixed(2)),1)]),_:1}),l(s,{prop:"reason",label:"原因"})]),_:1},8,["data"])])):Y("",!0)]}),_:1}),l(x,{class:"detail-card",shadow:"never",style:{"margin-top":"20px"}},{header:a(()=>[...e[70]||(e[70]=[o("div",{class:"card-header"},[o("span",null,"薪資計算明細")],-1)])]),default:a(()=>[l(_,{data:Pe.value,border:""},{default:a(()=>[l(s,{prop:"item",label:"項目",width:"200"}),l(s,{prop:"description",label:"說明"}),l(s,{prop:"amount",label:"金額",width:"150",align:"right"},{default:a(({row:t})=>[o("span",{style:Oe({color:t.type==="deduction"?"red":t.type==="bonus"?"green":"inherit"})},i(t.type==="deduction"?"-":"")+i(p(t.amount)),5)]),_:1})]),_:1},8,["data"]),o("div",Bl,[l(R,{gutter:20},{default:a(()=>[l(c,{span:18},{default:a(()=>[...e[71]||(e[71]=[d("實發金額 (銀行A)：",-1)])]),_:1}),l(c,{span:6},{default:a(()=>[d(i(p(f.value.netPay)),1)]),_:1})]),_:1}),l(R,{gutter:20,style:{"margin-top":"10px"}},{default:a(()=>[l(c,{span:18},{default:a(()=>[...e[72]||(e[72]=[d("獎金金額 (銀行B)：",-1)])]),_:1}),l(c,{span:6},{default:a(()=>[d(i(p(f.value.totalBonus)),1)]),_:1})]),_:1})])]),_:1})])):Y("",!0)]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])])}}},zl=Te(Rl,[["__scopeId","data-v-3ea37bb9"]]);export{zl as default};
