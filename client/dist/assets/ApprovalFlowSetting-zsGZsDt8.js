import{_ as H,r as _,c as y,d as c,a as l,w as a,b as u,o as g,e as d,F as D,i as F}from"./index-BZkZtvsR.js";const M={class:"approval-flow-setting"},O={class:"tab-content"},P={slot:"footer",class:"dialog-footer"},q={__name:"ApprovalFlowSetting",setup(z){const k=_("commonRule"),n=_({maxApprovalLevel:5,allowDelegate:!0,overdueDays:3,overdueAction:"none"});function T(){console.log("儲存通用規則:",n.value),alert("已儲存「通用流程規則」")}const m=_([{name:"請假申請",levels:2,approvers:["user002","user003"]},{name:"加班申請",levels:3,approvers:["user002","user004","user005"]},{name:"補打卡申請",levels:1,approvers:["user002"]}]),i=_(!1);let f=null;const t=_({name:"",levels:1,approvers:[]}),L=[{label:"王小明 (user001)",value:"user001"},{label:"李主管 (user002)",value:"user002"},{label:"陳會計 (user003)",value:"user003"},{label:"HR-Alice (user004)",value:"user004"},{label:"Manager-Bob (user005)",value:"user005"}];function A(r=null){if(r!==null){f=r;const e=m.value[r];t.value={name:e.name,levels:e.levels,approvers:[...e.approvers]}}else f=null,t.value={name:"",levels:1,approvers:[]};i.value=!0}function R(){for(t.value.approvers||(t.value.approvers=[]);t.value.approvers.length<t.value.levels;)t.value.approvers.push("");t.value.approvers.length>t.value.levels&&t.value.approvers.splice(t.value.levels),f===null?m.value.push({...t.value}):m.value[f]={...t.value},i.value=!1}function B(r){m.value.splice(r,1)}return(r,e)=>{const w=u("el-input-number"),s=u("el-form-item"),$=u("el-switch"),b=u("el-option"),C=u("el-select"),v=u("el-button"),x=u("el-form"),U=u("el-tab-pane"),V=u("el-table-column"),N=u("el-table"),I=u("el-input"),S=u("el-dialog"),j=u("el-tabs");return g(),y("div",M,[e[17]||(e[17]=c("h2",null,"簽核流程設定",-1)),l(j,{modelValue:k.value,"onUpdate:modelValue":e[9]||(e[9]=o=>k.value=o),type:"card"},{default:a(()=>[l(U,{label:"通用流程規則",name:"commonRule"},{default:a(()=>[l(x,{model:n.value,"label-width":"160px",class:"rule-form"},{default:a(()=>[l(s,{label:"最大簽核關卡數"},{default:a(()=>[l(w,{modelValue:n.value.maxApprovalLevel,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.maxApprovalLevel=o),min:1},null,8,["modelValue"])]),_:1}),l(s,{label:"是否允許代理簽核"},{default:a(()=>[l($,{modelValue:n.value.allowDelegate,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.allowDelegate=o)},null,8,["modelValue"])]),_:1}),l(s,{label:"逾時提醒(天)"},{default:a(()=>[l(w,{modelValue:n.value.overdueDays,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.overdueDays=o),min:1},null,8,["modelValue"]),e[10]||(e[10]=c("small",null,"若簽核逾時超過此天數，系統自動發送提醒",-1))]),_:1}),l(s,{label:"逾時處理方式"},{default:a(()=>[l(C,{modelValue:n.value.overdueAction,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value.overdueAction=o),placeholder:"選擇逾時行為"},{default:a(()=>[l(b,{label:"不處理",value:"none"}),l(b,{label:"自動通過",value:"autoPass"}),l(b,{label:"自動退回",value:"autoReject"})]),_:1},8,["modelValue"])]),_:1}),l(s,null,{default:a(()=>[l(v,{type:"primary",onClick:T},{default:a(()=>e[11]||(e[11]=[d("儲存通用規則")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(U,{label:"申請類型設定",name:"approvalLevels"},{default:a(()=>[c("div",O,[l(v,{type:"primary",onClick:e[4]||(e[4]=o=>A())},{default:a(()=>e[12]||(e[12]=[d("新增申請類型")])),_:1}),l(N,{data:m.value,style:{"margin-top":"20px"}},{default:a(()=>[l(V,{prop:"name",label:"申請類型",width:"180"}),l(V,{prop:"levels",label:"關卡數",width:"80"}),l(V,{label:"詳細"}),l(V,{label:"操作",width:"180"},{default:a(({row:o,$index:p})=>[l(v,{type:"primary",onClick:E=>A(p)},{default:a(()=>e[13]||(e[13]=[d("編輯")])),_:2},1032,["onClick"]),l(v,{type:"danger",onClick:E=>B(p)},{default:a(()=>e[14]||(e[14]=[d("刪除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(S,{modelValue:i.value,"onUpdate:modelValue":e[8]||(e[8]=o=>i.value=o),title:"申請類型簽核關卡設定",width:"600px"},{default:a(()=>[l(x,{model:t.value,"label-width":"120px"},{default:a(()=>[l(s,{label:"類型名稱"},{default:a(()=>[l(I,{modelValue:t.value.name,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.name=o),placeholder:"如：請假申請 / 加班申請 / 補卡申請"},null,8,["modelValue"])]),_:1}),l(s,{label:"關卡數"},{default:a(()=>[l(w,{modelValue:t.value.levels,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.levels=o),min:1},null,8,["modelValue"])]),_:1}),(g(!0),y(D,null,F(t.value.levels,o=>(g(),y("div",{key:o,class:"approval-level"},[l(s,{label:`第${o}關審核人`},{default:a(()=>[l(C,{modelValue:t.value.approvers[o-1],"onUpdate:modelValue":p=>t.value.approvers[o-1]=p,placeholder:"選擇審核人"},{default:a(()=>[(g(),y(D,null,F(L,p=>l(b,{key:p.value,label:p.label,value:p.value},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]))),128))]),_:1},8,["model"]),c("span",P,[l(v,{onClick:e[7]||(e[7]=o=>i.value=!1)},{default:a(()=>e[15]||(e[15]=[d("取消")])),_:1}),l(v,{type:"primary",onClick:R},{default:a(()=>e[16]||(e[16]=[d("儲存")])),_:1})])]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])])}}},J=H(q,[["__scopeId","data-v-c083524a"]]);export{J as default};
